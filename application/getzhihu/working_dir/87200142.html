<!doctype html>
<html lang="zh" data-hairline="true" data-theme="light"><head><meta charSet="utf-8"/><title data-react-helmet="true">【强化学习 96】Causal Bandit - 知乎</title><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1"/><meta name="renderer" content="webkit"/><meta name="force-rendering" content="webkit"/><meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1"/><meta name="google-site-verification" content="FTeR0c8arOPKh8c5DYh_9uu98_zJbaWw53J-Sch9MTg"/><meta data-react-helmet="true" name="keywords" content="强化学习 (Reinforcement Learning),遗传算法,机器学习"/><meta data-react-helmet="true" name="description" content="提出一种 bandit problem + causal inference 相结合的问题，给出相应的算法。原文传送门Lattimore, Finnian, Tor Lattimore, and Mark D. Reid. &amp;#34;Causal bandits: Learning good interventions via causal in…"/><meta data-react-helmet="true" property="og:title" content="【强化学习 96】Causal Bandit"/><meta data-react-helmet="true" property="og:url" content="https://zhuanlan.zhihu.com/p/87200142"/><meta data-react-helmet="true" property="og:description" content="提出一种 bandit problem + causal inference 相结合的问题，给出相应的算法。原文传送门Lattimore, Finnian, Tor Lattimore, and Mark D. Reid. &amp;#34;Causal bandits: Learning good interventions via causal in…"/><meta data-react-helmet="true" property="og:image" content="https://pic3.zhimg.com/v2-93cc1b5c7e4a555a6f7a5c0d79373f4d_b.jpg"/><meta data-react-helmet="true" property="og:type" content="article"/><meta data-react-helmet="true" property="og:site_name" content="知乎专栏"/><link data-react-helmet="true" rel="apple-touch-icon" href="https://static.zhihu.com/heifetz/assets/apple-touch-icon-152.67c7b278.png"/><link data-react-helmet="true" rel="apple-touch-icon" href="https://static.zhihu.com/heifetz/assets/apple-touch-icon-152.67c7b278.png" sizes="152x152"/><link data-react-helmet="true" rel="apple-touch-icon" href="https://static.zhihu.com/heifetz/assets/apple-touch-icon-120.b3e6278d.png" sizes="120x120"/><link data-react-helmet="true" rel="apple-touch-icon" href="https://static.zhihu.com/heifetz/assets/apple-touch-icon-76.7a750095.png" sizes="76x76"/><link data-react-helmet="true" rel="apple-touch-icon" href="https://static.zhihu.com/heifetz/assets/apple-touch-icon-60.a4a761d4.png" sizes="60x60"/><link rel="shortcut icon" type="image/x-icon" href="https://static.zhihu.com/static/favicon.ico"/><link rel="search" type="application/opensearchdescription+xml" href="https://static.zhihu.com/static/search.xml" title="知乎"/><link rel="dns-prefetch" href="//static.zhimg.com"/><link rel="dns-prefetch" href="//pic1.zhimg.com"/><link rel="dns-prefetch" href="//pic2.zhimg.com"/><link rel="dns-prefetch" href="//pic3.zhimg.com"/><link rel="dns-prefetch" href="//pic4.zhimg.com"/><style>
.u-safeAreaInset-top {
  height: constant(safe-area-inset-top) !important;
  height: env(safe-area-inset-top) !important;
  
}
.u-safeAreaInset-bottom {
  height: constant(safe-area-inset-bottom) !important;
  height: env(safe-area-inset-bottom) !important;
  
}
</style><link href="https://static.zhihu.com/heifetz/column.app.a9ced452148fee3a55c8.css" rel="stylesheet"/><script defer="" crossorigin="anonymous" src="https://unpkg.zhimg.com/@cfe/sentry-script@latest/dist/init.js" data-sentry-config="{&quot;dsn&quot;:&quot;https://2d8d764432cc4f6fb3bc78ab9528299d@crash2.zhihu.com/1224&quot;,&quot;sampleRate&quot;:0.1,&quot;release&quot;:&quot;683-127b14ad&quot;,&quot;ignoreErrorNames&quot;:[&quot;NetworkError&quot;,&quot;SecurityError&quot;],&quot;ignoreErrors&quot;:[&quot;origin message&quot;,&quot;Network request failed&quot;,&quot;Loading chunk&quot;,&quot;这个系统不支持该功能。&quot;,&quot;Can&#x27;t find variable: webkit&quot;,&quot;Can&#x27;t find variable: $&quot;,&quot;内存不足&quot;,&quot;out of memory&quot;,&quot;DOM Exception 18&quot;,&quot;The operation is insecure&quot;,&quot;[object Event]&quot;,&quot;[object FileError]&quot;,&quot;[object DOMError]&quot;,&quot;[object Object]&quot;,&quot;拒绝访问。&quot;,&quot;Maximum call stack size exceeded&quot;,&quot;UploadError&quot;,&quot;无法 fetch&quot;,&quot;draft-js&quot;,&quot;缺少 JavaScript 对象&quot;,&quot;componentWillEnter&quot;,&quot;componentWillLeave&quot;,&quot;componentWillAppear&quot;,&quot;getInlineStyleAt&quot;,&quot;getCharacterList&quot;],&quot;whitelistUrls&quot;:[&quot;static.zhihu.com&quot;]}"></script></head><body class="WhiteBg-body"><div id="root"><div class="App"><div class="LoadingBar"></div><main role="main" class="App-main"><div class="Post-content" data-zop-usertoken="{&quot;userToken&quot;:&quot;&quot;}" data-zop="{&quot;authorName&quot;:&quot;张楚珩&quot;,&quot;itemId&quot;:87200142,&quot;title&quot;:&quot;【强化学习 96】Causal Bandit&quot;,&quot;type&quot;:&quot;article&quot;}"><div class="ColumnPageHeader-Wrapper"><div><div class="Sticky ColumnPageHeader"><div class="ColumnPageHeader-content"><a href="//www.zhihu.com" aria-label="知乎"><svg viewBox="0 0 200 91" fill="#0084FF" width="64" height="30"><path d="M53.29 80.035l7.32.002 2.41 8.24 13.128-8.24h15.477v-67.98H53.29v67.978zm7.79-60.598h22.756v53.22h-8.73l-8.718 5.473-1.587-5.46-3.72-.012v-53.22zM46.818 43.162h-16.35c.545-8.467.687-16.12.687-22.955h15.987s.615-7.05-2.68-6.97H16.807c1.09-4.1 2.46-8.332 4.1-12.708 0 0-7.523 0-10.085 6.74-1.06 2.78-4.128 13.48-9.592 24.41 1.84-.2 7.927-.37 11.512-6.94.66-1.84.785-2.08 1.605-4.54h9.02c0 3.28-.374 20.9-.526 22.95H6.51c-3.67 0-4.863 7.38-4.863 7.38H22.14C20.765 66.11 13.385 79.24 0 89.62c6.403 1.828 12.784-.29 15.937-3.094 0 0 7.182-6.53 11.12-21.64L43.92 85.18s2.473-8.402-.388-12.496c-2.37-2.788-8.768-10.33-11.496-13.064l-4.57 3.627c1.363-4.368 2.183-8.61 2.46-12.71H49.19s-.027-7.38-2.372-7.38zm128.752-.502c6.51-8.013 14.054-18.302 14.054-18.302s-5.827-4.625-8.556-1.27c-1.874 2.548-11.51 15.063-11.51 15.063l6.012 4.51zm-46.903-18.462c-2.814-2.577-8.096.667-8.096.667s12.35 17.2 12.85 17.953l6.08-4.29s-8.02-11.752-10.83-14.33zM199.99 46.5c-6.18 0-40.908.292-40.953.292v-31.56c1.503 0 3.882-.124 7.14-.376 12.773-.753 21.914-1.25 27.427-1.504 0 0 3.817-8.496-.185-10.45-.96-.37-7.24 1.43-7.24 1.43s-51.63 5.153-72.61 5.64c.5 2.756 2.38 5.336 4.93 6.11 4.16 1.087 7.09.53 15.36.277 7.76-.5 13.65-.76 17.66-.76v31.19h-41.71s.88 6.97 7.97 7.14h33.73v22.16c0 4.364-3.498 6.87-7.65 6.6-4.4.034-8.15-.36-13.027-.566.623 1.24 1.977 4.496 6.035 6.824 3.087 1.502 5.054 2.053 8.13 2.053 9.237 0 14.27-5.4 14.027-14.16V53.93h38.235c3.026 0 2.72-7.432 2.72-7.432z" fill-rule="evenodd"></path></svg></a><i class="ColumnPageHeader-Line"></i><div class="ColumnPageHeader-Title"><a class="ColumnLink ColumnPageHeader-Link" href="/reinforcementlearning"><img class="Avatar Avatar--round" width="30" height="30" src="https://pic2.zhimg.com/v2-5d1f04a84f6be8896c07a32a05e1d6d1_is.jpg" srcSet="https://pic2.zhimg.com/v2-5d1f04a84f6be8896c07a32a05e1d6d1_im.jpg 2x" alt="强化学习前沿"/></a><div class="ColumnPageHeader-TitleName"><span class="ColumnPageHeader-TitleMeta">首发于</span><a class="ColumnLink ColumnPageHeader-TitleColumn" href="/reinforcementlearning">强化学习前沿</a></div></div><div class="ColumnPageHeader-Button"><button type="button" class="Button ColumnPageHeader-WriteButton Button--blue"><svg class="Zi Zi--EditSurround" fill="currentColor" viewBox="0 0 24 24" width="24" height="24"><path d="M18.453 7.992l-1.833-1.65.964-.978a1.223 1.223 0 0 1 1.73-.012l.005.006a1.24 1.24 0 0 1 .007 1.748l-.873.886zm-1.178 1.194l-5.578 5.66-1.935.697a.393.393 0 0 1-.504-.504l.697-1.935 5.488-5.567 1.832 1.65zM7.58 5.848l5.654.006-1.539 1.991-3.666.012A1.02 1.02 0 0 0 7 8.868v7.993c0 .558.46 1.01 1.029 1.01l7.941-.01c.568 0 1.03-.453 1.03-1.012v-4.061l2-1.442v6.002c0 1.397-1.2 2.501-2.62 2.501H7.574C6.153 19.85 5 18.717 5 17.32V8.35c0-1.397 1.16-2.502 2.58-2.502z"></path></svg>写文章</button></div></div></div></div></div><img class="TitleImage" src="https://pic3.zhimg.com/v2-93cc1b5c7e4a555a6f7a5c0d79373f4d_1200x500.jpg" alt="【强化学习 96】Causal Bandit"/><article class="Post-Main Post-NormalMain" tabindex="-1"><header class="Post-Header"><h1 class="Post-Title">【强化学习 96】Causal Bandit</h1><div class="Post-Author"><div class="AuthorInfo" itemProp="author" itemscope="" itemType="http://schema.org/Person"><meta itemProp="name" content="张楚珩"/><meta itemProp="image" content="https://pic4.zhimg.com/v2-2b7c11f27a7fd03282819889435815aa_l.jpg"/><meta itemProp="url" content="https://www.zhihu.com/people/zhang-chu-heng"/><meta itemProp="zhihu:followerCount"/><span class="UserLink AuthorInfo-avatarWrapper"><div class="Popover"><div id="null-toggle" aria-haspopup="true" aria-expanded="false" aria-owns="null-content"><a class="UserLink-link" data-za-detail-view-element_name="User" target="_blank" href="//www.zhihu.com/people/zhang-chu-heng"><img class="Avatar Avatar--round AuthorInfo-avatar" width="38" height="38" src="https://pic4.zhimg.com/v2-2b7c11f27a7fd03282819889435815aa_xs.jpg" srcSet="https://pic4.zhimg.com/v2-2b7c11f27a7fd03282819889435815aa_l.jpg 2x" alt="张楚珩"/></a></div></div></span><div class="AuthorInfo-content"><div class="AuthorInfo-head"><span class="UserLink AuthorInfo-name"><div class="Popover"><div id="null-toggle" aria-haspopup="true" aria-expanded="false" aria-owns="null-content"><a class="UserLink-link" data-za-detail-view-element_name="User" target="_blank" href="//www.zhihu.com/people/zhang-chu-heng">张楚珩</a></div></div><style data-emotion-css="1cd9gw4">.css-1cd9gw4{margin-left:.3em;}</style><style data-emotion-css="1pc1mic">.css-1pc1mic{box-sizing:border-box;margin:0;min-width:0;color:#175199;display:inline-block;width:18px;height:18px;margin-left:.3em;}</style><a href="https://www.zhihu.com/question/48510028" target="_blank" class="css-1pc1mic" data-tooltip="已认证的个人" aria-label="已认证的个人"><style data-emotion-css="18biwo">.css-18biwo{display:-webkit-inline-box;display:-webkit-inline-flex;display:-ms-inline-flexbox;display:inline-flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;}</style><span class="css-18biwo">​<svg viewBox="0 0 24 24" width="18" height="18"><svg viewBox="0 0 24 24" x="-3" y="-3" fill="#FFFFFF" width="30" height="30"><path d="M3.56231227,13.8535307 C2.40051305,12.768677 2.41398885,11.0669203 3.59484487,9.99979213 L3.59222085,9.99654885 C4.26730143,9.45036719 4.79446755,8.21005186 4.7184197,7.34453784 L4.72305873,7.34412719 C4.66942824,5.75539997 5.8824188,4.56066914 7.47188965,4.64242381 L7.47229112,4.6386236 C8.33515314,4.72977993 9.58467253,4.22534048 10.1426329,3.55925173 L10.1462611,3.56228565 C11.2316055,2.40008701 12.9353108,2.41394456 14.0015072,3.59634088 L14.0047263,3.59374004 C14.5498229,4.26841874 15.7896857,4.79521622 16.6545744,4.71844347 L16.6549836,4.72304294 C18.245027,4.66894057 19.4396947,5.88213996 19.3575031,7.47241135 L19.3623099,7.47292747 C19.2704388,8.3358681 19.7742711,9.58421483 20.4407199,10.1424506 L20.437686,10.1460789 C21.5997217,11.2312209 21.5860695,12.9345218 20.4042441,14.0007396 L20.4072865,14.0045125 C19.7325967,14.5495925 19.2055209,15.7896954 19.2815865,16.6561959 L19.2770449,16.6565978 C19.3315454,18.2453037 18.1173775,19.4393568 16.5274188,19.3571512 L16.5269029,19.3619539 C15.6647098,19.270083 14.415408,19.7741709 13.8573671,20.4403558 L13.8537409,20.4373235 C12.76842,21.5995708 11.0650432,21.5864553 9.99899434,20.4039226 L9.99527367,20.406923 C9.45025436,19.7323399 8.21017638,19.2051872 7.34461983,19.2812352 L7.344304,19.2776405 C5.75448683,19.3312904 4.55977145,18.1170085 4.64254978,16.527117 L4.63769921,16.5265942 C4.72957031,15.6644394 4.22547659,14.4151814 3.55928015,13.8571569 L3.56231227,13.8535307 Z"></path></svg><path d="M2.63951518,13.3895441 C3.70763333,14.2842292 4.44777637,16.1226061 4.30075305,17.5023312 L4.32211542,17.3063047 C4.17509209,18.6910561 5.17786655,19.7063729 6.5613937,19.5844846 L6.364106,19.6008202 C7.75140298,19.4789319 9.57474349,20.2554985 10.4468305,21.3349009 L10.3224262,21.1803415 C11.1982831,22.2647703 12.6257916,22.2723098 13.5167278,21.2079863 L13.3898102,21.3600325 C14.2845162,20.2919393 16.1229361,19.5518136 17.5026934,19.6988334 L17.3054057,19.6774716 C18.6914461,19.8244915 19.7067866,18.8217404 19.5836389,17.4395022 L19.6012314,17.6367853 C19.4793403,16.2482641 20.255925,14.4249662 21.3353526,13.5528995 L21.1807897,13.677301 C22.2639871,12.8014646 22.2727834,11.3739894 21.2084351,10.483074 L21.3604848,10.6099886 C20.2923667,9.71530351 19.5522236,7.87818322 19.6992469,6.49720154 L19.6778846,6.69448464 C19.8249079,5.30847665 18.8221335,4.2944164 17.4386063,4.41630468 L17.635894,4.39871256 C16.248597,4.52185742 14.4252565,3.74529084 13.5531695,2.66588842 L13.6775738,2.81919121 C12.8017169,1.73601905 11.3742084,1.72722299 10.4832722,2.79154644 L10.6101898,2.63950024 C9.71548377,3.70759343 7.87706394,4.44771919 6.49730661,4.30195588 L6.69459432,4.32206116 C5.30855394,4.17504128 4.29447,5.17904888 4.41636114,6.56128713 L4.3987686,6.36400404 C4.52065973,7.75126861 3.74407501,9.57456653 2.66464737,10.4478898 L2.81921035,10.3222318 C1.73601288,11.1993248 1.72721662,12.6255433 2.79156494,13.5164587 L2.63951518,13.3895441 Z" fill="#0084FF"></path><svg class="Zi Zi--Check" fill="#fff" x="6" y="6" viewBox="0 0 24 24" width="12" height="12"><path d="M10.229 17.516c-.318.327-.75.484-1.199.484-.453 0-.884-.16-1.202-.488l-4.335-4.47a1.77 1.77 0 0 1 .007-2.459 1.663 1.663 0 0 1 2.397.01l3.137 3.246 9.072-9.329a1.662 1.662 0 0 1 2.397 0c.663.681.663 1.786 0 2.466L10.23 17.516z" fill-rule="evenodd"></path></svg></svg></span></a></span></div><div class="AuthorInfo-detail"><div class="AuthorInfo-badge"><div class="AuthorInfo-badgeText">清华大学 交叉信息院博士在读</div></div></div></div></div></div><div><span class="Voters"><button type="button" class="Button Button--plain">23 人<!-- -->赞同了该文章</button></span></div></header><div class="Post-RichTextContainer"><div class="RichText ztext Post-RichText"><p>提出一种 bandit problem + causal inference 相结合的问题，给出相应的算法。</p><h2>原文传送门</h2><p><a href="https://link.zhihu.com/?target=https%3A//papers.nips.cc/paper/6195-causal-bandits-learning-good-interventions-via-causal-inference.pdf" class=" wrap external" target="_blank" rel="nofollow noreferrer">Lattimore, Finnian, Tor Lattimore, and Mark D. Reid. &#34;Causal bandits: Learning good interventions via causal inference.&#34; Advances in Neural Information Processing Systems. 2016.</a>（提出 causal bandit problem，提出解决 best arm identification 问题的算法，分析了 simple regret）</p><p><a href="https://link.zhihu.com/?target=https%3A//arxiv.org/abs/1910.04938" class=" wrap external" target="_blank" rel="nofollow noreferrer">Yangyi Lu, Amirhossein Meisami, Ambuj Tewari, and Zhenyu Yan. &#34;Regret Analysis of Causal Bandit Problems.&#34; Arxiv preprint 1910.04938</a>（提出 UCB/TS 方法来解决 causal bandit 里面的探索-利用问题）</p><h2>特色</h2><p>十月份的新 paper，在之前提出了一种比较新的问题 causal bandit problem 的基础上，设计了基于 upper confidence bound (UCB) 和 Thompson sampling (TS) 的方法。由于使用了 causal information，其在理论上和实验上都有更好的效果（更小的 regret）。</p><h2>过程</h2><h3>1. 问题举例</h3><p>先来看几个现实生活里面可能遇到的问题，来作为 causal bandit problem 的例子。</p><p><b><u>农夫种地</u></b></p><p>这个例子来自于第一篇 paper。农民种地，目标是增加农作物的产量。跟农作物产量直接相关的有如下因素：1）温度；2）土壤中的某种营养物质含量；3）土壤湿度。但是农夫只能够通过一些操作来间接控制这些变量，比如：A）增加大棚遮阴或者用电热灯加热；B）使用或者不使用某种特殊的化肥；C）灌溉或者使用一种防水膜。</p><p>这个问题其实可以被看做是一个标准的 bandit problem，不同的 A-C 的组合看做不同的 arm，农作物的产量看做是 reward。但是现实中，我们可以知道一些额外的信息，比如各个变量之间的因果关系（known causal structure）、虽然不能控制但是能够测量直接的决定因素（比如 1-3）。Causal bandit problem 就是新增了已知的 causal graph 和可以观察到的决定性因素。在这个问题里面，causal graph 可以被画成下面的形式。</p><figure data-size="normal"><img src="https://pic1.zhimg.com/v2-e75812e425f165a3ddb88db58457bd60_b.jpg" data-caption="" data-size="normal" data-rawwidth="720" data-rawheight="279" class="origin_image zh-lightbox-thumb" width="720" data-original="https://pic1.zhimg.com/v2-e75812e425f165a3ddb88db58457bd60_r.jpg"/><img src="data:image/svg+xml;utf8,&lt;svg xmlns=&#39;http://www.w3.org/2000/svg&#39; width=&#39;720&#39; height=&#39;279&#39;&gt;&lt;/svg&gt;" data-caption="" data-size="normal" data-rawwidth="720" data-rawheight="279" class="origin_image zh-lightbox-thumb lazy" width="720" data-original="https://pic1.zhimg.com/v2-e75812e425f165a3ddb88db58457bd60_r.jpg" data-actualsrc="https://pic1.zhimg.com/v2-e75812e425f165a3ddb88db58457bd60_b.jpg"/></figure><p>在 causal bandit problem 中当然也可以和 bandit problem 类似解决不同的问题，比如 best arm identification 和 regret minimization。</p><p><b><u>Email Champaign</u></b></p><p>第二篇 paper 提供了另一个例子。Adobe 公司希望给用户发广告邮件，目标是希望增大用户把邮件点开的概率。蓝色节点表示可以控制的变量，有产品的种类（比如是 PS 还是 Acrobat）、邮件的目的（比如是福利还是营销）、发送的时间（比如是早上还是晚上）等。公司有一个邮件库，指定了蓝色节点对应的数值之后，就从邮件库里面选一个邮件给用户发，根据用户的不同反馈得到不同的奖励。但是最后决定用户会不会点击的是 <img src="https://www.zhihu.com/equation?tex=Z_1%2C+Z_2%2C+Z_3" alt="Z_1, Z_2, Z_3" eeimg="1"/> 三个因素，其相互关系如下图所示。（图中的数值表示每种随机变量有几种可能的取值）。注意到对于蓝色的节点来说，也可以不指定一个数值，这样就从其本身的一个分布中采样。</p><figure data-size="normal"><img src="https://pic3.zhimg.com/v2-cc7180a096b811aa377bf2270a859cba_b.jpg" data-caption="" data-size="normal" data-rawwidth="1278" data-rawheight="373" class="origin_image zh-lightbox-thumb" width="1278" data-original="https://pic3.zhimg.com/v2-cc7180a096b811aa377bf2270a859cba_r.jpg"/><img src="data:image/svg+xml;utf8,&lt;svg xmlns=&#39;http://www.w3.org/2000/svg&#39; width=&#39;1278&#39; height=&#39;373&#39;&gt;&lt;/svg&gt;" data-caption="" data-size="normal" data-rawwidth="1278" data-rawheight="373" class="origin_image zh-lightbox-thumb lazy" width="1278" data-original="https://pic3.zhimg.com/v2-cc7180a096b811aa377bf2270a859cba_r.jpg" data-actualsrc="https://pic3.zhimg.com/v2-cc7180a096b811aa377bf2270a859cba_b.jpg"/></figure><h3>2. 数学描述</h3><p>Causal structure 给定，用一个 directed acyclic graph (DAG) <img src="https://www.zhihu.com/equation?tex=%5Cmathcal%7BG%7D" alt="\mathcal{G}" eeimg="1"/> 表示。图中有 N 个随机变量， <img src="https://www.zhihu.com/equation?tex=%5Cmathcal%7BX%7D+%3D+%5C%7BX_1%2C+%5Ccdots%2C+X_N%5C%7D" alt="\mathcal{X} = \{X_1, \cdots, X_N\}" eeimg="1"/> ，每个节点可能的取值有 k 种（离散的）。某个节点 <img src="https://www.zhihu.com/equation?tex=X_i" alt="X_i" eeimg="1"/> 的父节点记为 <img src="https://www.zhihu.com/equation?tex=%5Ctext%7BPa%7D_%7BX_i%7D" alt="\text{Pa}_{X_i}" eeimg="1"/> ，随机变量点 <img src="https://www.zhihu.com/equation?tex=X_i" alt="X_i" eeimg="1"/> 的分布由其所有父节点决定。存在一个在这些随机变量上的联合概率分布 P。行动（也叫 intervention）能够控制的节点为 <img src="https://www.zhihu.com/equation?tex=X%3D%5C%7BX_1%2C+%5Ccdots%2C+X_m%5C%7D+%5Csubset+%5Cmathcal%7BX%7D" alt="X=\{X_1, \cdots, X_m\} \subset \mathcal{X}" eeimg="1"/> ，一个行动记为 <img src="https://www.zhihu.com/equation?tex=a%3D%5Ctext%7Bdo%7D%28X%3Dx%29" alt="a=\text{do}(X=x)" eeimg="1"/> ，其中 <img src="https://www.zhihu.com/equation?tex=x%3D%5C%7Bx_1%2C+%5Ccdots%2C+x_m%5C%7D" alt="x=\{x_1, \cdots, x_m\}" eeimg="1"/> 为相应可以控制随机变量选定的值，也可以不对相应随机变量加以干涉，不妨记做 <img src="https://www.zhihu.com/equation?tex=x_i%3D0" alt="x_i=0" eeimg="1"/> 。目标是最大化奖励随机变量 Y 的取值，记 <img src="https://www.zhihu.com/equation?tex=%5Ctext%7BPa%7D_Y%3DZ" alt="\text{Pa}_Y=Z" eeimg="1"/> 为直接决定 Y 取值的随机变量集合。</p><p>对于某个行动，其对应的奖励期望可以被写作 <img src="https://www.zhihu.com/equation?tex=%5Cmu_a+%3A%3D+%5Cmathbb%7BE%7D%5BY%7Ca%3D%5Ctext%7Bdo%7D%28X%3Dx%29%5D" alt="\mu_a := \mathbb{E}[Y|a=\text{do}(X=x)]" eeimg="1"/> 。Regret minimization 的目标就是通过每一回合选择合适的行动，使得 regret <img src="https://www.zhihu.com/equation?tex=%5Cmathbb%7BE%7D%5BR_T%5D+%3D+T+%5Cmu%5E%2A+-+%5Csum_%7Bt%3D1%7D%5ET+%5Cmathbb%7BE%7D+%5B%5Cmu_%7Ba_t%7D%5D" alt="\mathbb{E}[R_T] = T \mu^* - \sum_{t=1}^T \mathbb{E} [\mu_{a_t}]" eeimg="1"/> 最小，其中 <img src="https://www.zhihu.com/equation?tex=%5Cmu%5E%2A+%3D+%5Cmax_%7Ba%7D+%5Cmu_a" alt="\mu^* = \max_{a} \mu_a" eeimg="1"/> 。</p><h3>3. C-UCB</h3><p>为了解决上述问题，文中提出 causal UCB (C-UCB) 方法。</p><figure data-size="normal"><img src="https://pic2.zhimg.com/v2-2a110451a5d7528f78265a66c1804055_b.jpg" data-caption="" data-size="normal" data-rawwidth="1319" data-rawheight="571" class="origin_image zh-lightbox-thumb" width="1319" data-original="https://pic2.zhimg.com/v2-2a110451a5d7528f78265a66c1804055_r.jpg"/><img src="data:image/svg+xml;utf8,&lt;svg xmlns=&#39;http://www.w3.org/2000/svg&#39; width=&#39;1319&#39; height=&#39;571&#39;&gt;&lt;/svg&gt;" data-caption="" data-size="normal" data-rawwidth="1319" data-rawheight="571" class="origin_image zh-lightbox-thumb lazy" width="1319" data-original="https://pic2.zhimg.com/v2-2a110451a5d7528f78265a66c1804055_r.jpg" data-actualsrc="https://pic2.zhimg.com/v2-2a110451a5d7528f78265a66c1804055_b.jpg"/></figure><p>其实比较直接。直接的 UCB 方法对于每一个 action 维护一个 UCB 数值，这里转而对每个不同的 Z 的取值维护 UCB 数值，由于 <img src="https://www.zhihu.com/equation?tex=%7CZ%7C%3Dn" alt="|Z|=n" eeimg="1"/> 并且每个随机变量有 k 个可能的数值，因此需要维护 <img src="https://www.zhihu.com/equation?tex=k%5En" alt="k^n" eeimg="1"/> 个 UCB 的值。由于已知了 causal graph，action 对随机变量 Z 产生的影响可以被计算出来，从而能够知道不同的 action 对应 UCB 的期望值。</p><p>该算法能够得到如下的 regret bound。</p><figure data-size="normal"><img src="https://pic3.zhimg.com/v2-4038ec9713271fd054b4f336dcb7c87a_b.png" data-caption="" data-size="normal" data-rawwidth="1323" data-rawheight="219" class="origin_image zh-lightbox-thumb" width="1323" data-original="https://pic3.zhimg.com/v2-4038ec9713271fd054b4f336dcb7c87a_r.jpg"/><img src="data:image/svg+xml;utf8,&lt;svg xmlns=&#39;http://www.w3.org/2000/svg&#39; width=&#39;1323&#39; height=&#39;219&#39;&gt;&lt;/svg&gt;" data-caption="" data-size="normal" data-rawwidth="1323" data-rawheight="219" class="origin_image zh-lightbox-thumb lazy" width="1323" data-original="https://pic3.zhimg.com/v2-4038ec9713271fd054b4f336dcb7c87a_r.jpg" data-actualsrc="https://pic3.zhimg.com/v2-4038ec9713271fd054b4f336dcb7c87a_b.png"/></figure><h3>4. C-TS</h3><p>类似。（TS 不太熟，没仔细看了）</p><figure data-size="normal"><img src="https://pic2.zhimg.com/v2-70e3ef7a900afd11ddcefa98b979e03d_b.jpg" data-caption="" data-size="normal" data-rawwidth="1300" data-rawheight="721" class="origin_image zh-lightbox-thumb" width="1300" data-original="https://pic2.zhimg.com/v2-70e3ef7a900afd11ddcefa98b979e03d_r.jpg"/><img src="data:image/svg+xml;utf8,&lt;svg xmlns=&#39;http://www.w3.org/2000/svg&#39; width=&#39;1300&#39; height=&#39;721&#39;&gt;&lt;/svg&gt;" data-caption="" data-size="normal" data-rawwidth="1300" data-rawheight="721" class="origin_image zh-lightbox-thumb lazy" width="1300" data-original="https://pic2.zhimg.com/v2-70e3ef7a900afd11ddcefa98b979e03d_r.jpg" data-actualsrc="https://pic2.zhimg.com/v2-70e3ef7a900afd11ddcefa98b979e03d_b.jpg"/></figure><figure data-size="normal"><img src="https://pic4.zhimg.com/v2-edcf1155e6427d22979639548f2437a7_b.png" data-caption="" data-size="normal" data-rawwidth="1308" data-rawheight="212" class="origin_image zh-lightbox-thumb" width="1308" data-original="https://pic4.zhimg.com/v2-edcf1155e6427d22979639548f2437a7_r.jpg"/><img src="data:image/svg+xml;utf8,&lt;svg xmlns=&#39;http://www.w3.org/2000/svg&#39; width=&#39;1308&#39; height=&#39;212&#39;&gt;&lt;/svg&gt;" data-caption="" data-size="normal" data-rawwidth="1308" data-rawheight="212" class="origin_image zh-lightbox-thumb lazy" width="1308" data-original="https://pic4.zhimg.com/v2-edcf1155e6427d22979639548f2437a7_r.jpg" data-actualsrc="https://pic4.zhimg.com/v2-edcf1155e6427d22979639548f2437a7_b.png"/></figure><h3>5. 线性模型</h3><p>假设奖励 Y 可以被写成 Z 的线性函数</p><figure data-size="normal"><img src="https://pic1.zhimg.com/v2-4a7fa7acb2c2f900df411d8c7481a834_b.png" data-caption="" data-size="normal" data-rawwidth="1284" data-rawheight="170" class="origin_image zh-lightbox-thumb" width="1284" data-original="https://pic1.zhimg.com/v2-4a7fa7acb2c2f900df411d8c7481a834_r.jpg"/><img src="data:image/svg+xml;utf8,&lt;svg xmlns=&#39;http://www.w3.org/2000/svg&#39; width=&#39;1284&#39; height=&#39;170&#39;&gt;&lt;/svg&gt;" data-caption="" data-size="normal" data-rawwidth="1284" data-rawheight="170" class="origin_image zh-lightbox-thumb lazy" width="1284" data-original="https://pic1.zhimg.com/v2-4a7fa7acb2c2f900df411d8c7481a834_r.jpg" data-actualsrc="https://pic1.zhimg.com/v2-4a7fa7acb2c2f900df411d8c7481a834_b.png"/></figure><p>对于某个行动的奖励期望可以被写作</p><figure data-size="normal"><img src="https://pic3.zhimg.com/v2-b4cb337ba32065e13370132e6efd616a_b.png" data-caption="" data-size="normal" data-rawwidth="1300" data-rawheight="216" class="origin_image zh-lightbox-thumb" width="1300" data-original="https://pic3.zhimg.com/v2-b4cb337ba32065e13370132e6efd616a_r.jpg"/><img src="data:image/svg+xml;utf8,&lt;svg xmlns=&#39;http://www.w3.org/2000/svg&#39; width=&#39;1300&#39; height=&#39;216&#39;&gt;&lt;/svg&gt;" data-caption="" data-size="normal" data-rawwidth="1300" data-rawheight="216" class="origin_image zh-lightbox-thumb lazy" width="1300" data-original="https://pic3.zhimg.com/v2-b4cb337ba32065e13370132e6efd616a_r.jpg" data-actualsrc="https://pic3.zhimg.com/v2-b4cb337ba32065e13370132e6efd616a_b.png"/></figure><p>类似地，能够得到相应的线性算法，CL-UCB 和 CL-TS。</p><h3>6. 和普通 bandit 问题解法比较</h3><p>文章想说明在特定的情形下，使用 causal information 对应的算法，相比于不使用这些信息得到的算法，性能上有提升。</p><p>考虑如下问题：一共有 N 个随机变量，每个随机变量有两种可能的取值，最后奖励只和第一个随机变量的取值有关，即 <img src="https://www.zhihu.com/equation?tex=Y+%3D+%5CDelta+%5Ccdot+X_1+%2B+%5Cepsilon%2C+%5Cquad++%5Cepsilon+%5Csim+N%280%2C1%29" alt="Y = \Delta \cdot X_1 + \epsilon, \quad  \epsilon \sim N(0,1)" eeimg="1"/> 。</p><p>根据前面的分析 C-UCB 算法 regret 为 <img src="https://www.zhihu.com/equation?tex=O%28%5Csqrt%7Bk%5En+T%7D%29+%3D+O%28%5Csqrt%7B2%5E1+T%7D%29" alt="O(\sqrt{k^n T}) = O(\sqrt{2^1 T})" eeimg="1"/> ；而在该问题中，如果不使用 causal information，使用 UCB 算法 regret 为 <img src="https://www.zhihu.com/equation?tex=O%28%5Csqrt%7B3%5EN+T%7D%29" alt="O(\sqrt{3^N T})" eeimg="1"/> ，会随着整体随机变量数目的增长而增长。</p><p>直观上来讲，由于知道了不同 action 如何影响 Z，即可以间接控制 Z；因此，对 Z 做 UCB 肯定会更直接；当 Z 的维度小的时候，用 causal information 当然效果会更明显。</p><hr/><p>感觉实现需要知道 causal graph 就已经比较 bug 了，更 bug 的是，还能准确定量地得到不同 action 产生的不同随机变量 Z 的分布。</p></div></div><div class="ContentItem-time">发布于 2019-10-17</div><div class="Post-topicsAndReviewer"><div class="TopicList Post-Topics"><div class="Tag Topic"><span class="Tag-content"><a class="TopicLink" href="//www.zhihu.com/topic/20039099" target="_blank"><div class="Popover"><div id="null-toggle" aria-haspopup="true" aria-expanded="false" aria-owns="null-content">强化学习 (Reinforcement Learning)</div></div></a></span></div><div class="Tag Topic"><span class="Tag-content"><a class="TopicLink" href="//www.zhihu.com/topic/19555677" target="_blank"><div class="Popover"><div id="null-toggle" aria-haspopup="true" aria-expanded="false" aria-owns="null-content">遗传算法</div></div></a></span></div><div class="Tag Topic"><span class="Tag-content"><a class="TopicLink" href="//www.zhihu.com/topic/19559450" target="_blank"><div class="Popover"><div id="null-toggle" aria-haspopup="true" aria-expanded="false" aria-owns="null-content">机器学习</div></div></a></span></div></div></div><div><div class="Sticky RichContent-actions is-bottom"><div class="ContentItem-actions"><span><button aria-label="赞同 23 " type="button" class="Button VoteButton VoteButton--up"><span style="display:inline-flex;align-items:center">​<svg class="Zi Zi--TriangleUp VoteButton-TriangleUp" fill="currentColor" viewBox="0 0 24 24" width="10" height="10"><path d="M2 18.242c0-.326.088-.532.237-.896l7.98-13.203C10.572 3.57 11.086 3 12 3c.915 0 1.429.571 1.784 1.143l7.98 13.203c.15.364.236.57.236.896 0 1.386-.875 1.9-1.955 1.9H3.955c-1.08 0-1.955-.517-1.955-1.9z" fill-rule="evenodd"></path></svg></span>赞同 23</button><button aria-label="反对" type="button" class="Button VoteButton VoteButton--down"><span style="display:inline-flex;align-items:center">​<svg class="Zi Zi--TriangleDown" fill="currentColor" viewBox="0 0 24 24" width="10" height="10"><path d="M20.044 3H3.956C2.876 3 2 3.517 2 4.9c0 .326.087.533.236.896L10.216 19c.355.571.87 1.143 1.784 1.143s1.429-.572 1.784-1.143l7.98-13.204c.149-.363.236-.57.236-.896 0-1.386-.876-1.9-1.956-1.9z" fill-rule="evenodd"></path></svg></span></button></span><button type="button" class="Button BottomActions-CommentBtn Button--plain Button--withIcon Button--withLabel"><span style="display:inline-flex;align-items:center">​<svg class="Zi Zi--Comment Button-zi" fill="currentColor" viewBox="0 0 24 24" width="1.2em" height="1.2em"><path d="M10.241 19.313a.97.97 0 0 0-.77.2 7.908 7.908 0 0 1-3.772 1.482.409.409 0 0 1-.38-.637 5.825 5.825 0 0 0 1.11-2.237.605.605 0 0 0-.227-.59A7.935 7.935 0 0 1 3 11.25C3 6.7 7.03 3 12 3s9 3.7 9 8.25-4.373 9.108-10.759 8.063z" fill-rule="evenodd"></path></svg></span>添加评论</button><div class="Popover ShareMenu"><div class="ShareMenu-toggler" id="null-toggle" aria-haspopup="true" aria-expanded="false" aria-owns="null-content"><button type="button" class="Button Button--plain Button--withIcon Button--withLabel"><span style="display:inline-flex;align-items:center">​<svg class="Zi Zi--Share Button-zi" fill="currentColor" viewBox="0 0 24 24" width="1.2em" height="1.2em"><path d="M2.931 7.89c-1.067.24-1.275 1.669-.318 2.207l5.277 2.908 8.168-4.776c.25-.127.477.198.273.39L9.05 14.66l.927 5.953c.18 1.084 1.593 1.376 2.182.456l9.644-15.242c.584-.892-.212-2.029-1.234-1.796L2.93 7.89z" fill-rule="evenodd"></path></svg></span>分享</button></div></div><button type="button" class="Button ContentItem-action Button--plain Button--withIcon Button--withLabel"><span style="display:inline-flex;align-items:center">​<svg class="Zi Zi--Heart Button-zi" fill="currentColor" viewBox="0 0 24 24" width="1.2em" height="1.2em"><path d="M2 8.437C2 5.505 4.294 3.094 7.207 3 9.243 3 11.092 4.19 12 6c.823-1.758 2.649-3 4.651-3C19.545 3 22 5.507 22 8.432 22 16.24 13.842 21 12 21 10.158 21 2 16.24 2 8.437z" fill-rule="evenodd"></path></svg></span>喜欢</button><button type="button" class="Button ContentItem-action Button--plain Button--withIcon Button--withLabel"><span style="display:inline-flex;align-items:center">​<svg class="Zi Zi--Star Button-zi" fill="currentColor" viewBox="0 0 24 24" width="1.2em" height="1.2em"><path d="M5.515 19.64l.918-5.355-3.89-3.792c-.926-.902-.639-1.784.64-1.97L8.56 7.74l2.404-4.871c.572-1.16 1.5-1.16 2.072 0L15.44 7.74l5.377.782c1.28.186 1.566 1.068.64 1.97l-3.89 3.793.918 5.354c.219 1.274-.532 1.82-1.676 1.218L12 18.33l-4.808 2.528c-1.145.602-1.896.056-1.677-1.218z" fill-rule="evenodd"></path></svg></span>收藏</button><div class="Post-ActionMenuButton"><div class="Popover"><div id="null-toggle" aria-haspopup="true" aria-expanded="false" aria-owns="null-content"><button type="button" class="Button Button--plain Button--withIcon Button--iconOnly"><span style="display:inline-flex;align-items:center">​<svg class="Zi Zi--Dots Button-zi" fill="currentColor" viewBox="0 0 24 24" width="1.2em" height="1.2em"><path d="M5 14a2 2 0 1 1 0-4 2 2 0 0 1 0 4zm7 0a2 2 0 1 1 0-4 2 2 0 0 1 0 4zm7 0a2 2 0 1 1 0-4 2 2 0 0 1 0 4z" fill-rule="evenodd"></path></svg></span></button></div></div></div></div></div></div></article><div class="Post-Sub Post-NormalSub"><div class="PostIndex-Contributions"><h3 class="BlockTitle">文章被以下专栏收录</h3><ul><div class="ContentItem Column-ColumnItem"><div class="ContentItem-main"><div class="ContentItem-image"><a class="ColumnLink" href="/reinforcementlearning"><div class="Popover"><div id="null-toggle" aria-haspopup="true" aria-expanded="false" aria-owns="null-content"><img class="Avatar Avatar--medium Avatar--round" width="40" height="40" src="https://pic2.zhimg.com/v2-5d1f04a84f6be8896c07a32a05e1d6d1_xs.jpg" srcSet="https://pic2.zhimg.com/v2-5d1f04a84f6be8896c07a32a05e1d6d1_l.jpg 2x" alt="强化学习前沿"/></div></div></a></div><div class="ContentItem-head"><h2 class="ContentItem-title"><a class="ColumnLink ColumnItem-Title" href="/reinforcementlearning"><div class="Popover"><div id="null-toggle" aria-haspopup="true" aria-expanded="false" aria-owns="null-content">强化学习前沿</div></div></a></h2><div class="ContentItem-meta">读呀读paper</div></div><div class="ContentItem-extra"><a href="/reinforcementlearning" type="button" class="Button">进入专栏</a></div></div></div></ul></div></div></div></main></div></div><script nonce="07b0057e-1ce8-4229-9863-34ad4d86e7d8" async="" src="https://www.googletagmanager.com/gtag/js?id=UA-149949619-1"></script><script nonce="07b0057e-1ce8-4229-9863-34ad4d86e7d8">function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","UA-149949619-1");</script><script id="js-clientConfig" type="text/json">{"host":"zhihu.com","protocol":"https:","wwwHost":"www.zhihu.com","fetchRoot":{"www":"https:\u002F\u002Fwww.zhihu.com","api":"https:\u002F\u002Fapi.zhihu.com","zhuanlan":"https:\u002F\u002Fzhuanlan.zhihu.com"}}</script><script id="js-initialData" type="text/json">{"initialState":{"common":{"ask":{}},"loading":{"global":{"count":0},"local":{"env\u002FgetIpinfo\u002F":false,"article\u002Fget\u002F":false,"brand\u002FgetUrl\u002F":false}},"club":{"tags":{}},"entities":{"users":{"zhang-chu-heng":{"isFollowed":false,"avatarUrlTemplate":"https:\u002F\u002Fpic4.zhimg.com\u002Fv2-2b7c11f27a7fd03282819889435815aa_{size}.jpg","uid":"35077274730496","userType":"people","isFollowing":false,"urlToken":"zhang-chu-heng","id":"db39e3e0528520071b0a6e5f6240cfea","description":"","name":"张楚珩","isAdvertiser":false,"headline":"强化学习 量化投资","gender":1,"url":"\u002Fpeople\u002Fdb39e3e0528520071b0a6e5f6240cfea","avatarUrl":"https:\u002F\u002Fpic4.zhimg.com\u002Fv2-2b7c11f27a7fd03282819889435815aa_l.jpg","isOrg":false,"type":"people","badge":[{"type":"identity","topics":[],"description":"清华大学 交叉信息院博士在读"}],"exposedMedal":{"medalId":"1124316222665379841","medalName":"我的知乎 2019","avatarUrl":"https:\u002F\u002Fpic3.zhimg.com\u002Fv2-2592b0b52e1fac99f69b38e00252413b_r.png","miniAvatarUrl":"https:\u002F\u002Fpic3.zhimg.com\u002Fv2-ad363cc3088dc8de7544fd08b1c4987a_is.png","description":"参与「我的知乎 2019」即可获得"}}},"questions":{},"answers":{},"articles":{"87200142":{"trackUrl":["https:\u002F\u002Fsugar.zhihu.com\u002Fplutus_adreaper\u002Fpage_monitor_log?si=__SESSIONID__&ti=__ATOKEN__&at=view&pf=__OS__&ed=__MEMBERID__&idfa=__IDFA__&imei=__IMEI__&androidid=__ANDROIDID__&oaid=__OAID__&ci=__CREATIVEID__"],"id":87200142,"title":"【强化学习 96】Causal Bandit","type":"article","excerptTitle":"","url":"https:\u002F\u002Fzhuanlan.zhihu.com\u002Fp\u002F87200142","imageUrl":"https:\u002F\u002Fpic3.zhimg.com\u002Fv2-93cc1b5c7e4a555a6f7a5c0d79373f4d_b.jpg","titleImage":"https:\u002F\u002Fpic3.zhimg.com\u002Fv2-93cc1b5c7e4a555a6f7a5c0d79373f4d_b.jpg","excerpt":"\u003Cimg src=\"https:\u002F\u002Fpic2.zhimg.com\u002Fv2-6d063e6f3c890a2a4c6ad2c255d052e1_200x112.png\" data-caption=\"\" data-size=\"normal\" data-rawwidth=\"720\" data-rawheight=\"279\" data-watermark=\"watermark\" data-original-src=\"v2-6d063e6f3c890a2a4c6ad2c255d052e1\" data-watermark-src=\"v2-e75812e425f165a3ddb88db58457bd60\" data-private-watermark-src=\"\" class=\"origin_image inline-img zh-lightbox-thumb\" data-original=\"https:\u002F\u002Fpic2.zhimg.com\u002Fv2-6d063e6f3c890a2a4c6ad2c255d052e1_r.png\"\u002F\u003E提出一种 bandit problem + causal inference 相结合的问题，给出相应的算法。原文传送门\u003Ca href=\"https:\u002F\u002Flink.zhihu.com\u002F?target=https%3A\u002F\u002Fpapers.nips.cc\u002Fpaper\u002F6195-causal-bandits-learning-good-interventions-via-causal-inference.pdf\" class=\" wrap external\" target=\"_blank\" rel=\"nofollow noreferrer\"\u003ELattimore, Finnian, Tor Lattimore, and Mark D. Reid. &#34;Causal bandits: Learning good interventions via causal inference.&#34; Advances in Neural Information Pro…\u003C\u002Fa\u003E","created":1571317237,"updated":1571317237,"author":{"isFollowed":false,"avatarUrlTemplate":"https:\u002F\u002Fpic4.zhimg.com\u002Fv2-2b7c11f27a7fd03282819889435815aa_{size}.jpg","uid":"35077274730496","userType":"people","isFollowing":false,"urlToken":"zhang-chu-heng","id":"db39e3e0528520071b0a6e5f6240cfea","description":"","name":"张楚珩","isAdvertiser":false,"headline":"强化学习 量化投资","gender":1,"url":"\u002Fpeople\u002Fdb39e3e0528520071b0a6e5f6240cfea","avatarUrl":"https:\u002F\u002Fpic4.zhimg.com\u002Fv2-2b7c11f27a7fd03282819889435815aa_l.jpg","isOrg":false,"type":"people","badge":[{"type":"identity","topics":[],"description":"清华大学 交叉信息院博士在读"}],"exposedMedal":{"medalId":"1124316222665379841","medalName":"我的知乎 2019","avatarUrl":"https:\u002F\u002Fpic3.zhimg.com\u002Fv2-2592b0b52e1fac99f69b38e00252413b_r.png","miniAvatarUrl":"https:\u002F\u002Fpic3.zhimg.com\u002Fv2-ad363cc3088dc8de7544fd08b1c4987a_is.png","description":"参与「我的知乎 2019」即可获得"}},"commentPermission":"all","state":"published","imageWidth":1244,"imageHeight":564,"content":"\u003Cp\u003E提出一种 bandit problem + causal inference 相结合的问题，给出相应的算法。\u003C\u002Fp\u003E\u003Ch2\u003E原文传送门\u003C\u002Fh2\u003E\u003Cp\u003E\u003Ca href=\"https:\u002F\u002Flink.zhihu.com\u002F?target=https%3A\u002F\u002Fpapers.nips.cc\u002Fpaper\u002F6195-causal-bandits-learning-good-interventions-via-causal-inference.pdf\" class=\" wrap external\" target=\"_blank\" rel=\"nofollow noreferrer\"\u003ELattimore, Finnian, Tor Lattimore, and Mark D. Reid. &#34;Causal bandits: Learning good interventions via causal inference.&#34; Advances in Neural Information Processing Systems. 2016.\u003C\u002Fa\u003E（提出 causal bandit problem，提出解决 best arm identification 问题的算法，分析了 simple regret）\u003C\u002Fp\u003E\u003Cp\u003E\u003Ca href=\"https:\u002F\u002Flink.zhihu.com\u002F?target=https%3A\u002F\u002Farxiv.org\u002Fabs\u002F1910.04938\" class=\" wrap external\" target=\"_blank\" rel=\"nofollow noreferrer\"\u003EYangyi Lu, Amirhossein Meisami, Ambuj Tewari, and Zhenyu Yan. &#34;Regret Analysis of Causal Bandit Problems.&#34; Arxiv preprint 1910.04938\u003C\u002Fa\u003E（提出 UCB\u002FTS 方法来解决 causal bandit 里面的探索-利用问题）\u003C\u002Fp\u003E\u003Ch2\u003E特色\u003C\u002Fh2\u003E\u003Cp\u003E十月份的新 paper，在之前提出了一种比较新的问题 causal bandit problem 的基础上，设计了基于 upper confidence bound (UCB) 和 Thompson sampling (TS) 的方法。由于使用了 causal information，其在理论上和实验上都有更好的效果（更小的 regret）。\u003C\u002Fp\u003E\u003Ch2\u003E过程\u003C\u002Fh2\u003E\u003Ch3\u003E1. 问题举例\u003C\u002Fh3\u003E\u003Cp\u003E先来看几个现实生活里面可能遇到的问题，来作为 causal bandit problem 的例子。\u003C\u002Fp\u003E\u003Cp\u003E\u003Cb\u003E\u003Cu\u003E农夫种地\u003C\u002Fu\u003E\u003C\u002Fb\u003E\u003C\u002Fp\u003E\u003Cp\u003E这个例子来自于第一篇 paper。农民种地，目标是增加农作物的产量。跟农作物产量直接相关的有如下因素：1）温度；2）土壤中的某种营养物质含量；3）土壤湿度。但是农夫只能够通过一些操作来间接控制这些变量，比如：A）增加大棚遮阴或者用电热灯加热；B）使用或者不使用某种特殊的化肥；C）灌溉或者使用一种防水膜。\u003C\u002Fp\u003E\u003Cp\u003E这个问题其实可以被看做是一个标准的 bandit problem，不同的 A-C 的组合看做不同的 arm，农作物的产量看做是 reward。但是现实中，我们可以知道一些额外的信息，比如各个变量之间的因果关系（known causal structure）、虽然不能控制但是能够测量直接的决定因素（比如 1-3）。Causal bandit problem 就是新增了已知的 causal graph 和可以观察到的决定性因素。在这个问题里面，causal graph 可以被画成下面的形式。\u003C\u002Fp\u003E\u003Cfigure data-size=\"normal\"\u003E\u003Cnoscript\u003E\u003Cimg src=\"https:\u002F\u002Fpic1.zhimg.com\u002Fv2-e75812e425f165a3ddb88db58457bd60_b.jpg\" data-caption=\"\" data-size=\"normal\" data-rawwidth=\"720\" data-rawheight=\"279\" class=\"origin_image zh-lightbox-thumb\" width=\"720\" data-original=\"https:\u002F\u002Fpic1.zhimg.com\u002Fv2-e75812e425f165a3ddb88db58457bd60_r.jpg\"\u002F\u003E\u003C\u002Fnoscript\u003E\u003Cimg src=\"data:image\u002Fsvg+xml;utf8,&lt;svg xmlns=&#39;http:\u002F\u002Fwww.w3.org\u002F2000\u002Fsvg&#39; width=&#39;720&#39; height=&#39;279&#39;&gt;&lt;\u002Fsvg&gt;\" data-caption=\"\" data-size=\"normal\" data-rawwidth=\"720\" data-rawheight=\"279\" class=\"origin_image zh-lightbox-thumb lazy\" width=\"720\" data-original=\"https:\u002F\u002Fpic1.zhimg.com\u002Fv2-e75812e425f165a3ddb88db58457bd60_r.jpg\" data-actualsrc=\"https:\u002F\u002Fpic1.zhimg.com\u002Fv2-e75812e425f165a3ddb88db58457bd60_b.jpg\"\u002F\u003E\u003C\u002Ffigure\u003E\u003Cp\u003E在 causal bandit problem 中当然也可以和 bandit problem 类似解决不同的问题，比如 best arm identification 和 regret minimization。\u003C\u002Fp\u003E\u003Cp\u003E\u003Cb\u003E\u003Cu\u003EEmail Champaign\u003C\u002Fu\u003E\u003C\u002Fb\u003E\u003C\u002Fp\u003E\u003Cp\u003E第二篇 paper 提供了另一个例子。Adobe 公司希望给用户发广告邮件，目标是希望增大用户把邮件点开的概率。蓝色节点表示可以控制的变量，有产品的种类（比如是 PS 还是 Acrobat）、邮件的目的（比如是福利还是营销）、发送的时间（比如是早上还是晚上）等。公司有一个邮件库，指定了蓝色节点对应的数值之后，就从邮件库里面选一个邮件给用户发，根据用户的不同反馈得到不同的奖励。但是最后决定用户会不会点击的是 \u003Cimg src=\"https:\u002F\u002Fwww.zhihu.com\u002Fequation?tex=Z_1%2C+Z_2%2C+Z_3\" alt=\"Z_1, Z_2, Z_3\" eeimg=\"1\"\u002F\u003E 三个因素，其相互关系如下图所示。（图中的数值表示每种随机变量有几种可能的取值）。注意到对于蓝色的节点来说，也可以不指定一个数值，这样就从其本身的一个分布中采样。\u003C\u002Fp\u003E\u003Cfigure data-size=\"normal\"\u003E\u003Cnoscript\u003E\u003Cimg src=\"https:\u002F\u002Fpic3.zhimg.com\u002Fv2-cc7180a096b811aa377bf2270a859cba_b.jpg\" data-caption=\"\" data-size=\"normal\" data-rawwidth=\"1278\" data-rawheight=\"373\" class=\"origin_image zh-lightbox-thumb\" width=\"1278\" data-original=\"https:\u002F\u002Fpic3.zhimg.com\u002Fv2-cc7180a096b811aa377bf2270a859cba_r.jpg\"\u002F\u003E\u003C\u002Fnoscript\u003E\u003Cimg src=\"data:image\u002Fsvg+xml;utf8,&lt;svg xmlns=&#39;http:\u002F\u002Fwww.w3.org\u002F2000\u002Fsvg&#39; width=&#39;1278&#39; height=&#39;373&#39;&gt;&lt;\u002Fsvg&gt;\" data-caption=\"\" data-size=\"normal\" data-rawwidth=\"1278\" data-rawheight=\"373\" class=\"origin_image zh-lightbox-thumb lazy\" width=\"1278\" data-original=\"https:\u002F\u002Fpic3.zhimg.com\u002Fv2-cc7180a096b811aa377bf2270a859cba_r.jpg\" data-actualsrc=\"https:\u002F\u002Fpic3.zhimg.com\u002Fv2-cc7180a096b811aa377bf2270a859cba_b.jpg\"\u002F\u003E\u003C\u002Ffigure\u003E\u003Ch3\u003E2. 数学描述\u003C\u002Fh3\u003E\u003Cp\u003ECausal structure 给定，用一个 directed acyclic graph (DAG) \u003Cimg src=\"https:\u002F\u002Fwww.zhihu.com\u002Fequation?tex=%5Cmathcal%7BG%7D\" alt=\"\\mathcal{G}\" eeimg=\"1\"\u002F\u003E 表示。图中有 N 个随机变量， \u003Cimg src=\"https:\u002F\u002Fwww.zhihu.com\u002Fequation?tex=%5Cmathcal%7BX%7D+%3D+%5C%7BX_1%2C+%5Ccdots%2C+X_N%5C%7D\" alt=\"\\mathcal{X} = \\{X_1, \\cdots, X_N\\}\" eeimg=\"1\"\u002F\u003E ，每个节点可能的取值有 k 种（离散的）。某个节点 \u003Cimg src=\"https:\u002F\u002Fwww.zhihu.com\u002Fequation?tex=X_i\" alt=\"X_i\" eeimg=\"1\"\u002F\u003E 的父节点记为 \u003Cimg src=\"https:\u002F\u002Fwww.zhihu.com\u002Fequation?tex=%5Ctext%7BPa%7D_%7BX_i%7D\" alt=\"\\text{Pa}_{X_i}\" eeimg=\"1\"\u002F\u003E ，随机变量点 \u003Cimg src=\"https:\u002F\u002Fwww.zhihu.com\u002Fequation?tex=X_i\" alt=\"X_i\" eeimg=\"1\"\u002F\u003E 的分布由其所有父节点决定。存在一个在这些随机变量上的联合概率分布 P。行动（也叫 intervention）能够控制的节点为 \u003Cimg src=\"https:\u002F\u002Fwww.zhihu.com\u002Fequation?tex=X%3D%5C%7BX_1%2C+%5Ccdots%2C+X_m%5C%7D+%5Csubset+%5Cmathcal%7BX%7D\" alt=\"X=\\{X_1, \\cdots, X_m\\} \\subset \\mathcal{X}\" eeimg=\"1\"\u002F\u003E ，一个行动记为 \u003Cimg src=\"https:\u002F\u002Fwww.zhihu.com\u002Fequation?tex=a%3D%5Ctext%7Bdo%7D%28X%3Dx%29\" alt=\"a=\\text{do}(X=x)\" eeimg=\"1\"\u002F\u003E ，其中 \u003Cimg src=\"https:\u002F\u002Fwww.zhihu.com\u002Fequation?tex=x%3D%5C%7Bx_1%2C+%5Ccdots%2C+x_m%5C%7D\" alt=\"x=\\{x_1, \\cdots, x_m\\}\" eeimg=\"1\"\u002F\u003E 为相应可以控制随机变量选定的值，也可以不对相应随机变量加以干涉，不妨记做 \u003Cimg src=\"https:\u002F\u002Fwww.zhihu.com\u002Fequation?tex=x_i%3D0\" alt=\"x_i=0\" eeimg=\"1\"\u002F\u003E 。目标是最大化奖励随机变量 Y 的取值，记 \u003Cimg src=\"https:\u002F\u002Fwww.zhihu.com\u002Fequation?tex=%5Ctext%7BPa%7D_Y%3DZ\" alt=\"\\text{Pa}_Y=Z\" eeimg=\"1\"\u002F\u003E 为直接决定 Y 取值的随机变量集合。\u003C\u002Fp\u003E\u003Cp\u003E对于某个行动，其对应的奖励期望可以被写作 \u003Cimg src=\"https:\u002F\u002Fwww.zhihu.com\u002Fequation?tex=%5Cmu_a+%3A%3D+%5Cmathbb%7BE%7D%5BY%7Ca%3D%5Ctext%7Bdo%7D%28X%3Dx%29%5D\" alt=\"\\mu_a := \\mathbb{E}[Y|a=\\text{do}(X=x)]\" eeimg=\"1\"\u002F\u003E 。Regret minimization 的目标就是通过每一回合选择合适的行动，使得 regret \u003Cimg src=\"https:\u002F\u002Fwww.zhihu.com\u002Fequation?tex=%5Cmathbb%7BE%7D%5BR_T%5D+%3D+T+%5Cmu%5E%2A+-+%5Csum_%7Bt%3D1%7D%5ET+%5Cmathbb%7BE%7D+%5B%5Cmu_%7Ba_t%7D%5D\" alt=\"\\mathbb{E}[R_T] = T \\mu^* - \\sum_{t=1}^T \\mathbb{E} [\\mu_{a_t}]\" eeimg=\"1\"\u002F\u003E 最小，其中 \u003Cimg src=\"https:\u002F\u002Fwww.zhihu.com\u002Fequation?tex=%5Cmu%5E%2A+%3D+%5Cmax_%7Ba%7D+%5Cmu_a\" alt=\"\\mu^* = \\max_{a} \\mu_a\" eeimg=\"1\"\u002F\u003E 。\u003C\u002Fp\u003E\u003Ch3\u003E3. C-UCB\u003C\u002Fh3\u003E\u003Cp\u003E为了解决上述问题，文中提出 causal UCB (C-UCB) 方法。\u003C\u002Fp\u003E\u003Cfigure data-size=\"normal\"\u003E\u003Cnoscript\u003E\u003Cimg src=\"https:\u002F\u002Fpic2.zhimg.com\u002Fv2-2a110451a5d7528f78265a66c1804055_b.jpg\" data-caption=\"\" data-size=\"normal\" data-rawwidth=\"1319\" data-rawheight=\"571\" class=\"origin_image zh-lightbox-thumb\" width=\"1319\" data-original=\"https:\u002F\u002Fpic2.zhimg.com\u002Fv2-2a110451a5d7528f78265a66c1804055_r.jpg\"\u002F\u003E\u003C\u002Fnoscript\u003E\u003Cimg src=\"data:image\u002Fsvg+xml;utf8,&lt;svg xmlns=&#39;http:\u002F\u002Fwww.w3.org\u002F2000\u002Fsvg&#39; width=&#39;1319&#39; height=&#39;571&#39;&gt;&lt;\u002Fsvg&gt;\" data-caption=\"\" data-size=\"normal\" data-rawwidth=\"1319\" data-rawheight=\"571\" class=\"origin_image zh-lightbox-thumb lazy\" width=\"1319\" data-original=\"https:\u002F\u002Fpic2.zhimg.com\u002Fv2-2a110451a5d7528f78265a66c1804055_r.jpg\" data-actualsrc=\"https:\u002F\u002Fpic2.zhimg.com\u002Fv2-2a110451a5d7528f78265a66c1804055_b.jpg\"\u002F\u003E\u003C\u002Ffigure\u003E\u003Cp\u003E其实比较直接。直接的 UCB 方法对于每一个 action 维护一个 UCB 数值，这里转而对每个不同的 Z 的取值维护 UCB 数值，由于 \u003Cimg src=\"https:\u002F\u002Fwww.zhihu.com\u002Fequation?tex=%7CZ%7C%3Dn\" alt=\"|Z|=n\" eeimg=\"1\"\u002F\u003E 并且每个随机变量有 k 个可能的数值，因此需要维护 \u003Cimg src=\"https:\u002F\u002Fwww.zhihu.com\u002Fequation?tex=k%5En\" alt=\"k^n\" eeimg=\"1\"\u002F\u003E 个 UCB 的值。由于已知了 causal graph，action 对随机变量 Z 产生的影响可以被计算出来，从而能够知道不同的 action 对应 UCB 的期望值。\u003C\u002Fp\u003E\u003Cp\u003E该算法能够得到如下的 regret bound。\u003C\u002Fp\u003E\u003Cfigure data-size=\"normal\"\u003E\u003Cnoscript\u003E\u003Cimg src=\"https:\u002F\u002Fpic3.zhimg.com\u002Fv2-4038ec9713271fd054b4f336dcb7c87a_b.png\" data-caption=\"\" data-size=\"normal\" data-rawwidth=\"1323\" data-rawheight=\"219\" class=\"origin_image zh-lightbox-thumb\" width=\"1323\" data-original=\"https:\u002F\u002Fpic3.zhimg.com\u002Fv2-4038ec9713271fd054b4f336dcb7c87a_r.jpg\"\u002F\u003E\u003C\u002Fnoscript\u003E\u003Cimg src=\"data:image\u002Fsvg+xml;utf8,&lt;svg xmlns=&#39;http:\u002F\u002Fwww.w3.org\u002F2000\u002Fsvg&#39; width=&#39;1323&#39; height=&#39;219&#39;&gt;&lt;\u002Fsvg&gt;\" data-caption=\"\" data-size=\"normal\" data-rawwidth=\"1323\" data-rawheight=\"219\" class=\"origin_image zh-lightbox-thumb lazy\" width=\"1323\" data-original=\"https:\u002F\u002Fpic3.zhimg.com\u002Fv2-4038ec9713271fd054b4f336dcb7c87a_r.jpg\" data-actualsrc=\"https:\u002F\u002Fpic3.zhimg.com\u002Fv2-4038ec9713271fd054b4f336dcb7c87a_b.png\"\u002F\u003E\u003C\u002Ffigure\u003E\u003Ch3\u003E4. C-TS\u003C\u002Fh3\u003E\u003Cp\u003E类似。（TS 不太熟，没仔细看了）\u003C\u002Fp\u003E\u003Cfigure data-size=\"normal\"\u003E\u003Cnoscript\u003E\u003Cimg src=\"https:\u002F\u002Fpic2.zhimg.com\u002Fv2-70e3ef7a900afd11ddcefa98b979e03d_b.jpg\" data-caption=\"\" data-size=\"normal\" data-rawwidth=\"1300\" data-rawheight=\"721\" class=\"origin_image zh-lightbox-thumb\" width=\"1300\" data-original=\"https:\u002F\u002Fpic2.zhimg.com\u002Fv2-70e3ef7a900afd11ddcefa98b979e03d_r.jpg\"\u002F\u003E\u003C\u002Fnoscript\u003E\u003Cimg src=\"data:image\u002Fsvg+xml;utf8,&lt;svg xmlns=&#39;http:\u002F\u002Fwww.w3.org\u002F2000\u002Fsvg&#39; width=&#39;1300&#39; height=&#39;721&#39;&gt;&lt;\u002Fsvg&gt;\" data-caption=\"\" data-size=\"normal\" data-rawwidth=\"1300\" data-rawheight=\"721\" class=\"origin_image zh-lightbox-thumb lazy\" width=\"1300\" data-original=\"https:\u002F\u002Fpic2.zhimg.com\u002Fv2-70e3ef7a900afd11ddcefa98b979e03d_r.jpg\" data-actualsrc=\"https:\u002F\u002Fpic2.zhimg.com\u002Fv2-70e3ef7a900afd11ddcefa98b979e03d_b.jpg\"\u002F\u003E\u003C\u002Ffigure\u003E\u003Cfigure data-size=\"normal\"\u003E\u003Cnoscript\u003E\u003Cimg src=\"https:\u002F\u002Fpic4.zhimg.com\u002Fv2-edcf1155e6427d22979639548f2437a7_b.png\" data-caption=\"\" data-size=\"normal\" data-rawwidth=\"1308\" data-rawheight=\"212\" class=\"origin_image zh-lightbox-thumb\" width=\"1308\" data-original=\"https:\u002F\u002Fpic4.zhimg.com\u002Fv2-edcf1155e6427d22979639548f2437a7_r.jpg\"\u002F\u003E\u003C\u002Fnoscript\u003E\u003Cimg src=\"data:image\u002Fsvg+xml;utf8,&lt;svg xmlns=&#39;http:\u002F\u002Fwww.w3.org\u002F2000\u002Fsvg&#39; width=&#39;1308&#39; height=&#39;212&#39;&gt;&lt;\u002Fsvg&gt;\" data-caption=\"\" data-size=\"normal\" data-rawwidth=\"1308\" data-rawheight=\"212\" class=\"origin_image zh-lightbox-thumb lazy\" width=\"1308\" data-original=\"https:\u002F\u002Fpic4.zhimg.com\u002Fv2-edcf1155e6427d22979639548f2437a7_r.jpg\" data-actualsrc=\"https:\u002F\u002Fpic4.zhimg.com\u002Fv2-edcf1155e6427d22979639548f2437a7_b.png\"\u002F\u003E\u003C\u002Ffigure\u003E\u003Ch3\u003E5. 线性模型\u003C\u002Fh3\u003E\u003Cp\u003E假设奖励 Y 可以被写成 Z 的线性函数\u003C\u002Fp\u003E\u003Cfigure data-size=\"normal\"\u003E\u003Cnoscript\u003E\u003Cimg src=\"https:\u002F\u002Fpic1.zhimg.com\u002Fv2-4a7fa7acb2c2f900df411d8c7481a834_b.png\" data-caption=\"\" data-size=\"normal\" data-rawwidth=\"1284\" data-rawheight=\"170\" class=\"origin_image zh-lightbox-thumb\" width=\"1284\" data-original=\"https:\u002F\u002Fpic1.zhimg.com\u002Fv2-4a7fa7acb2c2f900df411d8c7481a834_r.jpg\"\u002F\u003E\u003C\u002Fnoscript\u003E\u003Cimg src=\"data:image\u002Fsvg+xml;utf8,&lt;svg xmlns=&#39;http:\u002F\u002Fwww.w3.org\u002F2000\u002Fsvg&#39; width=&#39;1284&#39; height=&#39;170&#39;&gt;&lt;\u002Fsvg&gt;\" data-caption=\"\" data-size=\"normal\" data-rawwidth=\"1284\" data-rawheight=\"170\" class=\"origin_image zh-lightbox-thumb lazy\" width=\"1284\" data-original=\"https:\u002F\u002Fpic1.zhimg.com\u002Fv2-4a7fa7acb2c2f900df411d8c7481a834_r.jpg\" data-actualsrc=\"https:\u002F\u002Fpic1.zhimg.com\u002Fv2-4a7fa7acb2c2f900df411d8c7481a834_b.png\"\u002F\u003E\u003C\u002Ffigure\u003E\u003Cp\u003E对于某个行动的奖励期望可以被写作\u003C\u002Fp\u003E\u003Cfigure data-size=\"normal\"\u003E\u003Cnoscript\u003E\u003Cimg src=\"https:\u002F\u002Fpic3.zhimg.com\u002Fv2-b4cb337ba32065e13370132e6efd616a_b.png\" data-caption=\"\" data-size=\"normal\" data-rawwidth=\"1300\" data-rawheight=\"216\" class=\"origin_image zh-lightbox-thumb\" width=\"1300\" data-original=\"https:\u002F\u002Fpic3.zhimg.com\u002Fv2-b4cb337ba32065e13370132e6efd616a_r.jpg\"\u002F\u003E\u003C\u002Fnoscript\u003E\u003Cimg src=\"data:image\u002Fsvg+xml;utf8,&lt;svg xmlns=&#39;http:\u002F\u002Fwww.w3.org\u002F2000\u002Fsvg&#39; width=&#39;1300&#39; height=&#39;216&#39;&gt;&lt;\u002Fsvg&gt;\" data-caption=\"\" data-size=\"normal\" data-rawwidth=\"1300\" data-rawheight=\"216\" class=\"origin_image zh-lightbox-thumb lazy\" width=\"1300\" data-original=\"https:\u002F\u002Fpic3.zhimg.com\u002Fv2-b4cb337ba32065e13370132e6efd616a_r.jpg\" data-actualsrc=\"https:\u002F\u002Fpic3.zhimg.com\u002Fv2-b4cb337ba32065e13370132e6efd616a_b.png\"\u002F\u003E\u003C\u002Ffigure\u003E\u003Cp\u003E类似地，能够得到相应的线性算法，CL-UCB 和 CL-TS。\u003C\u002Fp\u003E\u003Ch3\u003E6. 和普通 bandit 问题解法比较\u003C\u002Fh3\u003E\u003Cp\u003E文章想说明在特定的情形下，使用 causal information 对应的算法，相比于不使用这些信息得到的算法，性能上有提升。\u003C\u002Fp\u003E\u003Cp\u003E考虑如下问题：一共有 N 个随机变量，每个随机变量有两种可能的取值，最后奖励只和第一个随机变量的取值有关，即 \u003Cimg src=\"https:\u002F\u002Fwww.zhihu.com\u002Fequation?tex=Y+%3D+%5CDelta+%5Ccdot+X_1+%2B+%5Cepsilon%2C+%5Cquad++%5Cepsilon+%5Csim+N%280%2C1%29\" alt=\"Y = \\Delta \\cdot X_1 + \\epsilon, \\quad  \\epsilon \\sim N(0,1)\" eeimg=\"1\"\u002F\u003E 。\u003C\u002Fp\u003E\u003Cp\u003E根据前面的分析 C-UCB 算法 regret 为 \u003Cimg src=\"https:\u002F\u002Fwww.zhihu.com\u002Fequation?tex=O%28%5Csqrt%7Bk%5En+T%7D%29+%3D+O%28%5Csqrt%7B2%5E1+T%7D%29\" alt=\"O(\\sqrt{k^n T}) = O(\\sqrt{2^1 T})\" eeimg=\"1\"\u002F\u003E ；而在该问题中，如果不使用 causal information，使用 UCB 算法 regret 为 \u003Cimg src=\"https:\u002F\u002Fwww.zhihu.com\u002Fequation?tex=O%28%5Csqrt%7B3%5EN+T%7D%29\" alt=\"O(\\sqrt{3^N T})\" eeimg=\"1\"\u002F\u003E ，会随着整体随机变量数目的增长而增长。\u003C\u002Fp\u003E\u003Cp\u003E直观上来讲，由于知道了不同 action 如何影响 Z，即可以间接控制 Z；因此，对 Z 做 UCB 肯定会更直接；当 Z 的维度小的时候，用 causal information 当然效果会更明显。\u003C\u002Fp\u003E\u003Chr\u002F\u003E\u003Cp\u003E感觉实现需要知道 causal graph 就已经比较 bug 了，更 bug 的是，还能准确定量地得到不同 action 产生的不同随机变量 Z 的分布。\u003C\u002Fp\u003E","adminClosedComment":false,"topics":[{"url":"https:\u002F\u002Fwww.zhihu.com\u002Fapi\u002Fv4\u002Ftopics\u002F20039099","type":"topic","id":"20039099","name":"强化学习 (Reinforcement Learning)"},{"url":"https:\u002F\u002Fwww.zhihu.com\u002Fapi\u002Fv4\u002Ftopics\u002F19555677","type":"topic","id":"19555677","name":"遗传算法"},{"url":"https:\u002F\u002Fwww.zhihu.com\u002Fapi\u002Fv4\u002Ftopics\u002F19559450","type":"topic","id":"19559450","name":"机器学习"}],"voteupCount":23,"voting":0,"column":{"description":"读呀读paper","canManage":false,"intro":"我们的目标是通用人工智能！","isFollowing":false,"urlToken":"reinforcementlearning","id":"reinforcementlearning","articlesCount":137,"acceptSubmission":true,"title":"强化学习前沿","url":"https:\u002F\u002Fzhuanlan.zhihu.com\u002Freinforcementlearning","commentPermission":"all","created":1537150763,"updated":1541142463,"imageUrl":"https:\u002F\u002Fpic2.zhimg.com\u002Fv2-5d1f04a84f6be8896c07a32a05e1d6d1_b.jpg","author":{"isFollowed":false,"avatarUrlTemplate":"https:\u002F\u002Fpic4.zhimg.com\u002Fv2-2b7c11f27a7fd03282819889435815aa_{size}.jpg","uid":"35077274730496","userType":"people","isFollowing":false,"urlToken":"zhang-chu-heng","id":"db39e3e0528520071b0a6e5f6240cfea","description":"","name":"张楚珩","isAdvertiser":false,"headline":"强化学习 量化投资","gender":1,"url":"\u002Fpeople\u002Fdb39e3e0528520071b0a6e5f6240cfea","avatarUrl":"https:\u002F\u002Fpic4.zhimg.com\u002Fv2-2b7c11f27a7fd03282819889435815aa_l.jpg","isOrg":false,"type":"people"},"followers":4344,"type":"column"},"commentCount":0,"contributions":[{"id":21994056,"state":"accepted","type":"first_publish","column":{"description":"读呀读paper","canManage":false,"intro":"我们的目标是通用人工智能！","isFollowing":false,"urlToken":"reinforcementlearning","id":"reinforcementlearning","articlesCount":137,"acceptSubmission":true,"title":"强化学习前沿","url":"https:\u002F\u002Fzhuanlan.zhihu.com\u002Freinforcementlearning","commentPermission":"all","created":1537150763,"updated":1541142463,"imageUrl":"https:\u002F\u002Fpic2.zhimg.com\u002Fv2-5d1f04a84f6be8896c07a32a05e1d6d1_b.jpg","author":{"isFollowed":false,"avatarUrlTemplate":"https:\u002F\u002Fpic4.zhimg.com\u002Fv2-2b7c11f27a7fd03282819889435815aa_{size}.jpg","uid":"35077274730496","userType":"people","isFollowing":false,"urlToken":"zhang-chu-heng","id":"db39e3e0528520071b0a6e5f6240cfea","description":"","name":"张楚珩","isAdvertiser":false,"headline":"强化学习 量化投资","gender":1,"url":"\u002Fpeople\u002Fdb39e3e0528520071b0a6e5f6240cfea","avatarUrl":"https:\u002F\u002Fpic4.zhimg.com\u002Fv2-2b7c11f27a7fd03282819889435815aa_l.jpg","isOrg":false,"type":"people"},"followers":4344,"type":"column"}}],"isTitleImageFullScreen":false,"upvotedFollowees":[],"commercialInfo":{"isCommercial":false,"plugin":{}},"suggestEdit":{"status":false,"reason":"","tip":"","url":"","title":""},"reason":"","annotationAction":[],"canTip":false,"tipjarorsCount":0,"isLabeled":false,"hasPublishingDraft":false,"isFavorited":false,"isNormal":true,"status":0,"shareText":"【强化学习 96】Causal Bandit - 来自知乎专栏「强化学习前沿」，作者: 张楚珩 https:\u002F\u002Fzhuanlan.zhihu.com\u002Fp\u002F87200142 （想看更多？下载 @知乎 App：http:\u002F\u002Fweibo.com\u002Fp\u002F100404711598 ）","canComment":{"status":true,"reason":""},"mcnFpShow":-1,"isVisible":true,"isLiked":false,"likedCount":0,"visibleOnlyToAuthor":false}},"columns":{"reinforcementlearning":{"description":"读呀读paper","canManage":false,"intro":"我们的目标是通用人工智能！","isFollowing":false,"urlToken":"reinforcementlearning","id":"reinforcementlearning","articlesCount":137,"acceptSubmission":true,"title":"强化学习前沿","url":"https:\u002F\u002Fzhuanlan.zhihu.com\u002Freinforcementlearning","commentPermission":"all","created":1537150763,"updated":1541142463,"imageUrl":"https:\u002F\u002Fpic2.zhimg.com\u002Fv2-5d1f04a84f6be8896c07a32a05e1d6d1_b.jpg","author":{"isFollowed":false,"avatarUrlTemplate":"https:\u002F\u002Fpic4.zhimg.com\u002Fv2-2b7c11f27a7fd03282819889435815aa_{size}.jpg","uid":"35077274730496","userType":"people","isFollowing":false,"urlToken":"zhang-chu-heng","id":"db39e3e0528520071b0a6e5f6240cfea","description":"","name":"张楚珩","isAdvertiser":false,"headline":"强化学习 量化投资","gender":1,"url":"\u002Fpeople\u002Fdb39e3e0528520071b0a6e5f6240cfea","avatarUrl":"https:\u002F\u002Fpic4.zhimg.com\u002Fv2-2b7c11f27a7fd03282819889435815aa_l.jpg","isOrg":false,"type":"people"},"followers":4344,"type":"column"}},"topics":{},"roundtables":{},"favlists":{},"comments":{},"notifications":{},"ebooks":{},"activities":{},"feeds":{},"pins":{},"promotions":{},"drafts":{},"chats":{},"posts":{},"clubs":{},"clubTags":{}},"currentUser":"","account":{"lockLevel":{},"unlockTicketStatus":false,"unlockTicket":null,"challenge":[],"errorStatus":false,"message":"","isFetching":false,"accountInfo":{},"urlToken":{"loading":false}},"settings":{"socialBind":null,"inboxMsg":null,"notification":{},"email":{},"privacyFlag":null,"blockedUsers":{"isFetching":false,"paging":{"pageNo":1,"pageSize":6},"data":[]},"blockedFollowees":{"isFetching":false,"paging":{"pageNo":1,"pageSize":6},"data":[]},"ignoredTopics":{"isFetching":false,"paging":{"pageNo":1,"pageSize":6},"data":[]},"restrictedTopics":null,"laboratory":{}},"notification":{},"people":{"profileStatus":{},"activitiesByUser":{},"answersByUser":{},"answersSortByVotesByUser":{},"answersIncludedByUser":{},"votedAnswersByUser":{},"thankedAnswersByUser":{},"voteAnswersByUser":{},"thankAnswersByUser":{},"topicAnswersByUser":{},"zvideosByUser":{},"articlesByUser":{},"articlesSortByVotesByUser":{},"articlesIncludedByUser":{},"pinsByUser":{},"questionsByUser":{},"commercialQuestionsByUser":{},"favlistsByUser":{},"followingByUser":{},"followersByUser":{},"mutualsByUser":{},"followingColumnsByUser":{},"followingQuestionsByUser":{},"followingFavlistsByUser":{},"followingTopicsByUser":{},"publicationsByUser":{},"columnsByUser":{},"allFavlistsByUser":{},"brands":null,"creationsByUser":{},"creationsSortByVotesByUser":{},"creationsFeed":{}},"env":{"ab":{"config":{"experiments":[{"expId":"launch-gw_mweb_rec-1","expPrefix":"gw_mweb_rec","isDynamicallyUpdated":true,"isRuntime":false,"includeTriggerInfo":false},{"expId":"launch-qa_hdpimg-2","expPrefix":"qa_hdpimg","isDynamicallyUpdated":true,"isRuntime":false,"includeTriggerInfo":false},{"expId":"launch-us_foltopic_user-10","expPrefix":"us_foltopic_user","isDynamicallyUpdated":true,"isRuntime":false,"includeTriggerInfo":false},{"expId":"launch-vd_bullet_second-2","expPrefix":"vd_bullet_second","isDynamicallyUpdated":true,"isRuntime":false,"includeTriggerInfo":false},{"expId":"launch-vd_zvideo_link-10","expPrefix":"vd_zvideo_link","isDynamicallyUpdated":true,"isRuntime":false,"includeTriggerInfo":false},{"expId":"vd_bullet_gui-4","expPrefix":"vd_bullet_gui","isDynamicallyUpdated":true,"isRuntime":false,"includeTriggerInfo":false}],"params":[{"id":"se_site_onebox","type":"String","value":"0","chainId":"_all_"},{"id":"li_ebook_read","type":"String","value":"0","chainId":"_all_"},{"id":"se_entity_model","type":"String","value":"0","chainId":"_all_"},{"id":"top_v_album","type":"String","value":"1","chainId":"_all_"},{"id":"web_creator_route","type":"String","value":"1"},{"id":"se_prf","type":"String","value":"0","chainId":"_all_"},{"id":"se_hotsearch_num","type":"String","value":"0","chainId":"_all_"},{"id":"soc_iosreadline","type":"String","value":"0","chainId":"_all_"},{"id":"top_root","type":"String","value":"0","chainId":"_all_"},{"id":"gue_bullet_guide","type":"String","value":"点我，做第一个上屏的人"},{"id":"gue_video_replay","type":"String","value":"0"},{"id":"gue_new_special_page","type":"String","value":"1"},{"id":"gue_thanks","type":"String","value":"0"},{"id":"se_webmajorob","type":"String","value":"0","chainId":"_all_"},{"id":"ug_zero_follow_0","type":"String","value":"0","chainId":"_all_"},{"id":"top_new_feed","type":"String","value":"5","chainId":"_all_"},{"id":"gue_video_autoplay","type":"String","value":"0"},{"id":"zr_km_feed_nlp","type":"String","value":"old","chainId":"_all_"},{"id":"web_unfriendly_comm","type":"String","value":"0"},{"id":"li_education_box","type":"String","value":"0","chainId":"_all_"},{"id":"soc_bigone","type":"String","value":"0","chainId":"_all_"},{"id":"web_question_invite","type":"String","value":"B"},{"id":"zr_art_rec","type":"String","value":"base","chainId":"_all_"},{"id":"soc_ri_merge","type":"String","value":"0","chainId":"_all_"},{"id":"web_mini_review","type":"String","value":"0"},{"id":"li_se_edu","type":"String","value":"1","chainId":"_all_"},{"id":"soc_zcfw_shipinshiti","type":"String","value":"1","chainId":"_all_"},{"id":"web_answer_update","type":"String","value":"0"},{"id":"se_relation_1","type":"String","value":"0","chainId":"_all_"},{"id":"ug_newtag","type":"String","value":"0","chainId":"_all_"},{"id":"se_cardrank_1","type":"String","value":"0","chainId":"_all_"},{"id":"tp_club_pic_swiper","type":"String","value":"1","chainId":"_all_"},{"id":"li_se_section","type":"String","value":"0","chainId":"_all_"},{"id":"zr_km_answer","type":"String","value":"open_cvr","chainId":"_all_"},{"id":"zr_search_sim","type":"String","value":"0","chainId":"_all_"},{"id":"zr_slotpaidexp","type":"String","value":"1","chainId":"_all_"},{"id":"se_colorfultab","type":"String","value":"1","chainId":"_all_"},{"id":"se_subtext","type":"String","value":"0","chainId":"_all_"},{"id":"tp_qa_toast","type":"String","value":"1","chainId":"_all_"},{"id":"ug_follow_topic_1","type":"String","value":"2","chainId":"_all_"},{"id":"li_answer_card","type":"String","value":"0","chainId":"_all_"},{"id":"zr_slot_training","type":"String","value":"1","chainId":"_all_"},{"id":"zr_ans_rec","type":"String","value":"gbrank","chainId":"_all_"},{"id":"se_pek_test3","type":"String","value":"1","chainId":"_all_"},{"id":"se_amovietab","type":"String","value":"1","chainId":"_all_"},{"id":"se_college_cm","type":"String","value":"0","chainId":"_all_"},{"id":"tp_club_join","type":"String","value":"0","chainId":"_all_"},{"id":"soc_iosreadfilter","type":"String","value":"0","chainId":"_all_"},{"id":"web_mweb_launch","type":"String","value":"0"},{"id":"li_video_section","type":"String","value":"0","chainId":"_all_"},{"id":"soc_adreadline","type":"String","value":"0","chainId":"_all_"},{"id":"zr_video_recall","type":"String","value":"current_recall","chainId":"_all_"},{"id":"se_use_zitem","type":"String","value":"0","chainId":"_all_"},{"id":"soc_adsort","type":"String","value":"0","chainId":"_all_"},{"id":"gue_zvideo_link","type":"String","value":"1"},{"id":"tp_club_tab","type":"String","value":"0","chainId":"_all_"},{"id":"tp_club_feed","type":"String","value":"1","chainId":"_all_"},{"id":"se_preset_tech","type":"String","value":"0","chainId":"_all_"},{"id":"se_websearch","type":"String","value":"3","chainId":"_all_"},{"id":"tp_topic_rec","type":"String","value":"1","chainId":"_all_"},{"id":"soc_feed_intimacy","type":"String","value":"2","chainId":"_all_"},{"id":"zw_payc_qaedit","type":"String","value":"0","chainId":"_all_"},{"id":"zr_test_aa1","type":"String","value":"0","chainId":"_all_"},{"id":"soc_iosintimacy","type":"String","value":"2","chainId":"_all_"},{"id":"li_ebok_chap","type":"String","value":"0","chainId":"_all_"},{"id":"se_featured","type":"String","value":"1","chainId":"_all_"},{"id":"tp_club_android_feed","type":"String","value":"old","chainId":"_all_"},{"id":"soc_brdcst3","type":"String","value":"0","chainId":"_all_"},{"id":"se_col_boost","type":"String","value":"0","chainId":"_all_"},{"id":"se_new_merger","type":"String","value":"1","chainId":"_all_"},{"id":"se_aa_base","type":"String","value":"0","chainId":"_all_"},{"id":"web_upload","type":"String","value":"1"},{"id":"se_rf_w","type":"String","value":"0","chainId":"_all_"},{"id":"se_highlight","type":"String","value":"0","chainId":"_all_"},{"id":"soc_iossort","type":"String","value":"0","chainId":"_all_"},{"id":"soc_wonderuser_recom","type":"String","value":"2","chainId":"_all_"},{"id":"li_salt_hot","type":"String","value":"1","chainId":"_all_"},{"id":"qap_payc_invite","type":"String","value":"0","chainId":"_all_"},{"id":"qap_ques_invite","type":"String","value":"0","chainId":"_all_"},{"id":"web_hdpimg","type":"String","value":"1"},{"id":"se_cardrank_2","type":"String","value":"1","chainId":"_all_"},{"id":"se_sug","type":"String","value":"1","chainId":"_all_"},{"id":"se_zu_recommend","type":"String","value":"0","chainId":"_all_"},{"id":"se_cbert_index","type":"String","value":"0","chainId":"_all_"},{"id":"web_heifetz_grow_ad","type":"String","value":"1"},{"id":"web_sem_ab","type":"String","value":"1"},{"id":"tp_discovery_ab_1","type":"String","value":"0","chainId":"_all_"},{"id":"ug_fw_answ_aut_1","type":"String","value":"0","chainId":"_all_"},{"id":"li_vip_verti_search","type":"String","value":"0","chainId":"_all_"},{"id":"ug_zero_follow","type":"String","value":"0","chainId":"_all_"},{"id":"web_mweb_rec_length","type":"String","value":"1"},{"id":"tp_discover_copy","type":"String","value":"0","chainId":"_all_"},{"id":"tp_qa_metacard","type":"String","value":"1","chainId":"_all_"},{"id":"li_assessment_show","type":"String","value":"1","chainId":"_all_"},{"id":"li_yxzl_new_style_a","type":"String","value":"1","chainId":"_all_"},{"id":"tp_header_style","type":"String","value":"1","chainId":"_all_"},{"id":"tp_discover","type":"String","value":"0","chainId":"_all_"},{"id":"li_qa_btn_text","type":"String","value":"0","chainId":"_all_"},{"id":"se_club_post","type":"String","value":"5","chainId":"_all_"},{"id":"se_article_icon","type":"String","value":"0","chainId":"_all_"},{"id":"tp_club_pk","type":"String","value":"1","chainId":"_all_"},{"id":"soc_adpinweight","type":"String","value":"0","chainId":"_all_"},{"id":"gue_bullet_second","type":"String","value":"1"},{"id":"web_column_auto_invite","type":"String","value":"0"},{"id":"zr_answer_rec_cp","type":"String","value":"open","chainId":"_all_"},{"id":"tp_m_intro_re_topic","type":"String","value":"1","chainId":"_all_"},{"id":"soc_newfeed","type":"String","value":"2","chainId":"_all_"},{"id":"soc_zuichangfangwen","type":"String","value":"0","chainId":"_all_"},{"id":"soc_authormore2","type":"String","value":"2","chainId":"_all_"},{"id":"li_answers_link","type":"String","value":"0","chainId":"_all_"},{"id":"se_spb309","type":"String","value":"0","chainId":"_all_"},{"id":"se_sug_term","type":"String","value":"0","chainId":"_all_"},{"id":"tp_club_qa","type":"String","value":"1","chainId":"_all_"},{"id":"soc_userrec","type":"String","value":"0","chainId":"_all_"},{"id":"pf_creator_card","type":"String","value":"1","chainId":"_all_"},{"id":"ls_videoad","type":"String","value":"2","chainId":"_all_"},{"id":"zr_search_paid","type":"String","value":"0","chainId":"_all_"},{"id":"se_aa","type":"String","value":"0","chainId":"_all_"},{"id":"se_hotmore","type":"String","value":"2","chainId":"_all_"},{"id":"se_specialbutton","type":"String","value":"0","chainId":"_all_"},{"id":"se_adxtest","type":"String","value":"1","chainId":"_all_"},{"id":"tp_club_android_join","type":"String","value":"1","chainId":"_all_"},{"id":"li_ebook_gen_search","type":"String","value":"0","chainId":"_all_"},{"id":"zr_expslotpaid","type":"String","value":"1","chainId":"_all_"},{"id":"web_audit_01","type":"String","value":"case1"},{"id":"se_sug_entrance","type":"String","value":"1","chainId":"_all_"},{"id":"se_ad_index","type":"String","value":"10","chainId":"_all_"},{"id":"tp_score_1","type":"String","value":"a","chainId":"_all_"},{"id":"ug_follow_answerer","type":"String","value":"0","chainId":"_all_"},{"id":"qap_question_visitor","type":"String","value":" 0","chainId":"_all_"},{"id":"zr_training_first","type":"String","value":"false","chainId":"_all_"},{"id":"se_topiclabel","type":"String","value":"1","chainId":"_all_"},{"id":"tp_qa_metacard_top","type":"String","value":"top","chainId":"_all_"},{"id":"tp_topic_tab_new","type":"String","value":"0-0-0","chainId":"_all_"},{"id":"soc_bignew","type":"String","value":"1","chainId":"_all_"},{"id":"soc_zcfw_broadcast","type":"String","value":"0","chainId":"_all_"},{"id":"soc_authormore","type":"String","value":"2","chainId":"_all_"},{"id":"web_ad_banner","type":"String","value":"0"},{"id":"zw_sameq_sorce","type":"String","value":"999","chainId":"_all_"},{"id":"tsp_videobillboard","type":"String","value":"1","chainId":"_all_"},{"id":"se_expired_ob","type":"String","value":"0","chainId":"_all_"},{"id":"pf_newguide_vertical","type":"String","value":"0","chainId":"_all_"},{"id":"ug_follow_answerer_0","type":"String","value":"0","chainId":"_all_"},{"id":"li_se_across","type":"String","value":"1","chainId":"_all_"},{"id":"zr_slot_cold_start","type":"String","value":"aver","chainId":"_all_"},{"id":"pf_adjust","type":"String","value":"0","chainId":"_all_"},{"id":"soc_iospinweight","type":"String","value":"0","chainId":"_all_"},{"id":"zr_video_rank_nn","type":"String","value":"new_rank","chainId":"_all_"},{"id":"se_cardrank_4","type":"String","value":"1","chainId":"_all_"},{"id":"se_presearch_ab","type":"String","value":"0","chainId":"_all_"},{"id":"li_android_vip","type":"String","value":"0","chainId":"_all_"},{"id":"li_catalog_card","type":"String","value":"1","chainId":"_all_"},{"id":"top_test_4_liguangyi","type":"String","value":"1","chainId":"_all_"},{"id":"sem_up_growth","type":"String","value":"in_app","chainId":"_all_"},{"id":"qap_thanks","type":"String","value":"1","chainId":"_all_"},{"id":"zr_article_new","type":"String","value":"close","chainId":"_all_"},{"id":"se_new_topic","type":"String","value":"0","chainId":"_all_"},{"id":"se_auto_syn","type":"String","value":"0","chainId":"_all_"},{"id":"pf_noti_entry_num","type":"String","value":"0","chainId":"_all_"},{"id":"ls_recommend_test","type":"String","value":"0","chainId":"_all_"},{"id":"gue_goods_card","type":"String","value":"0"},{"id":"gue_self_censoring","type":"String","value":"1"},{"id":"se_agency","type":"String","value":" 0","chainId":"_all_"},{"id":"soc_special","type":"String","value":"0","chainId":"_all_"},{"id":"ug_goodcomment_0","type":"String","value":"1","chainId":"_all_"},{"id":"se_topicfeed","type":"String","value":"0","chainId":"_all_"},{"id":"se_multianswer","type":"String","value":"2","chainId":"_all_"},{"id":"se_zu_onebox","type":"String","value":"0","chainId":"_all_"},{"id":"se_movietab","type":"String","value":"1","chainId":"_all_"},{"id":"se_mobileweb","type":"String","value":"1","chainId":"_all_"},{"id":"tp_topic_tab","type":"String","value":"0","chainId":"_all_"},{"id":"se_ffzx_jushen1","type":"String","value":"0","chainId":"_all_"},{"id":"se_payconsult","type":"String","value":"0","chainId":"_all_"},{"id":"top_universalebook","type":"String","value":"1","chainId":"_all_"},{"id":"zr_rec_answer_cp","type":"String","value":"close","chainId":"_all_"},{"id":"se_related_index","type":"String","value":"3","chainId":"_all_"},{"id":"se_entity_model_14","type":"String","value":"0","chainId":"_all_"},{"id":"se_timebox_up","type":"String","value":"0","chainId":"_all_"},{"id":"soc_notification","type":"String","value":"0","chainId":"_all_"},{"id":"top_quality","type":"String","value":"0","chainId":"_all_"},{"id":"gue_zhuantikapian","type":"String","value":"0"},{"id":"zr_intervene","type":"String","value":"0","chainId":"_all_"},{"id":"se_webrs","type":"String","value":"1","chainId":"_all_"},{"id":"soc_update","type":"String","value":"1","chainId":"_all_"},{"id":"li_se_heat","type":"String","value":"1","chainId":"_all_"},{"id":"web_ask","type":"String","value":"0"},{"id":"se_content0","type":"String","value":"0","chainId":"_all_"},{"id":"tsp_vote","type":"String","value":"2","chainId":"_all_"},{"id":"gue_card_test","type":"String","value":"1"},{"id":"qap_article_like","type":"String","value":"1","chainId":"_all_"},{"id":"se_hotsearch_2","type":"String","value":"1","chainId":"_all_"},{"id":"soc_adreadfilter","type":"String","value":"0","chainId":"_all_"},{"id":"li_hot_voted","type":"String","value":"0","chainId":"_all_"},{"id":"li_se_media_icon","type":"String","value":"1","chainId":"_all_"},{"id":"se_cardrank_3","type":"String","value":"0","chainId":"_all_"},{"id":"tp_club_qa_pic","type":"String","value":"1","chainId":"_all_"},{"id":"tp_topic_head","type":"String","value":"0","chainId":"_all_"},{"id":"soc_yxzl_zcfw","type":"String","value":"0","chainId":"_all_"},{"id":"web_n_web_msg","type":"String","value":"0"},{"id":"se_likebutton","type":"String","value":"0","chainId":"_all_"},{"id":"se_famous","type":"String","value":"1","chainId":"_all_"},{"id":"se_dnn_mt_v2","type":"String","value":"0","chainId":"_all_"},{"id":"se_college","type":"String","value":"default","chainId":"_all_"},{"id":"se_searchwiki","type":"String","value":"0","chainId":"_all_"},{"id":"pf_foltopic_usernum","type":"String","value":"50","chainId":"_all_"},{"id":"se_hotsearch","type":"String","value":"0","chainId":"_all_"},{"id":"tp_sft","type":"String","value":"a","chainId":"_all_"},{"id":"tp_meta_card","type":"String","value":"0","chainId":"_all_"},{"id":"tp_club_tab_feed","type":"String","value":"0","chainId":"_all_"},{"id":"tp_topic_style","type":"String","value":"0","chainId":"_all_"},{"id":"soc_cardheight","type":"String","value":"2","chainId":"_all_"},{"id":"se_search_feed","type":"String","value":"N","chainId":"_all_"},{"id":"se_wannasearch","type":"String","value":"0","chainId":"_all_"},{"id":"se_click_club","type":"String","value":"1","chainId":"_all_"},{"id":"se_preset_label","type":"String","value":"1","chainId":"_all_"},{"id":"se_pek_test","type":"String","value":"1","chainId":"_all_"},{"id":"se_hot_timebox","type":"String","value":"0","chainId":"_all_"},{"id":"li_answer_label","type":"String","value":"0","chainId":"_all_"},{"id":"li_sku_bottom_bar_re","type":"String","value":"0","chainId":"_all_"},{"id":"tp_club_pic","type":"String","value":"0.6","chainId":"_all_"},{"id":"soc_zcfw_broadcast2","type":"String","value":"1","chainId":"_all_"},{"id":"li_pay_banner_type","type":"String","value":"6","chainId":"_all_"},{"id":"se_ctx_rerank","type":"String","value":"1","chainId":"_all_"},{"id":"soc_brdcst4","type":"String","value":"3","chainId":"_all_"},{"id":"zr_video_rank","type":"String","value":"new_rank","chainId":"_all_"},{"id":"tp_topic_entry","type":"String","value":"0","chainId":"_all_"},{"id":"soc_leave_recommend","type":"String","value":"2","chainId":"_all_"},{"id":"web_collect","type":"String","value":"0"},{"id":"web_answer_list_ad","type":"String","value":"1"},{"id":"web_answerlist_ad","type":"String","value":"0"},{"id":"se_ltr_video","type":"String","value":"0","chainId":"_all_"},{"id":"se_backsearch","type":"String","value":"0","chainId":"_all_"},{"id":"tsp_hotlist_ui","type":"String","value":"1","chainId":"_all_"},{"id":"li_purchase_test","type":"String","value":"0","chainId":"_all_"},{"id":"qap_question_author","type":"String","value":"0","chainId":"_all_"},{"id":"se_new_p","type":"String","value":"0","chainId":"_all_"},{"id":"ls_fmp4","type":"String","value":"0","chainId":"_all_"},{"id":"li_qa_new_cover","type":"String","value":"1","chainId":"_all_"},{"id":"li_paid_answer_exp","type":"String","value":"0","chainId":"_all_"},{"id":"se_ios_spb309","type":"String","value":"0","chainId":"_all_"},{"id":"soc_stickypush","type":"String","value":"1","chainId":"_all_"},{"id":"pf_fuceng","type":"String","value":"1","chainId":"_all_"},{"id":"top_ydyq","type":"String","value":"X","chainId":"_all_"},{"id":"li_svip_cardshow","type":"String","value":"1","chainId":"_all_"},{"id":"tp_club_discover","type":"String","value":"0","chainId":"_all_"},{"id":"li_svip_tab_search","type":"String","value":"0","chainId":"_all_"},{"id":"se_lottery","type":"String","value":"0","chainId":"_all_"},{"id":"se_webtimebox","type":"String","value":"0","chainId":"_all_"},{"id":"se_relationship","type":"String","value":"1","chainId":"_all_"},{"id":"se_cate_l3","type":"String","value":"0","chainId":"_all_"},{"id":"se_waterfall","type":"String","value":"0","chainId":"_all_"},{"id":"se_billboardsearch","type":"String","value":"0","chainId":"_all_"},{"id":"zr_training_boost","type":"String","value":"false","chainId":"_all_"},{"id":"se_pek_test2","type":"String","value":"1","chainId":"_all_"},{"id":"se_time_threshold","type":"String","value":"0","chainId":"_all_"},{"id":"se_page_quality","type":"String","value":"0","chainId":"_all_"},{"id":"tp_sticky_android","type":"String","value":"2","chainId":"_all_"},{"id":"soc_zcfw_badcase","type":"String","value":"0","chainId":"_all_"},{"id":"top_ebook","type":"String","value":"0","chainId":"_all_"},{"id":"web_sec672","type":"String","value":"0"},{"id":"zr_rel_search","type":"String","value":"base","chainId":"_all_"},{"id":"se_whitelist","type":"String","value":"0","chainId":"_all_"},{"id":"tp_club_header","type":"String","value":"1","chainId":"_all_"},{"id":"tp_sft_v2","type":"String","value":"d","chainId":"_all_"},{"id":"top_hotcommerce","type":"String","value":"1","chainId":"_all_"},{"id":"zr_update_merge_size","type":"String","value":"1","chainId":"_all_"},{"id":"se_p_slideshow","type":"String","value":"0","chainId":"_all_"}],"chains":[{"chainId":"_all_"}]},"triggers":{}},"userAgent":{"Edge":false,"Wechat":false,"Weibo":false,"QQ":false,"MQQBrowser":false,"Qzone":false,"Mobile":false,"Android":false,"iOS":false,"isAppleDevice":false,"Zhihu":false,"ZhihuHybrid":false,"isBot":false,"Tablet":false,"UC":false,"Sogou":false,"Qihoo":false,"Baidu":false,"BaiduApp":false,"Safari":false,"GoogleBot":false,"AndroidDaily":false,"iOSDaily":false,"isWebView":false,"origin":"Mozilla\u002F5.0 (Windows NT 10.0; Win64; x64) AppleWebKit\u002F537.36 (KHTML, like Gecko) Chrome\u002F80.0.3987.100 Safari\u002F537.36"},"appViewConfig":{},"ctx":{"path":"\u002Fp\u002F87200142","query":{},"href":"http:\u002F\u002Fzhuanlan.zhihu.com\u002Fp\u002F87200142","host":"zhuanlan.zhihu.com"},"trafficSource":"production","edition":{"baidu":false,"sogou":false,"baiduBeijing":false,"sogouBeijing":false,"sogouInput":false},"theme":"light","enableShortcut":true,"referer":"","conf":{},"ipInfo":{"cityName":"德州","countryName":"中国","regionName":"山东","countryCode":"CN"},"logged":false},"me":{"columnContributions":[]},"label":{"recognizerLists":{}},"ecommerce":{},"comments":{"pagination":{},"collapsed":{},"reverse":{},"reviewing":{},"conversation":{},"parent":{}},"commentsV2":{"stickers":[],"commentWithPicPermission":{},"notificationsComments":{},"pagination":{},"collapsed":{},"reverse":{},"reviewing":{},"conversation":{},"conversationMore":{},"parent":{}},"pushNotifications":{"default":{"isFetching":false,"isDrained":false,"ids":[]},"follow":{"isFetching":false,"isDrained":false,"ids":[]},"vote_thank":{"isFetching":false,"isDrained":false,"ids":[]},"currentTab":"default","notificationsCount":{"default":0,"follow":0,"vote_thank":0}},"messages":{"data":{},"currentTab":"common","messageCount":0},"register":{"registerValidateSucceeded":null,"registerValidateErrors":{},"registerConfirmError":null,"sendDigitsError":null,"registerConfirmSucceeded":null},"login":{"loginUnregisteredError":false,"loginBindWechatError":false,"loginConfirmError":null,"sendDigitsError":null,"needSMSIdentify":false,"validateDigitsError":false,"loginConfirmSucceeded":null,"qrcodeLoginToken":"","qrcodeLoginScanStatus":0,"qrcodeLoginError":null,"qrcodeLoginReturnNewToken":false},"active":{"sendDigitsError":null,"activeConfirmSucceeded":null,"activeConfirmError":null},"switches":{},"captcha":{"captchaNeeded":false,"captchaValidated":false,"captchaBase64String":null,"captchaValidationMessage":null,"loginCaptchaExpires":false},"sms":{"supportedCountries":[]},"chat":{"chats":{},"inbox":{"recents":{"isFetching":false,"isDrained":false,"isPrevDrained":false,"result":[],"next":null,"key":null},"strangers":{"isFetching":false,"isDrained":false,"isPrevDrained":false,"result":[],"next":null,"key":null},"friends":{"isFetching":false,"isDrained":false,"isPrevDrained":false,"result":[],"next":null,"key":null},"search":{"isFetching":false,"isDrained":false,"isPrevDrained":false,"result":[],"next":null,"key":null},"config":{"newCount":0,"strangerMessageSwitch":false,"strangerMessageUnread":false,"friendCount":0}},"global":{"isChatMqttExisted":false}},"emoticons":{"emoticonGroupList":[],"emoticonGroupDetail":{}},"creator":{"currentCreatorUrlToken":null,"homeData":{"recommendQuestions":[]},"tools":{"question":{"invitationCount":{"questionFolloweeCount":0,"questionTotalCount":0},"goodatTopics":[]},"customPromotion":{"itemLists":{}},"recommend":{"recommendTimes":{}}},"explore":{"academy":{"tabs":[],"article":{}}},"rights":[],"rightsStatus":{},"levelUpperLimit":10,"account":{"growthLevel":{}},"mcn":{},"applyStatus":{}},"recommendation":{"homeRecommendations":[]},"shareTexts":{},"articles":{"voters":{}},"previewPost":{},"favlists":{"relations":{}},"columns":{"voters":{}},"reward":{"answer":{},"article":{},"question":{}},"video":{"data":{},"shareVideoDetail":{},"last":{}},"topstory":{"recommend":{"isFetching":false,"isDrained":false,"afterId":0,"items":[],"next":null},"follow":{"isFetching":false,"isDrained":false,"afterId":0,"items":[],"next":null},"followWonderful":{"isFetching":false,"isDrained":false,"afterId":0,"items":[],"next":null},"sidebar":null,"announcement":{},"hotListCategories":[],"hotList":[],"guestFeeds":{"isFetching":false,"isDrained":false,"afterId":0,"items":[],"next":null},"followExtra":{"isNewUser":null,"isFetched":false,"followCount":0,"followers":[]}},"readStatus":{},"column":{},"requestColumn":{"categories":[],"error":null},"articleContribution":{"contributeRequests":[],"deleteContributeIdList":[],"handledContributeIdList":[],"recommendedColumns":[],"pinnedColumns":[],"sentContributeRequestsIdList":[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,"reinforcementlearning"]},"columnContribution":{"contributeRequests":[],"autoInviteEnabled":false,"recommendedContributors":[],"contributionInvitation":null},"draftHistory":{"history":{},"drafts":{}},"upload":{},"articleDraft":{"titleImage":"","titleImageSize":{},"isTitleImageFullScreen":false,"canTitleImageFullScreen":false,"title":"","titleImageUploading":false,"error":"","content":"","draftLoading":false,"updating":false,"globalLoading":false,"pendingVideo":{"resource":null,"error":null},"deleteFail":{"fail":false},"recommendTopics":[],"selectedColumn":0,"articleDisclaimers":[]},"articleDrafts":{"isDrained":false,"isLoading":false,"items":[]},"columnAutocomplete":{"users":[],"friends":[]},"columnCollection":{},"mcn":{"bindInfo":{},"memberCategoryList":[],"producerList":[],"categoryList":[]}},"fetchHost":"www.zhihu.com","subAppName":"column"}</script><script src="https://static.zhihu.com/heifetz/vendor.7b36fae46082fd30a0db.js"></script><script src="https://static.zhihu.com/heifetz/column.app.76e02b16e87eec249f44.js"></script></body><script src="https://hm.baidu.com/hm.js?98beee57fd2ef70ccdd5ca52b9740c49" async=""></script><script src="https://zz.bdstatic.com/linksubmit/push.js" async=""></script></html>