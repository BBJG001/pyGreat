<!doctype html>
<html lang="zh" data-hairline="true" data-theme="light"><head><meta charSet="utf-8"/><title data-react-helmet="true">【统计】Instrumental Variables - 知乎</title><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1"/><meta name="renderer" content="webkit"/><meta name="force-rendering" content="webkit"/><meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1"/><meta name="google-site-verification" content="FTeR0c8arOPKh8c5DYh_9uu98_zJbaWw53J-Sch9MTg"/><meta data-react-helmet="true" name="keywords" content="因果,统计,数据存储（广义）"/><meta data-react-helmet="true" name="description" content="还是继续前面因果推断的话题，这里讲一个从数据中做因果推断的另一种有效的方法——Instrumental variables（IV）。同时，也补充一个用深度学习方法来实现 IV 的一篇论文（ICML 2017）。原文传送门http://www.sode…"/><meta data-react-helmet="true" property="og:title" content="【统计】Instrumental Variables"/><meta data-react-helmet="true" property="og:url" content="https://zhuanlan.zhihu.com/p/88235983"/><meta data-react-helmet="true" property="og:description" content="还是继续前面因果推断的话题，这里讲一个从数据中做因果推断的另一种有效的方法——Instrumental variables（IV）。同时，也补充一个用深度学习方法来实现 IV 的一篇论文（ICML 2017）。原文传送门http://www.sode…"/><meta data-react-helmet="true" property="og:image" content="https://pic4.zhimg.com/v2-679c8ffef665c4b68e7d4aab6c5e0ba3_b.jpg"/><meta data-react-helmet="true" property="og:type" content="article"/><meta data-react-helmet="true" property="og:site_name" content="知乎专栏"/><link data-react-helmet="true" rel="apple-touch-icon" href="https://static.zhihu.com/heifetz/assets/apple-touch-icon-152.67c7b278.png"/><link data-react-helmet="true" rel="apple-touch-icon" href="https://static.zhihu.com/heifetz/assets/apple-touch-icon-152.67c7b278.png" sizes="152x152"/><link data-react-helmet="true" rel="apple-touch-icon" href="https://static.zhihu.com/heifetz/assets/apple-touch-icon-120.b3e6278d.png" sizes="120x120"/><link data-react-helmet="true" rel="apple-touch-icon" href="https://static.zhihu.com/heifetz/assets/apple-touch-icon-76.7a750095.png" sizes="76x76"/><link data-react-helmet="true" rel="apple-touch-icon" href="https://static.zhihu.com/heifetz/assets/apple-touch-icon-60.a4a761d4.png" sizes="60x60"/><link rel="shortcut icon" type="image/x-icon" href="https://static.zhihu.com/static/favicon.ico"/><link rel="search" type="application/opensearchdescription+xml" href="https://static.zhihu.com/static/search.xml" title="知乎"/><link rel="dns-prefetch" href="//static.zhimg.com"/><link rel="dns-prefetch" href="//pic1.zhimg.com"/><link rel="dns-prefetch" href="//pic2.zhimg.com"/><link rel="dns-prefetch" href="//pic3.zhimg.com"/><link rel="dns-prefetch" href="//pic4.zhimg.com"/><style>
.u-safeAreaInset-top {
  height: constant(safe-area-inset-top) !important;
  height: env(safe-area-inset-top) !important;
  
}
.u-safeAreaInset-bottom {
  height: constant(safe-area-inset-bottom) !important;
  height: env(safe-area-inset-bottom) !important;
  
}
</style><link href="https://static.zhihu.com/heifetz/column.app.a9ced452148fee3a55c8.css" rel="stylesheet"/><script defer="" crossorigin="anonymous" src="https://unpkg.zhimg.com/@cfe/sentry-script@latest/dist/init.js" data-sentry-config="{&quot;dsn&quot;:&quot;https://2d8d764432cc4f6fb3bc78ab9528299d@crash2.zhihu.com/1224&quot;,&quot;sampleRate&quot;:0.1,&quot;release&quot;:&quot;683-127b14ad&quot;,&quot;ignoreErrorNames&quot;:[&quot;NetworkError&quot;,&quot;SecurityError&quot;],&quot;ignoreErrors&quot;:[&quot;origin message&quot;,&quot;Network request failed&quot;,&quot;Loading chunk&quot;,&quot;这个系统不支持该功能。&quot;,&quot;Can&#x27;t find variable: webkit&quot;,&quot;Can&#x27;t find variable: $&quot;,&quot;内存不足&quot;,&quot;out of memory&quot;,&quot;DOM Exception 18&quot;,&quot;The operation is insecure&quot;,&quot;[object Event]&quot;,&quot;[object FileError]&quot;,&quot;[object DOMError]&quot;,&quot;[object Object]&quot;,&quot;拒绝访问。&quot;,&quot;Maximum call stack size exceeded&quot;,&quot;UploadError&quot;,&quot;无法 fetch&quot;,&quot;draft-js&quot;,&quot;缺少 JavaScript 对象&quot;,&quot;componentWillEnter&quot;,&quot;componentWillLeave&quot;,&quot;componentWillAppear&quot;,&quot;getInlineStyleAt&quot;,&quot;getCharacterList&quot;],&quot;whitelistUrls&quot;:[&quot;static.zhihu.com&quot;]}"></script></head><body class="WhiteBg-body"><div id="root"><div class="App"><div class="LoadingBar"></div><main role="main" class="App-main"><div class="Post-content" data-zop-usertoken="{&quot;userToken&quot;:&quot;&quot;}" data-zop="{&quot;authorName&quot;:&quot;张楚珩&quot;,&quot;itemId&quot;:88235983,&quot;title&quot;:&quot;【统计】Instrumental Variables&quot;,&quot;type&quot;:&quot;article&quot;}"><div class="ColumnPageHeader-Wrapper"><div><div class="Sticky ColumnPageHeader"><div class="ColumnPageHeader-content"><a href="//www.zhihu.com" aria-label="知乎"><svg viewBox="0 0 200 91" fill="#0084FF" width="64" height="30"><path d="M53.29 80.035l7.32.002 2.41 8.24 13.128-8.24h15.477v-67.98H53.29v67.978zm7.79-60.598h22.756v53.22h-8.73l-8.718 5.473-1.587-5.46-3.72-.012v-53.22zM46.818 43.162h-16.35c.545-8.467.687-16.12.687-22.955h15.987s.615-7.05-2.68-6.97H16.807c1.09-4.1 2.46-8.332 4.1-12.708 0 0-7.523 0-10.085 6.74-1.06 2.78-4.128 13.48-9.592 24.41 1.84-.2 7.927-.37 11.512-6.94.66-1.84.785-2.08 1.605-4.54h9.02c0 3.28-.374 20.9-.526 22.95H6.51c-3.67 0-4.863 7.38-4.863 7.38H22.14C20.765 66.11 13.385 79.24 0 89.62c6.403 1.828 12.784-.29 15.937-3.094 0 0 7.182-6.53 11.12-21.64L43.92 85.18s2.473-8.402-.388-12.496c-2.37-2.788-8.768-10.33-11.496-13.064l-4.57 3.627c1.363-4.368 2.183-8.61 2.46-12.71H49.19s-.027-7.38-2.372-7.38zm128.752-.502c6.51-8.013 14.054-18.302 14.054-18.302s-5.827-4.625-8.556-1.27c-1.874 2.548-11.51 15.063-11.51 15.063l6.012 4.51zm-46.903-18.462c-2.814-2.577-8.096.667-8.096.667s12.35 17.2 12.85 17.953l6.08-4.29s-8.02-11.752-10.83-14.33zM199.99 46.5c-6.18 0-40.908.292-40.953.292v-31.56c1.503 0 3.882-.124 7.14-.376 12.773-.753 21.914-1.25 27.427-1.504 0 0 3.817-8.496-.185-10.45-.96-.37-7.24 1.43-7.24 1.43s-51.63 5.153-72.61 5.64c.5 2.756 2.38 5.336 4.93 6.11 4.16 1.087 7.09.53 15.36.277 7.76-.5 13.65-.76 17.66-.76v31.19h-41.71s.88 6.97 7.97 7.14h33.73v22.16c0 4.364-3.498 6.87-7.65 6.6-4.4.034-8.15-.36-13.027-.566.623 1.24 1.977 4.496 6.035 6.824 3.087 1.502 5.054 2.053 8.13 2.053 9.237 0 14.27-5.4 14.027-14.16V53.93h38.235c3.026 0 2.72-7.432 2.72-7.432z" fill-rule="evenodd"></path></svg></a><i class="ColumnPageHeader-Line"></i><div class="ColumnPageHeader-Title"><a class="ColumnLink ColumnPageHeader-Link" href="/reinforcementlearning"><img class="Avatar Avatar--round" width="30" height="30" src="https://pic2.zhimg.com/v2-5d1f04a84f6be8896c07a32a05e1d6d1_is.jpg" srcSet="https://pic2.zhimg.com/v2-5d1f04a84f6be8896c07a32a05e1d6d1_im.jpg 2x" alt="强化学习前沿"/></a><div class="ColumnPageHeader-TitleName"><span class="ColumnPageHeader-TitleMeta">首发于</span><a class="ColumnLink ColumnPageHeader-TitleColumn" href="/reinforcementlearning">强化学习前沿</a></div></div><div class="ColumnPageHeader-Button"><button type="button" class="Button ColumnPageHeader-WriteButton Button--blue"><svg class="Zi Zi--EditSurround" fill="currentColor" viewBox="0 0 24 24" width="24" height="24"><path d="M18.453 7.992l-1.833-1.65.964-.978a1.223 1.223 0 0 1 1.73-.012l.005.006a1.24 1.24 0 0 1 .007 1.748l-.873.886zm-1.178 1.194l-5.578 5.66-1.935.697a.393.393 0 0 1-.504-.504l.697-1.935 5.488-5.567 1.832 1.65zM7.58 5.848l5.654.006-1.539 1.991-3.666.012A1.02 1.02 0 0 0 7 8.868v7.993c0 .558.46 1.01 1.029 1.01l7.941-.01c.568 0 1.03-.453 1.03-1.012v-4.061l2-1.442v6.002c0 1.397-1.2 2.501-2.62 2.501H7.574C6.153 19.85 5 18.717 5 17.32V8.35c0-1.397 1.16-2.502 2.58-2.502z"></path></svg>写文章</button></div></div></div></div></div><img class="TitleImage" src="https://pic4.zhimg.com/v2-679c8ffef665c4b68e7d4aab6c5e0ba3_1200x500.jpg" alt="【统计】Instrumental Variables"/><article class="Post-Main Post-NormalMain" tabindex="-1"><header class="Post-Header"><h1 class="Post-Title">【统计】Instrumental Variables</h1><div class="Post-Author"><div class="AuthorInfo" itemProp="author" itemscope="" itemType="http://schema.org/Person"><meta itemProp="name" content="张楚珩"/><meta itemProp="image" content="https://pic4.zhimg.com/v2-2b7c11f27a7fd03282819889435815aa_l.jpg"/><meta itemProp="url" content="https://www.zhihu.com/people/zhang-chu-heng"/><meta itemProp="zhihu:followerCount"/><span class="UserLink AuthorInfo-avatarWrapper"><div class="Popover"><div id="null-toggle" aria-haspopup="true" aria-expanded="false" aria-owns="null-content"><a class="UserLink-link" data-za-detail-view-element_name="User" target="_blank" href="//www.zhihu.com/people/zhang-chu-heng"><img class="Avatar Avatar--round AuthorInfo-avatar" width="38" height="38" src="https://pic4.zhimg.com/v2-2b7c11f27a7fd03282819889435815aa_xs.jpg" srcSet="https://pic4.zhimg.com/v2-2b7c11f27a7fd03282819889435815aa_l.jpg 2x" alt="张楚珩"/></a></div></div></span><div class="AuthorInfo-content"><div class="AuthorInfo-head"><span class="UserLink AuthorInfo-name"><div class="Popover"><div id="null-toggle" aria-haspopup="true" aria-expanded="false" aria-owns="null-content"><a class="UserLink-link" data-za-detail-view-element_name="User" target="_blank" href="//www.zhihu.com/people/zhang-chu-heng">张楚珩</a></div></div><style data-emotion-css="1cd9gw4">.css-1cd9gw4{margin-left:.3em;}</style><style data-emotion-css="1pc1mic">.css-1pc1mic{box-sizing:border-box;margin:0;min-width:0;color:#175199;display:inline-block;width:18px;height:18px;margin-left:.3em;}</style><a href="https://www.zhihu.com/question/48510028" target="_blank" class="css-1pc1mic" data-tooltip="已认证的个人" aria-label="已认证的个人"><style data-emotion-css="18biwo">.css-18biwo{display:-webkit-inline-box;display:-webkit-inline-flex;display:-ms-inline-flexbox;display:inline-flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;}</style><span class="css-18biwo">​<svg viewBox="0 0 24 24" width="18" height="18"><svg viewBox="0 0 24 24" x="-3" y="-3" fill="#FFFFFF" width="30" height="30"><path d="M3.56231227,13.8535307 C2.40051305,12.768677 2.41398885,11.0669203 3.59484487,9.99979213 L3.59222085,9.99654885 C4.26730143,9.45036719 4.79446755,8.21005186 4.7184197,7.34453784 L4.72305873,7.34412719 C4.66942824,5.75539997 5.8824188,4.56066914 7.47188965,4.64242381 L7.47229112,4.6386236 C8.33515314,4.72977993 9.58467253,4.22534048 10.1426329,3.55925173 L10.1462611,3.56228565 C11.2316055,2.40008701 12.9353108,2.41394456 14.0015072,3.59634088 L14.0047263,3.59374004 C14.5498229,4.26841874 15.7896857,4.79521622 16.6545744,4.71844347 L16.6549836,4.72304294 C18.245027,4.66894057 19.4396947,5.88213996 19.3575031,7.47241135 L19.3623099,7.47292747 C19.2704388,8.3358681 19.7742711,9.58421483 20.4407199,10.1424506 L20.437686,10.1460789 C21.5997217,11.2312209 21.5860695,12.9345218 20.4042441,14.0007396 L20.4072865,14.0045125 C19.7325967,14.5495925 19.2055209,15.7896954 19.2815865,16.6561959 L19.2770449,16.6565978 C19.3315454,18.2453037 18.1173775,19.4393568 16.5274188,19.3571512 L16.5269029,19.3619539 C15.6647098,19.270083 14.415408,19.7741709 13.8573671,20.4403558 L13.8537409,20.4373235 C12.76842,21.5995708 11.0650432,21.5864553 9.99899434,20.4039226 L9.99527367,20.406923 C9.45025436,19.7323399 8.21017638,19.2051872 7.34461983,19.2812352 L7.344304,19.2776405 C5.75448683,19.3312904 4.55977145,18.1170085 4.64254978,16.527117 L4.63769921,16.5265942 C4.72957031,15.6644394 4.22547659,14.4151814 3.55928015,13.8571569 L3.56231227,13.8535307 Z"></path></svg><path d="M2.63951518,13.3895441 C3.70763333,14.2842292 4.44777637,16.1226061 4.30075305,17.5023312 L4.32211542,17.3063047 C4.17509209,18.6910561 5.17786655,19.7063729 6.5613937,19.5844846 L6.364106,19.6008202 C7.75140298,19.4789319 9.57474349,20.2554985 10.4468305,21.3349009 L10.3224262,21.1803415 C11.1982831,22.2647703 12.6257916,22.2723098 13.5167278,21.2079863 L13.3898102,21.3600325 C14.2845162,20.2919393 16.1229361,19.5518136 17.5026934,19.6988334 L17.3054057,19.6774716 C18.6914461,19.8244915 19.7067866,18.8217404 19.5836389,17.4395022 L19.6012314,17.6367853 C19.4793403,16.2482641 20.255925,14.4249662 21.3353526,13.5528995 L21.1807897,13.677301 C22.2639871,12.8014646 22.2727834,11.3739894 21.2084351,10.483074 L21.3604848,10.6099886 C20.2923667,9.71530351 19.5522236,7.87818322 19.6992469,6.49720154 L19.6778846,6.69448464 C19.8249079,5.30847665 18.8221335,4.2944164 17.4386063,4.41630468 L17.635894,4.39871256 C16.248597,4.52185742 14.4252565,3.74529084 13.5531695,2.66588842 L13.6775738,2.81919121 C12.8017169,1.73601905 11.3742084,1.72722299 10.4832722,2.79154644 L10.6101898,2.63950024 C9.71548377,3.70759343 7.87706394,4.44771919 6.49730661,4.30195588 L6.69459432,4.32206116 C5.30855394,4.17504128 4.29447,5.17904888 4.41636114,6.56128713 L4.3987686,6.36400404 C4.52065973,7.75126861 3.74407501,9.57456653 2.66464737,10.4478898 L2.81921035,10.3222318 C1.73601288,11.1993248 1.72721662,12.6255433 2.79156494,13.5164587 L2.63951518,13.3895441 Z" fill="#0084FF"></path><svg class="Zi Zi--Check" fill="#fff" x="6" y="6" viewBox="0 0 24 24" width="12" height="12"><path d="M10.229 17.516c-.318.327-.75.484-1.199.484-.453 0-.884-.16-1.202-.488l-4.335-4.47a1.77 1.77 0 0 1 .007-2.459 1.663 1.663 0 0 1 2.397.01l3.137 3.246 9.072-9.329a1.662 1.662 0 0 1 2.397 0c.663.681.663 1.786 0 2.466L10.23 17.516z" fill-rule="evenodd"></path></svg></svg></span></a></span></div><div class="AuthorInfo-detail"><div class="AuthorInfo-badge"><div class="AuthorInfo-badgeText">清华大学 交叉信息院博士在读</div></div></div></div></div></div><div><span class="Voters"><button type="button" class="Button Button--plain">15 人<!-- -->赞同了该文章</button></span></div></header><div class="Post-RichTextContainer"><div class="RichText ztext Post-RichText"><p>还是继续前面因果推断的话题，这里讲一个从数据中做因果推断的另一种有效的方法——Instrumental variables（IV）。同时，也补充一个用深度学习方法来实现 IV 的一篇论文（ICML 2017）。</p><h2>原文传送门</h2><p><a href="https://link.zhihu.com/?target=http%3A//www.soderbom.net/lec2n_final.pdf" class=" external" target="_blank" rel="nofollow noreferrer"><span class="invisible">http://www.</span><span class="visible">soderbom.net/lec2n_fina</span><span class="invisible">l.pdf</span><span class="ellipsis"></span></a></p><p><a href="https://link.zhihu.com/?target=http%3A//www3.grips.ac.jp/~yamanota/Lecture%2520Note%25208%2520to%252010%25202SLS%2520%26%2520others.pdf" class=" wrap external" target="_blank" rel="nofollow noreferrer">http://www3.grips.ac.jp/~yamanota/</a></p><p><a href="https://link.zhihu.com/?target=http%3A//proceedings.mlr.press/v70/hartford17a/hartford17a.pdf" class=" wrap external" target="_blank" rel="nofollow noreferrer">Hartford, Jason, et al. &#34;Deep IV: A flexible approach for counterfactual prediction.&#34; Proceedings of the 34th International Conference on Machine Learning-Volume 70. JMLR. org, 2017.</a></p><h2>正文</h2><h3>一、Instrumental variable</h3><p>还是看一个线性模型，</p><figure data-size="normal"><img src="https://pic1.zhimg.com/v2-9b427e4a25e3e6ee7bdc46c51275ad38_b.png" data-caption="" data-size="normal" data-rawwidth="1756" data-rawheight="94" class="origin_image zh-lightbox-thumb" width="1756" data-original="https://pic1.zhimg.com/v2-9b427e4a25e3e6ee7bdc46c51275ad38_r.jpg"/><img src="data:image/svg+xml;utf8,&lt;svg xmlns=&#39;http://www.w3.org/2000/svg&#39; width=&#39;1756&#39; height=&#39;94&#39;&gt;&lt;/svg&gt;" data-caption="" data-size="normal" data-rawwidth="1756" data-rawheight="94" class="origin_image zh-lightbox-thumb lazy" width="1756" data-original="https://pic1.zhimg.com/v2-9b427e4a25e3e6ee7bdc46c51275ad38_r.jpg" data-actualsrc="https://pic1.zhimg.com/v2-9b427e4a25e3e6ee7bdc46c51275ad38_b.png"/></figure><p>前面说到，线性模型前面的系数表征了自变量对于因变量的因果关系，一个线性模型要能使用 OLS 估计系数需要满足 exogeneity 的要求。现在假设其中某一个变量不满足该要求，即</p><p><img src="https://www.zhihu.com/equation?tex=%5Cmathbb%7BE%7D%5Bu%5D+%3D+0%2C+Cov%28x_j%2C+u%29+%3D+0%2C+j+%5Cin%5BK-1%5D%2C+Cov%28x_K%2C+y%29+%5Cneq+0" alt="\mathbb{E}[u] = 0, Cov(x_j, u) = 0, j \in[K-1], Cov(x_K, y) \neq 0" eeimg="1"/> </p><p>这时，我们引入 instrumental variable 方法来解决内生性问题，并且为 <img src="https://www.zhihu.com/equation?tex=%5Cbeta_j" alt="\beta_j" eeimg="1"/> 的提供一致性估计。</p><p>一个 instrumental variable <img src="https://www.zhihu.com/equation?tex=z_1" alt="z_1" eeimg="1"/> 需要满足的性质（和它与 proxy variable 的对比，一块放上来）</p><figure data-size="normal"><img src="https://pic4.zhimg.com/v2-14c34d0da8b5edcd53d6d82342aaa47f_b.jpg" data-size="normal" data-rawwidth="1330" data-rawheight="617" class="origin_image zh-lightbox-thumb" width="1330" data-original="https://pic4.zhimg.com/v2-14c34d0da8b5edcd53d6d82342aaa47f_r.jpg"/><img src="data:image/svg+xml;utf8,&lt;svg xmlns=&#39;http://www.w3.org/2000/svg&#39; width=&#39;1330&#39; height=&#39;617&#39;&gt;&lt;/svg&gt;" data-size="normal" data-rawwidth="1330" data-rawheight="617" class="origin_image zh-lightbox-thumb lazy" width="1330" data-original="https://pic4.zhimg.com/v2-14c34d0da8b5edcd53d6d82342aaa47f_r.jpg" data-actualsrc="https://pic4.zhimg.com/v2-14c34d0da8b5edcd53d6d82342aaa47f_b.jpg"/><figcaption>validity condition and relevance condition （图中写错了）</figcaption></figure><p>第一项的要求应该两个是等价的，即额外选择的这个变量不能成为解释变量进入原来的方程中。最主要的区别在第二个要求上，proxy variable 要求找到的变量能够解释所有 q 和其他 解释变量的关联（即，q 剔除掉 z 的影响之后，r 和其他解释变量无关）；而 instrumental variable 则希望找到一个和其他变量都没啥关系，但是只和 <img src="https://www.zhihu.com/equation?tex=x_K" alt="x_K" eeimg="1"/> 有一点关联的变量。</p><p><a href="https://link.zhihu.com/?target=https%3A//stats.stackexchange.com/questions/13582/proxy-variables-versus-instrumental-variables" class=" wrap external" target="_blank" rel="nofollow noreferrer">论坛 (StackExchange)</a>上说：instrumental variable 的目的是想找因果关系，减小 estimation error 产生的影响，对于它来说， <img src="https://www.zhihu.com/equation?tex=x_K" alt="x_K" eeimg="1"/> 能观察到，但是可能有偏差，因此要找一个只影响 <img src="https://www.zhihu.com/equation?tex=x_K" alt="x_K" eeimg="1"/> 的变量来抵消相应的估计误差；proxy variable 是想想办法把原来的线性模型系数估计处理，其中的变量 q 观察不到，想要找一个和它接近的变量来替换它。</p><h3>二、instrumental variable estimator</h3><p>令</p><figure data-size="normal"><img src="https://pic2.zhimg.com/v2-1bfb02e3b11d561433d087d239601b6d_b.png" data-caption="" data-size="normal" data-rawwidth="1880" data-rawheight="258" class="origin_image zh-lightbox-thumb" width="1880" data-original="https://pic2.zhimg.com/v2-1bfb02e3b11d561433d087d239601b6d_r.jpg"/><img src="data:image/svg+xml;utf8,&lt;svg xmlns=&#39;http://www.w3.org/2000/svg&#39; width=&#39;1880&#39; height=&#39;258&#39;&gt;&lt;/svg&gt;" data-caption="" data-size="normal" data-rawwidth="1880" data-rawheight="258" class="origin_image zh-lightbox-thumb lazy" width="1880" data-original="https://pic2.zhimg.com/v2-1bfb02e3b11d561433d087d239601b6d_r.jpg" data-actualsrc="https://pic2.zhimg.com/v2-1bfb02e3b11d561433d087d239601b6d_b.png"/></figure><p>假设样本数目为 N，那么它们都是 NxK 的矩阵。</p><p>方程可以写为</p><figure data-size="normal"><img src="https://pic2.zhimg.com/v2-40cdbee7ab01a79ff61c001bf2336469_b.png" data-caption="" data-size="normal" data-rawwidth="1906" data-rawheight="138" class="origin_image zh-lightbox-thumb" width="1906" data-original="https://pic2.zhimg.com/v2-40cdbee7ab01a79ff61c001bf2336469_r.jpg"/><img src="data:image/svg+xml;utf8,&lt;svg xmlns=&#39;http://www.w3.org/2000/svg&#39; width=&#39;1906&#39; height=&#39;138&#39;&gt;&lt;/svg&gt;" data-caption="" data-size="normal" data-rawwidth="1906" data-rawheight="138" class="origin_image zh-lightbox-thumb lazy" width="1906" data-original="https://pic2.zhimg.com/v2-40cdbee7ab01a79ff61c001bf2336469_r.jpg" data-actualsrc="https://pic2.zhimg.com/v2-40cdbee7ab01a79ff61c001bf2336469_b.png"/></figure><p>其中 y 和 u 都是 Nx1 的向量， <img src="https://www.zhihu.com/equation?tex=%5Cbeta" alt="\beta" eeimg="1"/> 是 Kx1 的向量。</p><p>根据前面的条件，有</p><figure data-size="normal"><img src="https://pic1.zhimg.com/v2-e368634ceb65f70b34c058bc303bd5fc_b.png" data-caption="" data-size="normal" data-rawwidth="1886" data-rawheight="128" class="origin_image zh-lightbox-thumb" width="1886" data-original="https://pic1.zhimg.com/v2-e368634ceb65f70b34c058bc303bd5fc_r.jpg"/><img src="data:image/svg+xml;utf8,&lt;svg xmlns=&#39;http://www.w3.org/2000/svg&#39; width=&#39;1886&#39; height=&#39;128&#39;&gt;&lt;/svg&gt;" data-caption="" data-size="normal" data-rawwidth="1886" data-rawheight="128" class="origin_image zh-lightbox-thumb lazy" width="1886" data-original="https://pic1.zhimg.com/v2-e368634ceb65f70b34c058bc303bd5fc_r.jpg" data-actualsrc="https://pic1.zhimg.com/v2-e368634ceb65f70b34c058bc303bd5fc_b.png"/></figure><p>不难推得</p><figure data-size="normal"><img src="https://pic3.zhimg.com/v2-ac87783102596132b40443e56973da5a_b.png" data-caption="" data-size="normal" data-rawwidth="1884" data-rawheight="212" class="origin_image zh-lightbox-thumb" width="1884" data-original="https://pic3.zhimg.com/v2-ac87783102596132b40443e56973da5a_r.jpg"/><img src="data:image/svg+xml;utf8,&lt;svg xmlns=&#39;http://www.w3.org/2000/svg&#39; width=&#39;1884&#39; height=&#39;212&#39;&gt;&lt;/svg&gt;" data-caption="" data-size="normal" data-rawwidth="1884" data-rawheight="212" class="origin_image zh-lightbox-thumb lazy" width="1884" data-original="https://pic3.zhimg.com/v2-ac87783102596132b40443e56973da5a_r.jpg" data-actualsrc="https://pic3.zhimg.com/v2-ac87783102596132b40443e56973da5a_b.png"/></figure><p>由于 <img src="https://www.zhihu.com/equation?tex=%5Ctheta_1+%5Cneq+0" alt="\theta_1 \neq 0" eeimg="1"/> ，即 <img src="https://www.zhihu.com/equation?tex=x_K%2C+z_1" alt="x_K, z_1" eeimg="1"/> 相互关联，因此</p><figure data-size="normal"><img src="https://pic3.zhimg.com/v2-ffd7f8b912a99ab1d48d1eb7453ce472_b.png" data-caption="" data-size="normal" data-rawwidth="1878" data-rawheight="122" class="origin_image zh-lightbox-thumb" width="1878" data-original="https://pic3.zhimg.com/v2-ffd7f8b912a99ab1d48d1eb7453ce472_r.jpg"/><img src="data:image/svg+xml;utf8,&lt;svg xmlns=&#39;http://www.w3.org/2000/svg&#39; width=&#39;1878&#39; height=&#39;122&#39;&gt;&lt;/svg&gt;" data-caption="" data-size="normal" data-rawwidth="1878" data-rawheight="122" class="origin_image zh-lightbox-thumb lazy" width="1878" data-original="https://pic3.zhimg.com/v2-ffd7f8b912a99ab1d48d1eb7453ce472_r.jpg" data-actualsrc="https://pic3.zhimg.com/v2-ffd7f8b912a99ab1d48d1eb7453ce472_b.png"/></figure><p>这样我们可以对其求逆，解出系数</p><figure data-size="normal"><img src="https://pic2.zhimg.com/v2-87b12b1f05cf629a1b5420bed499d55d_b.png" data-caption="" data-size="normal" data-rawwidth="1932" data-rawheight="110" class="origin_image zh-lightbox-thumb" width="1932" data-original="https://pic2.zhimg.com/v2-87b12b1f05cf629a1b5420bed499d55d_r.jpg"/><img src="data:image/svg+xml;utf8,&lt;svg xmlns=&#39;http://www.w3.org/2000/svg&#39; width=&#39;1932&#39; height=&#39;110&#39;&gt;&lt;/svg&gt;" data-caption="" data-size="normal" data-rawwidth="1932" data-rawheight="110" class="origin_image zh-lightbox-thumb lazy" width="1932" data-original="https://pic2.zhimg.com/v2-87b12b1f05cf629a1b5420bed499d55d_r.jpg" data-actualsrc="https://pic2.zhimg.com/v2-87b12b1f05cf629a1b5420bed499d55d_b.png"/></figure><p>系数的估计公式为</p><figure data-size="normal"><img src="https://pic1.zhimg.com/v2-bba3f3e626e0a862f4008cc9c4b7ff40_b.png" data-caption="" data-size="normal" data-rawwidth="1838" data-rawheight="102" class="origin_image zh-lightbox-thumb" width="1838" data-original="https://pic1.zhimg.com/v2-bba3f3e626e0a862f4008cc9c4b7ff40_r.jpg"/><img src="data:image/svg+xml;utf8,&lt;svg xmlns=&#39;http://www.w3.org/2000/svg&#39; width=&#39;1838&#39; height=&#39;102&#39;&gt;&lt;/svg&gt;" data-caption="" data-size="normal" data-rawwidth="1838" data-rawheight="102" class="origin_image zh-lightbox-thumb lazy" width="1838" data-original="https://pic1.zhimg.com/v2-bba3f3e626e0a862f4008cc9c4b7ff40_r.jpg" data-actualsrc="https://pic1.zhimg.com/v2-bba3f3e626e0a862f4008cc9c4b7ff40_b.png"/></figure><p>称它为 <b>instrumental variable estimator</b>。</p><p>可以验证，它为一致性估计</p><figure data-size="normal"><img src="https://pic3.zhimg.com/v2-fd555bbae6c734670f012834f292199e_b.jpg" data-caption="" data-size="normal" data-rawwidth="1866" data-rawheight="710" class="origin_image zh-lightbox-thumb" width="1866" data-original="https://pic3.zhimg.com/v2-fd555bbae6c734670f012834f292199e_r.jpg"/><img src="data:image/svg+xml;utf8,&lt;svg xmlns=&#39;http://www.w3.org/2000/svg&#39; width=&#39;1866&#39; height=&#39;710&#39;&gt;&lt;/svg&gt;" data-caption="" data-size="normal" data-rawwidth="1866" data-rawheight="710" class="origin_image zh-lightbox-thumb lazy" width="1866" data-original="https://pic3.zhimg.com/v2-fd555bbae6c734670f012834f292199e_r.jpg" data-actualsrc="https://pic3.zhimg.com/v2-fd555bbae6c734670f012834f292199e_b.jpg"/></figure><h3>三、Two-Stage Least Squares</h3><p>前面只使用一个 Instrumental variable，也可以使用多个 Instrumental variable；对于多个 instrumental variable 的情形，这里使用 two-stage least square （2SLS）方法来解决。</p><p><b><i>Instrumental variable 的要求</i></b></p><p>对于多个 instrumental variable，前面对于 instrumental variable 的两个要求（validity、relevance）可以写为</p><figure data-size="normal"><img src="https://pic2.zhimg.com/v2-aa8da6d220af65e34b93873ac9611805_b.png" data-caption="" data-size="normal" data-rawwidth="1377" data-rawheight="172" class="origin_image zh-lightbox-thumb" width="1377" data-original="https://pic2.zhimg.com/v2-aa8da6d220af65e34b93873ac9611805_r.jpg"/><img src="data:image/svg+xml;utf8,&lt;svg xmlns=&#39;http://www.w3.org/2000/svg&#39; width=&#39;1377&#39; height=&#39;172&#39;&gt;&lt;/svg&gt;" data-caption="" data-size="normal" data-rawwidth="1377" data-rawheight="172" class="origin_image zh-lightbox-thumb lazy" width="1377" data-original="https://pic2.zhimg.com/v2-aa8da6d220af65e34b93873ac9611805_r.jpg" data-actualsrc="https://pic2.zhimg.com/v2-aa8da6d220af65e34b93873ac9611805_b.png"/></figure><p>其中 z 的维度为 1xL，它包含所有 exogenous explanatory variables；同时要求 <img src="https://www.zhihu.com/equation?tex=%5Ctext%7Brank%7D%28z%27z%29%3DL" alt="\text{rank}(z&#39;z)=L" eeimg="1"/> ，即 z 中的各个元素之间没有共线性（collinearity）。K 表示 explanatory variable 的个数。</p><p>具体来说，它首先要求  instrumental variable 的数目要至少和 endogenous explanatory variable 的数目一样多；同时 instrumental variable 和 endogenous variable 之间要有比较好的对应关系。比如对于 <img src="https://www.zhihu.com/equation?tex=x_3%2C+x_4" alt="x_3, x_4" eeimg="1"/> 两个 endogenous variable 和 <img src="https://www.zhihu.com/equation?tex=z_1%2C+z_2" alt="z_1, z_2" eeimg="1"/> 两个 instrumental variable</p><figure data-size="normal"><img src="https://pic1.zhimg.com/v2-a74d5c631bb8745523ad6f475b434f20_b.png" data-caption="" data-size="normal" data-rawwidth="1470" data-rawheight="188" class="origin_image zh-lightbox-thumb" width="1470" data-original="https://pic1.zhimg.com/v2-a74d5c631bb8745523ad6f475b434f20_r.jpg"/><img src="data:image/svg+xml;utf8,&lt;svg xmlns=&#39;http://www.w3.org/2000/svg&#39; width=&#39;1470&#39; height=&#39;188&#39;&gt;&lt;/svg&gt;" data-caption="" data-size="normal" data-rawwidth="1470" data-rawheight="188" class="origin_image zh-lightbox-thumb lazy" width="1470" data-original="https://pic1.zhimg.com/v2-a74d5c631bb8745523ad6f475b434f20_r.jpg" data-actualsrc="https://pic1.zhimg.com/v2-a74d5c631bb8745523ad6f475b434f20_b.png"/></figure><p>如果 <img src="https://www.zhihu.com/equation?tex=%5Cpi_3%3D%5Cgamma_3%3D0%2C+%5Cpi_4+%5Cneq+0%2C+%5Cgamma_4+%5Cneq+0" alt="\pi_3=\gamma_3=0, \pi_4 \neq 0, \gamma_4 \neq 0" eeimg="1"/> 就不行，因为 <img src="https://www.zhihu.com/equation?tex=z_1" alt="z_1" eeimg="1"/> 与 <img src="https://www.zhihu.com/equation?tex=x_3%2C+x_4" alt="x_3, x_4" eeimg="1"/> 都不相关了。</p><p><b><i>2SLS 方法</i></b></p><p>考虑一个线性模型</p><figure data-size="normal"><img src="https://pic2.zhimg.com/v2-4e355fc4c1e2826d64cc6f302e4f37e1_b.png" data-caption="" data-size="normal" data-rawwidth="1364" data-rawheight="92" class="origin_image zh-lightbox-thumb" width="1364" data-original="https://pic2.zhimg.com/v2-4e355fc4c1e2826d64cc6f302e4f37e1_r.jpg"/><img src="data:image/svg+xml;utf8,&lt;svg xmlns=&#39;http://www.w3.org/2000/svg&#39; width=&#39;1364&#39; height=&#39;92&#39;&gt;&lt;/svg&gt;" data-caption="" data-size="normal" data-rawwidth="1364" data-rawheight="92" class="origin_image zh-lightbox-thumb lazy" width="1364" data-original="https://pic2.zhimg.com/v2-4e355fc4c1e2826d64cc6f302e4f37e1_r.jpg" data-actualsrc="https://pic2.zhimg.com/v2-4e355fc4c1e2826d64cc6f302e4f37e1_b.png"/></figure><p>其中 <img src="https://www.zhihu.com/equation?tex=x_1%2C+%5Ccdots%2C+x_k" alt="x_1, \cdots, x_k" eeimg="1"/> 为 exogenous variables， <img src="https://www.zhihu.com/equation?tex=y_2" alt="y_2" eeimg="1"/> 为 endogenous variable。令 <img src="https://www.zhihu.com/equation?tex=%7B%5Cbf+z%7D+%3D+%281%2C+x_1%2C+%5Ccdots%2C+x_k%2C+z_1%2C+%5Ccdots%2C+z_m%29" alt="{\bf z} = (1, x_1, \cdots, x_k, z_1, \cdots, z_m)" eeimg="1"/> ，其中最后 m 个元素为 m 个 Instrumental variables。 <img src="https://www.zhihu.com/equation?tex=y_2" alt="y_2" eeimg="1"/> 可以被写作</p><figure data-size="normal"><img src="https://pic2.zhimg.com/v2-63511a3130bffe0414400140848a5a7d_b.png" data-caption="" data-size="normal" data-rawwidth="1345" data-rawheight="119" class="origin_image zh-lightbox-thumb" width="1345" data-original="https://pic2.zhimg.com/v2-63511a3130bffe0414400140848a5a7d_r.jpg"/><img src="data:image/svg+xml;utf8,&lt;svg xmlns=&#39;http://www.w3.org/2000/svg&#39; width=&#39;1345&#39; height=&#39;119&#39;&gt;&lt;/svg&gt;" data-caption="" data-size="normal" data-rawwidth="1345" data-rawheight="119" class="origin_image zh-lightbox-thumb lazy" width="1345" data-original="https://pic2.zhimg.com/v2-63511a3130bffe0414400140848a5a7d_r.jpg" data-actualsrc="https://pic2.zhimg.com/v2-63511a3130bffe0414400140848a5a7d_b.png"/></figure><p>可以看出 <img src="https://www.zhihu.com/equation?tex=cov%28y_2%2C+u%29+%3D+cov%28%5Cvarepsilon%2C+u%29%5Cneq+0%2C+cov%28%5Chat+y_2%2C+u%29%3D0" alt="cov(y_2, u) = cov(\varepsilon, u)\neq 0, cov(\hat y_2, u)=0" eeimg="1"/> ，即可以用 <img src="https://www.zhihu.com/equation?tex=%5Chat+y_2" alt="\hat y_2" eeimg="1"/> 代替 <img src="https://www.zhihu.com/equation?tex=y_2" alt="y_2" eeimg="1"/> 用于线性回归中然后再用 OLS 估计系数 <img src="https://www.zhihu.com/equation?tex=%5Calpha_1%2C+%5Cbeta_%7B0%3Ak%7D" alt="\alpha_1, \beta_{0:k}" eeimg="1"/> 。</p><p><img src="https://www.zhihu.com/equation?tex=y_2" alt="y_2" eeimg="1"/> 对 <img src="https://www.zhihu.com/equation?tex=%7B%5Cbf+z%7D+%3D+%281%2C+x_1%2C+%5Ccdots%2C+x_k%2C+z_1%2C+%5Ccdots%2C+z_m%29" alt="{\bf z} = (1, x_1, \cdots, x_k, z_1, \cdots, z_m)" eeimg="1"/> 做回归，可以得到其预测值</p><figure data-size="normal"><img src="https://pic4.zhimg.com/v2-2ef5ac5a34d6ad3ae9e0c2b66fd6008f_b.png" data-caption="" data-size="normal" data-rawwidth="1354" data-rawheight="87" class="origin_image zh-lightbox-thumb" width="1354" data-original="https://pic4.zhimg.com/v2-2ef5ac5a34d6ad3ae9e0c2b66fd6008f_r.jpg"/><img src="data:image/svg+xml;utf8,&lt;svg xmlns=&#39;http://www.w3.org/2000/svg&#39; width=&#39;1354&#39; height=&#39;87&#39;&gt;&lt;/svg&gt;" data-caption="" data-size="normal" data-rawwidth="1354" data-rawheight="87" class="origin_image zh-lightbox-thumb lazy" width="1354" data-original="https://pic4.zhimg.com/v2-2ef5ac5a34d6ad3ae9e0c2b66fd6008f_r.jpg" data-actualsrc="https://pic4.zhimg.com/v2-2ef5ac5a34d6ad3ae9e0c2b66fd6008f_b.png"/></figure><p>这样的做法等价于一个 Nx(k+1) 的矩阵 <img src="https://www.zhihu.com/equation?tex=X%3D%28y_2%2C+x_1%2C+%5Ccdots%2C+x_k%29" alt="X=(y_2, x_1, \cdots, x_k)" eeimg="1"/>  对 <img src="https://www.zhihu.com/equation?tex=%7B%5Cbf+z%7D+%3D+%281%2C+x_1%2C+%5Ccdots%2C+x_k%2C+z_1%2C+%5Ccdots%2C+z_m%29" alt="{\bf z} = (1, x_1, \cdots, x_k, z_1, \cdots, z_m)" eeimg="1"/> 做回归，其预测值为</p><figure data-size="normal"><img src="https://pic1.zhimg.com/v2-61a040e8788bccb26e6134068e39c4d4_b.png" data-caption="" data-size="normal" data-rawwidth="1342" data-rawheight="83" class="origin_image zh-lightbox-thumb" width="1342" data-original="https://pic1.zhimg.com/v2-61a040e8788bccb26e6134068e39c4d4_r.jpg"/><img src="data:image/svg+xml;utf8,&lt;svg xmlns=&#39;http://www.w3.org/2000/svg&#39; width=&#39;1342&#39; height=&#39;83&#39;&gt;&lt;/svg&gt;" data-caption="" data-size="normal" data-rawwidth="1342" data-rawheight="83" class="origin_image zh-lightbox-thumb lazy" width="1342" data-original="https://pic1.zhimg.com/v2-61a040e8788bccb26e6134068e39c4d4_r.jpg" data-actualsrc="https://pic1.zhimg.com/v2-61a040e8788bccb26e6134068e39c4d4_b.png"/></figure><p>其中 <img src="https://www.zhihu.com/equation?tex=%5Chat+%5CPi" alt="\hat \Pi" eeimg="1"/> 为一个 (k+m+1)x(k+1) 的矩阵，其看起来为</p><figure data-size="normal"><img src="https://pic3.zhimg.com/v2-a6f77410537c63a3b1a85daa2eedaaba_b.jpg" data-caption="" data-size="normal" data-rawwidth="1300" data-rawheight="440" class="origin_image zh-lightbox-thumb" width="1300" data-original="https://pic3.zhimg.com/v2-a6f77410537c63a3b1a85daa2eedaaba_r.jpg"/><img src="data:image/svg+xml;utf8,&lt;svg xmlns=&#39;http://www.w3.org/2000/svg&#39; width=&#39;1300&#39; height=&#39;440&#39;&gt;&lt;/svg&gt;" data-caption="" data-size="normal" data-rawwidth="1300" data-rawheight="440" class="origin_image zh-lightbox-thumb lazy" width="1300" data-original="https://pic3.zhimg.com/v2-a6f77410537c63a3b1a85daa2eedaaba_r.jpg" data-actualsrc="https://pic3.zhimg.com/v2-a6f77410537c63a3b1a85daa2eedaaba_b.jpg"/></figure><p>即，其他的 <img src="https://www.zhihu.com/equation?tex=x_1%2C+%5Ccdots%2C+x_k" alt="x_1, \cdots, x_k" eeimg="1"/> 还是原来的数值，只是把 <img src="https://www.zhihu.com/equation?tex=y_2" alt="y_2" eeimg="1"/> 换成了 <img src="https://www.zhihu.com/equation?tex=%5Chat+y_2" alt="\hat y_2" eeimg="1"/> 。仿照 IV estimator</p><figure data-size="normal"><img src="https://pic4.zhimg.com/v2-d9226119e31f9ff2a4ad24f6a226547f_b.png" data-caption="" data-size="normal" data-rawwidth="1380" data-rawheight="91" class="origin_image zh-lightbox-thumb" width="1380" data-original="https://pic4.zhimg.com/v2-d9226119e31f9ff2a4ad24f6a226547f_r.jpg"/><img src="data:image/svg+xml;utf8,&lt;svg xmlns=&#39;http://www.w3.org/2000/svg&#39; width=&#39;1380&#39; height=&#39;91&#39;&gt;&lt;/svg&gt;" data-caption="" data-size="normal" data-rawwidth="1380" data-rawheight="91" class="origin_image zh-lightbox-thumb lazy" width="1380" data-original="https://pic4.zhimg.com/v2-d9226119e31f9ff2a4ad24f6a226547f_r.jpg" data-actualsrc="https://pic4.zhimg.com/v2-d9226119e31f9ff2a4ad24f6a226547f_b.png"/></figure><p>把 <img src="https://www.zhihu.com/equation?tex=Z" alt="Z" eeimg="1"/> 替换文 <img src="https://www.zhihu.com/equation?tex=%5Chat+X" alt="\hat X" eeimg="1"/> ，可以得到</p><figure data-size="normal"><img src="https://pic2.zhimg.com/v2-92d752f2a38a45bc7ed373408d4b6f79_b.jpg" data-caption="" data-size="normal" data-rawwidth="1328" data-rawheight="286" class="origin_image zh-lightbox-thumb" width="1328" data-original="https://pic2.zhimg.com/v2-92d752f2a38a45bc7ed373408d4b6f79_r.jpg"/><img src="data:image/svg+xml;utf8,&lt;svg xmlns=&#39;http://www.w3.org/2000/svg&#39; width=&#39;1328&#39; height=&#39;286&#39;&gt;&lt;/svg&gt;" data-caption="" data-size="normal" data-rawwidth="1328" data-rawheight="286" class="origin_image zh-lightbox-thumb lazy" width="1328" data-original="https://pic2.zhimg.com/v2-92d752f2a38a45bc7ed373408d4b6f79_r.jpg" data-actualsrc="https://pic2.zhimg.com/v2-92d752f2a38a45bc7ed373408d4b6f79_b.jpg"/></figure><p>即，在估计的 variables <img src="https://www.zhihu.com/equation?tex=%5Chat+X" alt="\hat X" eeimg="1"/> 上做 OLS 即可。</p><h3>四、 一个例子</h3><p>DeepIV 可以看做把上述 2SLS 方法推广到非线性模型。在讲这篇 paper 之前，先讲一个这篇 paper 提到的一个例子，用来理解 endogeneity。</p><figure data-size="normal"><img src="https://pic3.zhimg.com/v2-37d32d817bf44ba2fb92696410d87ffa_b.jpg" data-caption="" data-size="normal" data-rawwidth="1322" data-rawheight="360" class="origin_image zh-lightbox-thumb" width="1322" data-original="https://pic3.zhimg.com/v2-37d32d817bf44ba2fb92696410d87ffa_r.jpg"/><img src="data:image/svg+xml;utf8,&lt;svg xmlns=&#39;http://www.w3.org/2000/svg&#39; width=&#39;1322&#39; height=&#39;360&#39;&gt;&lt;/svg&gt;" data-caption="" data-size="normal" data-rawwidth="1322" data-rawheight="360" class="origin_image zh-lightbox-thumb lazy" width="1322" data-original="https://pic3.zhimg.com/v2-37d32d817bf44ba2fb92696410d87ffa_r.jpg" data-actualsrc="https://pic3.zhimg.com/v2-37d32d817bf44ba2fb92696410d87ffa_b.jpg"/></figure><p>考虑研究航空公司票价（prince，p）和销量（sales，y）的影响，即当其他条件不变时，如果增加票价，销量会如何变化；这是在研究一个 causal effect。</p><p>最好的方法就是随机化地做实验，比如随机对一些顾客，提高或者降低面向他们的票价；但是这样的实验不仅会对航空公司造成实际的经济损失（损失了潜在的客户或者减少了盈利），而且还客户还因为不公平的对待而对航空公司不满。</p><p>因此，我们希望从历史数据里面来挖掘票价（P）和销量（Y）之间的因果关系。</p><ol><li>Confounders：一个直接的方法就是把 Y 对 P 做回归，但是这样往往得出错误的结论。比如可能存在另外的因素，节假日（X），它不仅影响票价（P）也同时影响销量（Y），在节假日的时候航空公司定价高（P 大），同时人们出行需求也大，因此销量也高（Y 大）；这是在历史数据里面做回归，得出的结论就会使 Y 和 P 成正相关，这显然是错误的。</li><li>Unobservable variables：有一种方法是把可以观察到的影响因素也放到回归方程里面，根据前面几个 post 的内容，如果能够把所有的因素都包含进来，那么也能够得出正确的结论。但是，有可能会有一些观察不到的作用因素（E），比如在某个地区召开某个会议，它会同时使得票价（P）和销量（Y）都变大。</li><li>Instrumental variable（IV）：因此，最有效的办法就是找到一个 IV，使得它只影响票价（当然，它也可以通过 P 来影响 Y，但是不能直接影响 Y），而和其他因素（X、E）不相关。在这里，我们找到『燃油价格』这个因素来做为 IV，它上升时，航空公司基于成本考虑会上调票价，但是该因素和其他因素（比如是否节假日、是否在某个地区有会议）无关。需要注意的是，IV 的选取基本上基于人为的先验知识。</li></ol><p>五、问题设定</p><p>符号和前面一致，我们想要探究的是 y 和 p 之间的关系，模型为</p><figure data-size="normal"><img src="https://pic4.zhimg.com/v2-58944227f4307e0e57c3d4bf30e1fa1b_b.png" data-caption="" data-size="normal" data-rawwidth="759" data-rawheight="42" class="origin_image zh-lightbox-thumb" width="759" data-original="https://pic4.zhimg.com/v2-58944227f4307e0e57c3d4bf30e1fa1b_r.jpg"/><img src="data:image/svg+xml;utf8,&lt;svg xmlns=&#39;http://www.w3.org/2000/svg&#39; width=&#39;759&#39; height=&#39;42&#39;&gt;&lt;/svg&gt;" data-caption="" data-size="normal" data-rawwidth="759" data-rawheight="42" class="origin_image zh-lightbox-thumb lazy" width="759" data-original="https://pic4.zhimg.com/v2-58944227f4307e0e57c3d4bf30e1fa1b_r.jpg" data-actualsrc="https://pic4.zhimg.com/v2-58944227f4307e0e57c3d4bf30e1fa1b_b.png"/></figure><p>其中 <img src="https://www.zhihu.com/equation?tex=%5Cmathbb%7BE%7D%5Be%5D+%3D+0" alt="\mathbb{E}[e] = 0" eeimg="1"/> ，认为变量 p 是 endogenous 的，即 <img src="https://www.zhihu.com/equation?tex=%5Cmathbb%7BE%7D%5Be%7Cx%2Cp%5D+%5Cneq+0" alt="\mathbb{E}[e|x,p] \neq 0" eeimg="1"/> ，或者 <img src="https://www.zhihu.com/equation?tex=%5Cmathbb%7BE%7D%5Bpe%7Cx%5D+%5Cneq+0" alt="\mathbb{E}[pe|x] \neq 0" eeimg="1"/> （是前面的一种特殊情况，相当于线性不相关）。</p><p>定义一个 counterfactual prediction function</p><figure data-size="normal"><img src="https://pic3.zhimg.com/v2-740dc5841ffaf02988a42ed05d93aeb6_b.png" data-caption="" data-size="normal" data-rawwidth="1130" data-rawheight="74" class="origin_image zh-lightbox-thumb" width="1130" data-original="https://pic3.zhimg.com/v2-740dc5841ffaf02988a42ed05d93aeb6_r.jpg"/><img src="data:image/svg+xml;utf8,&lt;svg xmlns=&#39;http://www.w3.org/2000/svg&#39; width=&#39;1130&#39; height=&#39;74&#39;&gt;&lt;/svg&gt;" data-caption="" data-size="normal" data-rawwidth="1130" data-rawheight="74" class="origin_image zh-lightbox-thumb lazy" width="1130" data-original="https://pic3.zhimg.com/v2-740dc5841ffaf02988a42ed05d93aeb6_r.jpg" data-actualsrc="https://pic3.zhimg.com/v2-740dc5841ffaf02988a42ed05d93aeb6_b.png"/></figure><p>注意到，要是 e 和 x 无关，而只与 p 有关，那么 h 函数和 g 函数一致。固定 x，希望知道如果把 <img src="https://www.zhihu.com/equation?tex=p%3Dp_0" alt="p=p_0" eeimg="1"/> 变动为 <img src="https://www.zhihu.com/equation?tex=p%3Dp_1" alt="p=p_1" eeimg="1"/> 时 y 会变化多少，这其实就是在求 <img src="https://www.zhihu.com/equation?tex=g%28p_1%2Cx%29+-+g%28p_0%2Cx%29+%3D+h%28p_1%2Cx%29+-+h%28p_0%2Cx%29+" alt="g(p_1,x) - g(p_0,x) = h(p_1,x) - h(p_0,x) " eeimg="1"/> 。</p><p>这里再次强调一下，函数 <img src="https://www.zhihu.com/equation?tex=h%28p%2Cx%29" alt="h(p,x)" eeimg="1"/> 不能通过用 p, x 去拟合 y 来得到，因为拟合得到的函数实际上为 <img src="https://www.zhihu.com/equation?tex=%5Cmathbb%7BE%7D%5By%7Cp%2Cx%5D" alt="\mathbb{E}[y|p,x]" eeimg="1"/> ，它们的差为</p><figure data-size="normal"><img src="https://pic3.zhimg.com/v2-a5c4fcd22466cd31c161c822431e54d6_b.png" data-caption="" data-size="normal" data-rawwidth="1268" data-rawheight="148" class="origin_image zh-lightbox-thumb" width="1268" data-original="https://pic3.zhimg.com/v2-a5c4fcd22466cd31c161c822431e54d6_r.jpg"/><img src="data:image/svg+xml;utf8,&lt;svg xmlns=&#39;http://www.w3.org/2000/svg&#39; width=&#39;1268&#39; height=&#39;148&#39;&gt;&lt;/svg&gt;" data-caption="" data-size="normal" data-rawwidth="1268" data-rawheight="148" class="origin_image zh-lightbox-thumb lazy" width="1268" data-original="https://pic3.zhimg.com/v2-a5c4fcd22466cd31c161c822431e54d6_r.jpg" data-actualsrc="https://pic3.zhimg.com/v2-a5c4fcd22466cd31c161c822431e54d6_b.png"/></figure><p>不等于我们需要求解的 <img src="https://www.zhihu.com/equation?tex=g%28p_1%2Cx%29+-+g%28p_0%2Cx%29" alt="g(p_1,x) - g(p_0,x)" eeimg="1"/> 。</p><p>这时，我们就需要一个 Instrumental variable z 了。它需要满足以下三点要求</p><figure data-size="normal"><img src="https://pic1.zhimg.com/v2-381048b84fe93dacee7cf8bbe1e09c98_b.jpg" data-caption="" data-size="normal" data-rawwidth="1248" data-rawheight="296" class="origin_image zh-lightbox-thumb" width="1248" data-original="https://pic1.zhimg.com/v2-381048b84fe93dacee7cf8bbe1e09c98_r.jpg"/><img src="data:image/svg+xml;utf8,&lt;svg xmlns=&#39;http://www.w3.org/2000/svg&#39; width=&#39;1248&#39; height=&#39;296&#39;&gt;&lt;/svg&gt;" data-caption="" data-size="normal" data-rawwidth="1248" data-rawheight="296" class="origin_image zh-lightbox-thumb lazy" width="1248" data-original="https://pic1.zhimg.com/v2-381048b84fe93dacee7cf8bbe1e09c98_r.jpg" data-actualsrc="https://pic1.zhimg.com/v2-381048b84fe93dacee7cf8bbe1e09c98_b.jpg"/></figure><p>第一点要求和前面的 <img src="https://www.zhihu.com/equation?tex=%5Ctheta_1+%5Cneq+0" alt="\theta_1 \neq 0" eeimg="1"/> 类似，只不过变成了在非线性模型下的表述；第二个即表明引入的该变量不会成为 explanatory variable 进入原方程；第三个表示引入的该变量和原来的误差项不相关。</p><h3>六、DeepIV 结构</h3><p>在引入变量 z 之后，可以写出如下关系</p><figure data-size="normal"><img src="https://pic2.zhimg.com/v2-0d92ab6968508c6c9900e415b99ea991_b.png" data-caption="" data-size="normal" data-rawwidth="1362" data-rawheight="186" class="origin_image zh-lightbox-thumb" width="1362" data-original="https://pic2.zhimg.com/v2-0d92ab6968508c6c9900e415b99ea991_r.jpg"/><img src="data:image/svg+xml;utf8,&lt;svg xmlns=&#39;http://www.w3.org/2000/svg&#39; width=&#39;1362&#39; height=&#39;186&#39;&gt;&lt;/svg&gt;" data-caption="" data-size="normal" data-rawwidth="1362" data-rawheight="186" class="origin_image zh-lightbox-thumb lazy" width="1362" data-original="https://pic2.zhimg.com/v2-0d92ab6968508c6c9900e415b99ea991_r.jpg" data-actualsrc="https://pic2.zhimg.com/v2-0d92ab6968508c6c9900e415b99ea991_b.png"/></figure><p>注意到 <img src="https://www.zhihu.com/equation?tex=%5Cmathbb%7BE%7D%5By%7Cx%2Cz%5D" alt="\mathbb{E}[y|x,z]" eeimg="1"/> 可以通过有监督学习得到， <img src="https://www.zhihu.com/equation?tex=F%28p%7Cx%2Cz%29" alt="F(p|x,z)" eeimg="1"/> 也可以通过有监督学习得到，在得到这两者之后，能够反向求解得到我们需要的 <img src="https://www.zhihu.com/equation?tex=h%28p%2Cx%29" alt="h(p,x)" eeimg="1"/> 。实际算法分为两步：</p><ul><li>第一步：先学习 <img src="https://www.zhihu.com/equation?tex=F_%5Cphi%28p%7Cx%2Cz%29" alt="F_\phi(p|x,z)" eeimg="1"/> ；对于离散的 p，学习一个 categorical distribution， <img src="https://www.zhihu.com/equation?tex=P%28p%3Dp%5Ek%29+%3D+%5Cpi_k%28x%2C+z%3B%5Cphi%29" alt="P(p=p^k) = \pi_k(x, z;\phi)" eeimg="1"/> ；对于连续的 p，学习一个 mixture of Gaussian distributions， <img src="https://www.zhihu.com/equation?tex=y%7Cx%2Cz+%5Csim+%5Csum_k%5Cpi_k%28x%2Cz%3B%5Cphi%29%5Cmathcal%7BN%7D%28%5Cmu_k%28x%2Cz%3B%5Cphi%29%2C+%5Csigma_k%28x%2Cz%3B%5Cphi%29%29" alt="y|x,z \sim \sum_k\pi_k(x,z;\phi)\mathcal{N}(\mu_k(x,z;\phi), \sigma_k(x,z;\phi))" eeimg="1"/> 。</li><li>第二步：然后学习 <img src="https://www.zhihu.com/equation?tex=h_%5Ctheta%28p%2Cx%29" alt="h_\theta(p,x)" eeimg="1"/> ，目标是最小化</li></ul><figure data-size="normal"><img src="https://pic3.zhimg.com/v2-6ab4cb64f5c9bcfb33179a6cca561946_b.png" data-caption="" data-size="normal" data-rawwidth="1358" data-rawheight="130" class="origin_image zh-lightbox-thumb" width="1358" data-original="https://pic3.zhimg.com/v2-6ab4cb64f5c9bcfb33179a6cca561946_r.jpg"/><img src="data:image/svg+xml;utf8,&lt;svg xmlns=&#39;http://www.w3.org/2000/svg&#39; width=&#39;1358&#39; height=&#39;130&#39;&gt;&lt;/svg&gt;" data-caption="" data-size="normal" data-rawwidth="1358" data-rawheight="130" class="origin_image zh-lightbox-thumb lazy" width="1358" data-original="https://pic3.zhimg.com/v2-6ab4cb64f5c9bcfb33179a6cca561946_r.jpg" data-actualsrc="https://pic3.zhimg.com/v2-6ab4cb64f5c9bcfb33179a6cca561946_b.png"/></figure><p>其中 |D| 是训练集的大小。</p><p>对于第二步，文章着重讲了一下优化的方法，令 <img src="https://www.zhihu.com/equation?tex=%5Cmathcal%7BL%7D_t+%3D+%5Cleft%28y_t+-+%5Cmathbb%7BE%7D_%7Bp%5Csim+F_%5Cphi+%28x_t%2Cz_t%29%7D+%5Bh_%5Ctheta%28p%2Cx_t%29%5D%5Cright%29%5E2" alt="\mathcal{L}_t = \left(y_t - \mathbb{E}_{p\sim F_\phi (x_t,z_t)} [h_\theta(p,x_t)]\right)^2" eeimg="1"/> ，而</p><figure data-size="normal"><img src="https://pic2.zhimg.com/v2-fbae023b4132246112d2e971ae89585d_b.jpg" data-caption="" data-size="normal" data-rawwidth="1372" data-rawheight="262" class="origin_image zh-lightbox-thumb" width="1372" data-original="https://pic2.zhimg.com/v2-fbae023b4132246112d2e971ae89585d_r.jpg"/><img src="data:image/svg+xml;utf8,&lt;svg xmlns=&#39;http://www.w3.org/2000/svg&#39; width=&#39;1372&#39; height=&#39;262&#39;&gt;&lt;/svg&gt;" data-caption="" data-size="normal" data-rawwidth="1372" data-rawheight="262" class="origin_image zh-lightbox-thumb lazy" width="1372" data-original="https://pic2.zhimg.com/v2-fbae023b4132246112d2e971ae89585d_r.jpg" data-actualsrc="https://pic2.zhimg.com/v2-fbae023b4132246112d2e971ae89585d_b.jpg"/></figure><p>因此可以看出，在对其估计梯度的时候，对于每一个 <img src="https://www.zhihu.com/equation?tex=%28x_t%2C+z_t%2C+y_t%29" alt="(x_t, z_t, y_t)" eeimg="1"/> 数据点需要从分布 <img src="https://www.zhihu.com/equation?tex=F_%5Cphi%28x_t%2C+z_t%29" alt="F_\phi(x_t, z_t)" eeimg="1"/> 从采集两波 <img src="https://www.zhihu.com/equation?tex=p" alt="p" eeimg="1"/> 样本，即</p><figure data-size="normal"><img src="https://pic3.zhimg.com/v2-052538a3b41668a47a4b2e77a8412a7a_b.png" data-caption="" data-size="normal" data-rawwidth="1262" data-rawheight="168" class="origin_image zh-lightbox-thumb" width="1262" data-original="https://pic3.zhimg.com/v2-052538a3b41668a47a4b2e77a8412a7a_r.jpg"/><img src="data:image/svg+xml;utf8,&lt;svg xmlns=&#39;http://www.w3.org/2000/svg&#39; width=&#39;1262&#39; height=&#39;168&#39;&gt;&lt;/svg&gt;" data-caption="" data-size="normal" data-rawwidth="1262" data-rawheight="168" class="origin_image zh-lightbox-thumb lazy" width="1262" data-original="https://pic3.zhimg.com/v2-052538a3b41668a47a4b2e77a8412a7a_r.jpg" data-actualsrc="https://pic3.zhimg.com/v2-052538a3b41668a47a4b2e77a8412a7a_b.png"/></figure><p>因此要过两波 forward pass 和一波 backward pass（求梯度）。</p><p>如果省事，只采样一波 p，在两处地方都用它们，那么得到的损失函数将会是原损失函数的上界。</p><figure data-size="normal"><img src="https://pic3.zhimg.com/v2-8b8a2c062b29395ca30be14af4bbf80e_b.png" data-caption="" data-size="normal" data-rawwidth="1346" data-rawheight="156" class="origin_image zh-lightbox-thumb" width="1346" data-original="https://pic3.zhimg.com/v2-8b8a2c062b29395ca30be14af4bbf80e_r.jpg"/><img src="data:image/svg+xml;utf8,&lt;svg xmlns=&#39;http://www.w3.org/2000/svg&#39; width=&#39;1346&#39; height=&#39;156&#39;&gt;&lt;/svg&gt;" data-caption="" data-size="normal" data-rawwidth="1346" data-rawheight="156" class="origin_image zh-lightbox-thumb lazy" width="1346" data-original="https://pic3.zhimg.com/v2-8b8a2c062b29395ca30be14af4bbf80e_r.jpg" data-actualsrc="https://pic3.zhimg.com/v2-8b8a2c062b29395ca30be14af4bbf80e_b.png"/></figure><p>但是实验中发现这样做效果竟然更好，文章给出的解释是，这样的梯度下降虽然有 bias，但是更新的 variance 更小。</p><p>这里讨论的情形是 continuous outcome space and continuous treatment space，此外还可以推广到 discrete outcome space / treatment space。</p><p>对于因果推断来说，模型的 validation 更为重要，文章还给出了做 validation 的方法。</p></div></div><div class="ContentItem-time">发布于 2019-10-25</div><div class="Post-topicsAndReviewer"><div class="TopicList Post-Topics"><div class="Tag Topic"><span class="Tag-content"><a class="TopicLink" href="//www.zhihu.com/topic/19624891" target="_blank"><div class="Popover"><div id="null-toggle" aria-haspopup="true" aria-expanded="false" aria-owns="null-content">因果</div></div></a></span></div><div class="Tag Topic"><span class="Tag-content"><a class="TopicLink" href="//www.zhihu.com/topic/19576422" target="_blank"><div class="Popover"><div id="null-toggle" aria-haspopup="true" aria-expanded="false" aria-owns="null-content">统计</div></div></a></span></div><div class="Tag Topic"><span class="Tag-content"><a class="TopicLink" href="//www.zhihu.com/topic/19816584" target="_blank"><div class="Popover"><div id="null-toggle" aria-haspopup="true" aria-expanded="false" aria-owns="null-content">数据存储（广义）</div></div></a></span></div></div></div><div><div class="Sticky RichContent-actions is-bottom"><div class="ContentItem-actions"><span><button aria-label="赞同 15 " type="button" class="Button VoteButton VoteButton--up"><span style="display:inline-flex;align-items:center">​<svg class="Zi Zi--TriangleUp VoteButton-TriangleUp" fill="currentColor" viewBox="0 0 24 24" width="10" height="10"><path d="M2 18.242c0-.326.088-.532.237-.896l7.98-13.203C10.572 3.57 11.086 3 12 3c.915 0 1.429.571 1.784 1.143l7.98 13.203c.15.364.236.57.236.896 0 1.386-.875 1.9-1.955 1.9H3.955c-1.08 0-1.955-.517-1.955-1.9z" fill-rule="evenodd"></path></svg></span>赞同 15</button><button aria-label="反对" type="button" class="Button VoteButton VoteButton--down"><span style="display:inline-flex;align-items:center">​<svg class="Zi Zi--TriangleDown" fill="currentColor" viewBox="0 0 24 24" width="10" height="10"><path d="M20.044 3H3.956C2.876 3 2 3.517 2 4.9c0 .326.087.533.236.896L10.216 19c.355.571.87 1.143 1.784 1.143s1.429-.572 1.784-1.143l7.98-13.204c.149-.363.236-.57.236-.896 0-1.386-.876-1.9-1.956-1.9z" fill-rule="evenodd"></path></svg></span></button></span><button type="button" class="Button BottomActions-CommentBtn Button--plain Button--withIcon Button--withLabel"><span style="display:inline-flex;align-items:center">​<svg class="Zi Zi--Comment Button-zi" fill="currentColor" viewBox="0 0 24 24" width="1.2em" height="1.2em"><path d="M10.241 19.313a.97.97 0 0 0-.77.2 7.908 7.908 0 0 1-3.772 1.482.409.409 0 0 1-.38-.637 5.825 5.825 0 0 0 1.11-2.237.605.605 0 0 0-.227-.59A7.935 7.935 0 0 1 3 11.25C3 6.7 7.03 3 12 3s9 3.7 9 8.25-4.373 9.108-10.759 8.063z" fill-rule="evenodd"></path></svg></span>2 条评论</button><div class="Popover ShareMenu"><div class="ShareMenu-toggler" id="null-toggle" aria-haspopup="true" aria-expanded="false" aria-owns="null-content"><button type="button" class="Button Button--plain Button--withIcon Button--withLabel"><span style="display:inline-flex;align-items:center">​<svg class="Zi Zi--Share Button-zi" fill="currentColor" viewBox="0 0 24 24" width="1.2em" height="1.2em"><path d="M2.931 7.89c-1.067.24-1.275 1.669-.318 2.207l5.277 2.908 8.168-4.776c.25-.127.477.198.273.39L9.05 14.66l.927 5.953c.18 1.084 1.593 1.376 2.182.456l9.644-15.242c.584-.892-.212-2.029-1.234-1.796L2.93 7.89z" fill-rule="evenodd"></path></svg></span>分享</button></div></div><button type="button" class="Button ContentItem-action Button--plain Button--withIcon Button--withLabel"><span style="display:inline-flex;align-items:center">​<svg class="Zi Zi--Heart Button-zi" fill="currentColor" viewBox="0 0 24 24" width="1.2em" height="1.2em"><path d="M2 8.437C2 5.505 4.294 3.094 7.207 3 9.243 3 11.092 4.19 12 6c.823-1.758 2.649-3 4.651-3C19.545 3 22 5.507 22 8.432 22 16.24 13.842 21 12 21 10.158 21 2 16.24 2 8.437z" fill-rule="evenodd"></path></svg></span>喜欢</button><button type="button" class="Button ContentItem-action Button--plain Button--withIcon Button--withLabel"><span style="display:inline-flex;align-items:center">​<svg class="Zi Zi--Star Button-zi" fill="currentColor" viewBox="0 0 24 24" width="1.2em" height="1.2em"><path d="M5.515 19.64l.918-5.355-3.89-3.792c-.926-.902-.639-1.784.64-1.97L8.56 7.74l2.404-4.871c.572-1.16 1.5-1.16 2.072 0L15.44 7.74l5.377.782c1.28.186 1.566 1.068.64 1.97l-3.89 3.793.918 5.354c.219 1.274-.532 1.82-1.676 1.218L12 18.33l-4.808 2.528c-1.145.602-1.896.056-1.677-1.218z" fill-rule="evenodd"></path></svg></span>收藏</button><div class="Post-ActionMenuButton"><div class="Popover"><div id="null-toggle" aria-haspopup="true" aria-expanded="false" aria-owns="null-content"><button type="button" class="Button Button--plain Button--withIcon Button--iconOnly"><span style="display:inline-flex;align-items:center">​<svg class="Zi Zi--Dots Button-zi" fill="currentColor" viewBox="0 0 24 24" width="1.2em" height="1.2em"><path d="M5 14a2 2 0 1 1 0-4 2 2 0 0 1 0 4zm7 0a2 2 0 1 1 0-4 2 2 0 0 1 0 4zm7 0a2 2 0 1 1 0-4 2 2 0 0 1 0 4z" fill-rule="evenodd"></path></svg></span></button></div></div></div></div></div></div></article><div class="Post-Sub Post-NormalSub"><div class="PostIndex-Contributions"><h3 class="BlockTitle">文章被以下专栏收录</h3><ul><div class="ContentItem Column-ColumnItem"><div class="ContentItem-main"><div class="ContentItem-image"><a class="ColumnLink" href="/reinforcementlearning"><div class="Popover"><div id="null-toggle" aria-haspopup="true" aria-expanded="false" aria-owns="null-content"><img class="Avatar Avatar--medium Avatar--round" width="40" height="40" src="https://pic2.zhimg.com/v2-5d1f04a84f6be8896c07a32a05e1d6d1_xs.jpg" srcSet="https://pic2.zhimg.com/v2-5d1f04a84f6be8896c07a32a05e1d6d1_l.jpg 2x" alt="强化学习前沿"/></div></div></a></div><div class="ContentItem-head"><h2 class="ContentItem-title"><a class="ColumnLink ColumnItem-Title" href="/reinforcementlearning"><div class="Popover"><div id="null-toggle" aria-haspopup="true" aria-expanded="false" aria-owns="null-content">强化学习前沿</div></div></a></h2><div class="ContentItem-meta">读呀读paper</div></div><div class="ContentItem-extra"><a href="/reinforcementlearning" type="button" class="Button">进入专栏</a></div></div></div></ul></div></div></div></main></div></div><script nonce="0739f6c8-5bbb-4a07-a3a0-58af3fc00a50" async="" src="https://www.googletagmanager.com/gtag/js?id=UA-149949619-1"></script><script nonce="0739f6c8-5bbb-4a07-a3a0-58af3fc00a50">function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","UA-149949619-1");</script><script id="js-clientConfig" type="text/json">{"host":"zhihu.com","protocol":"https:","wwwHost":"www.zhihu.com","fetchRoot":{"www":"https:\u002F\u002Fwww.zhihu.com","api":"https:\u002F\u002Fapi.zhihu.com","zhuanlan":"https:\u002F\u002Fzhuanlan.zhihu.com"}}</script><script id="js-initialData" type="text/json">{"initialState":{"common":{"ask":{}},"loading":{"global":{"count":0},"local":{"env\u002FgetIpinfo\u002F":false,"article\u002Fget\u002F":false,"brand\u002FgetUrl\u002F":false}},"club":{"tags":{}},"entities":{"users":{"zhang-chu-heng":{"isFollowed":false,"avatarUrlTemplate":"https:\u002F\u002Fpic4.zhimg.com\u002Fv2-2b7c11f27a7fd03282819889435815aa_{size}.jpg","uid":"35077274730496","userType":"people","isFollowing":false,"urlToken":"zhang-chu-heng","id":"db39e3e0528520071b0a6e5f6240cfea","description":"","name":"张楚珩","isAdvertiser":false,"headline":"强化学习 量化投资","gender":1,"url":"\u002Fpeople\u002Fdb39e3e0528520071b0a6e5f6240cfea","avatarUrl":"https:\u002F\u002Fpic4.zhimg.com\u002Fv2-2b7c11f27a7fd03282819889435815aa_l.jpg","isOrg":false,"type":"people","badge":[{"type":"identity","topics":[],"description":"清华大学 交叉信息院博士在读"}],"exposedMedal":{"medalId":"1124316222665379841","medalName":"我的知乎 2019","avatarUrl":"https:\u002F\u002Fpic3.zhimg.com\u002Fv2-2592b0b52e1fac99f69b38e00252413b_r.png","miniAvatarUrl":"https:\u002F\u002Fpic3.zhimg.com\u002Fv2-ad363cc3088dc8de7544fd08b1c4987a_is.png","description":"参与「我的知乎 2019」即可获得"}}},"questions":{},"answers":{},"articles":{"88235983":{"trackUrl":["https:\u002F\u002Fsugar.zhihu.com\u002Fplutus_adreaper\u002Fpage_monitor_log?si=__SESSIONID__&ti=__ATOKEN__&at=view&pf=__OS__&ed=__MEMBERID__&idfa=__IDFA__&imei=__IMEI__&androidid=__ANDROIDID__&oaid=__OAID__&ci=__CREATIVEID__"],"id":88235983,"title":"【统计】Instrumental Variables","type":"article","excerptTitle":"","url":"https:\u002F\u002Fzhuanlan.zhihu.com\u002Fp\u002F88235983","imageUrl":"https:\u002F\u002Fpic4.zhimg.com\u002Fv2-679c8ffef665c4b68e7d4aab6c5e0ba3_b.jpg","titleImage":"https:\u002F\u002Fpic4.zhimg.com\u002Fv2-679c8ffef665c4b68e7d4aab6c5e0ba3_b.jpg","excerpt":"\u003Cimg src=\"https:\u002F\u002Fpic1.zhimg.com\u002Fv2-f64a4f406ef21ac2bb632e1cbedbba80_200x112.png\" data-caption=\"validity condition and relevance condition （图中写错了）\" data-size=\"normal\" data-rawwidth=\"1330\" data-rawheight=\"617\" data-watermark=\"watermark\" data-original-src=\"v2-f64a4f406ef21ac2bb632e1cbedbba80\" data-watermark-src=\"v2-14c34d0da8b5edcd53d6d82342aaa47f\" data-private-watermark-src=\"\" class=\"origin_image inline-img zh-lightbox-thumb\" data-original=\"https:\u002F\u002Fpic1.zhimg.com\u002Fv2-f64a4f406ef21ac2bb632e1cbedbba80_r.png\"\u002F\u003E还是继续前面因果推断的话题，这里讲一个从数据中做因果推断的另一种有效的方法——Instrumental variables（IV）。同时，也补充一个用深度学习方法来实现 IV 的一篇论文（ICML 2017）。原文传送门\u003Ca href=\"https:\u002F\u002Flink.zhihu.com\u002F?target=http%3A\u002F\u002Fwww.soderbom.net\u002Flec2n_final.pdf\" class=\" external\" target=\"_blank\" rel=\"nofollow noreferrer\"\u003E\u003Cspan class=\"invisible\"\u003Ehttp:\u002F\u002Fwww.\u003C\u002Fspan\u003E\u003Cspan class=\"visible\"\u003Esoderbom.net\u002Flec2n_fina\u003C\u002Fspan\u003E\u003Cspan class=\"invisible\"\u003El.pdf\u003C\u002Fspan\u003E\u003Cspan class=\"ellipsis\"\u003E\u003C\u002Fspan\u003E\u003C\u002Fa\u003E\u003Ca href=\"https:\u002F\u002Flink.zhihu.com\u002F?target=http%3A\u002F\u002Fwww3.grips.ac.jp\u002F~yamanota\u002FLecture%2520Note%25208%2520to%252010%25202SLS%2520%26%2520others.pdf\" class=\" wrap external\" target=\"_blank\" rel=\"nofollow noreferrer\"\u003Ehttp:\u002F\u002Fwww3.grips.ac.jp\u002F~yamanota\u002F\u003C\u002Fa\u003E\u003Ca href=\"https:\u002F\u002Flink.zhihu.com\u002F?target=http%3A\u002F\u002Fproceedings.mlr.press\u002Fv70\u002Fhartford17a\u002Fhartford17a.pdf\" class=\" wrap external\" target=\"_blank\" rel=\"nofollow noreferrer\"\u003EH…\u003C\u002Fa\u003E","created":1572009106,"updated":1572009106,"author":{"isFollowed":false,"avatarUrlTemplate":"https:\u002F\u002Fpic4.zhimg.com\u002Fv2-2b7c11f27a7fd03282819889435815aa_{size}.jpg","uid":"35077274730496","userType":"people","isFollowing":false,"urlToken":"zhang-chu-heng","id":"db39e3e0528520071b0a6e5f6240cfea","description":"","name":"张楚珩","isAdvertiser":false,"headline":"强化学习 量化投资","gender":1,"url":"\u002Fpeople\u002Fdb39e3e0528520071b0a6e5f6240cfea","avatarUrl":"https:\u002F\u002Fpic4.zhimg.com\u002Fv2-2b7c11f27a7fd03282819889435815aa_l.jpg","isOrg":false,"type":"people","badge":[{"type":"identity","topics":[],"description":"清华大学 交叉信息院博士在读"}],"exposedMedal":{"medalId":"1124316222665379841","medalName":"我的知乎 2019","avatarUrl":"https:\u002F\u002Fpic3.zhimg.com\u002Fv2-2592b0b52e1fac99f69b38e00252413b_r.png","miniAvatarUrl":"https:\u002F\u002Fpic3.zhimg.com\u002Fv2-ad363cc3088dc8de7544fd08b1c4987a_is.png","description":"参与「我的知乎 2019」即可获得"}},"commentPermission":"all","state":"published","imageWidth":2092,"imageHeight":586,"content":"\u003Cp\u003E还是继续前面因果推断的话题，这里讲一个从数据中做因果推断的另一种有效的方法——Instrumental variables（IV）。同时，也补充一个用深度学习方法来实现 IV 的一篇论文（ICML 2017）。\u003C\u002Fp\u003E\u003Ch2\u003E原文传送门\u003C\u002Fh2\u003E\u003Cp\u003E\u003Ca href=\"https:\u002F\u002Flink.zhihu.com\u002F?target=http%3A\u002F\u002Fwww.soderbom.net\u002Flec2n_final.pdf\" class=\" external\" target=\"_blank\" rel=\"nofollow noreferrer\"\u003E\u003Cspan class=\"invisible\"\u003Ehttp:\u002F\u002Fwww.\u003C\u002Fspan\u003E\u003Cspan class=\"visible\"\u003Esoderbom.net\u002Flec2n_fina\u003C\u002Fspan\u003E\u003Cspan class=\"invisible\"\u003El.pdf\u003C\u002Fspan\u003E\u003Cspan class=\"ellipsis\"\u003E\u003C\u002Fspan\u003E\u003C\u002Fa\u003E\u003C\u002Fp\u003E\u003Cp\u003E\u003Ca href=\"https:\u002F\u002Flink.zhihu.com\u002F?target=http%3A\u002F\u002Fwww3.grips.ac.jp\u002F~yamanota\u002FLecture%2520Note%25208%2520to%252010%25202SLS%2520%26%2520others.pdf\" class=\" wrap external\" target=\"_blank\" rel=\"nofollow noreferrer\"\u003Ehttp:\u002F\u002Fwww3.grips.ac.jp\u002F~yamanota\u002F\u003C\u002Fa\u003E\u003C\u002Fp\u003E\u003Cp\u003E\u003Ca href=\"https:\u002F\u002Flink.zhihu.com\u002F?target=http%3A\u002F\u002Fproceedings.mlr.press\u002Fv70\u002Fhartford17a\u002Fhartford17a.pdf\" class=\" wrap external\" target=\"_blank\" rel=\"nofollow noreferrer\"\u003EHartford, Jason, et al. &#34;Deep IV: A flexible approach for counterfactual prediction.&#34; Proceedings of the 34th International Conference on Machine Learning-Volume 70. JMLR. org, 2017.\u003C\u002Fa\u003E\u003C\u002Fp\u003E\u003Ch2\u003E正文\u003C\u002Fh2\u003E\u003Ch3\u003E一、Instrumental variable\u003C\u002Fh3\u003E\u003Cp\u003E还是看一个线性模型，\u003C\u002Fp\u003E\u003Cfigure data-size=\"normal\"\u003E\u003Cnoscript\u003E\u003Cimg src=\"https:\u002F\u002Fpic1.zhimg.com\u002Fv2-9b427e4a25e3e6ee7bdc46c51275ad38_b.png\" data-caption=\"\" data-size=\"normal\" data-rawwidth=\"1756\" data-rawheight=\"94\" class=\"origin_image zh-lightbox-thumb\" width=\"1756\" data-original=\"https:\u002F\u002Fpic1.zhimg.com\u002Fv2-9b427e4a25e3e6ee7bdc46c51275ad38_r.jpg\"\u002F\u003E\u003C\u002Fnoscript\u003E\u003Cimg src=\"data:image\u002Fsvg+xml;utf8,&lt;svg xmlns=&#39;http:\u002F\u002Fwww.w3.org\u002F2000\u002Fsvg&#39; width=&#39;1756&#39; height=&#39;94&#39;&gt;&lt;\u002Fsvg&gt;\" data-caption=\"\" data-size=\"normal\" data-rawwidth=\"1756\" data-rawheight=\"94\" class=\"origin_image zh-lightbox-thumb lazy\" width=\"1756\" data-original=\"https:\u002F\u002Fpic1.zhimg.com\u002Fv2-9b427e4a25e3e6ee7bdc46c51275ad38_r.jpg\" data-actualsrc=\"https:\u002F\u002Fpic1.zhimg.com\u002Fv2-9b427e4a25e3e6ee7bdc46c51275ad38_b.png\"\u002F\u003E\u003C\u002Ffigure\u003E\u003Cp\u003E前面说到，线性模型前面的系数表征了自变量对于因变量的因果关系，一个线性模型要能使用 OLS 估计系数需要满足 exogeneity 的要求。现在假设其中某一个变量不满足该要求，即\u003C\u002Fp\u003E\u003Cp\u003E\u003Cimg src=\"https:\u002F\u002Fwww.zhihu.com\u002Fequation?tex=%5Cmathbb%7BE%7D%5Bu%5D+%3D+0%2C+Cov%28x_j%2C+u%29+%3D+0%2C+j+%5Cin%5BK-1%5D%2C+Cov%28x_K%2C+y%29+%5Cneq+0\" alt=\"\\mathbb{E}[u] = 0, Cov(x_j, u) = 0, j \\in[K-1], Cov(x_K, y) \\neq 0\" eeimg=\"1\"\u002F\u003E \u003C\u002Fp\u003E\u003Cp\u003E这时，我们引入 instrumental variable 方法来解决内生性问题，并且为 \u003Cimg src=\"https:\u002F\u002Fwww.zhihu.com\u002Fequation?tex=%5Cbeta_j\" alt=\"\\beta_j\" eeimg=\"1\"\u002F\u003E 的提供一致性估计。\u003C\u002Fp\u003E\u003Cp\u003E一个 instrumental variable \u003Cimg src=\"https:\u002F\u002Fwww.zhihu.com\u002Fequation?tex=z_1\" alt=\"z_1\" eeimg=\"1\"\u002F\u003E 需要满足的性质（和它与 proxy variable 的对比，一块放上来）\u003C\u002Fp\u003E\u003Cfigure data-size=\"normal\"\u003E\u003Cnoscript\u003E\u003Cimg src=\"https:\u002F\u002Fpic4.zhimg.com\u002Fv2-14c34d0da8b5edcd53d6d82342aaa47f_b.jpg\" data-size=\"normal\" data-rawwidth=\"1330\" data-rawheight=\"617\" class=\"origin_image zh-lightbox-thumb\" width=\"1330\" data-original=\"https:\u002F\u002Fpic4.zhimg.com\u002Fv2-14c34d0da8b5edcd53d6d82342aaa47f_r.jpg\"\u002F\u003E\u003C\u002Fnoscript\u003E\u003Cimg src=\"data:image\u002Fsvg+xml;utf8,&lt;svg xmlns=&#39;http:\u002F\u002Fwww.w3.org\u002F2000\u002Fsvg&#39; width=&#39;1330&#39; height=&#39;617&#39;&gt;&lt;\u002Fsvg&gt;\" data-size=\"normal\" data-rawwidth=\"1330\" data-rawheight=\"617\" class=\"origin_image zh-lightbox-thumb lazy\" width=\"1330\" data-original=\"https:\u002F\u002Fpic4.zhimg.com\u002Fv2-14c34d0da8b5edcd53d6d82342aaa47f_r.jpg\" data-actualsrc=\"https:\u002F\u002Fpic4.zhimg.com\u002Fv2-14c34d0da8b5edcd53d6d82342aaa47f_b.jpg\"\u002F\u003E\u003Cfigcaption\u003Evalidity condition and relevance condition （图中写错了）\u003C\u002Ffigcaption\u003E\u003C\u002Ffigure\u003E\u003Cp\u003E第一项的要求应该两个是等价的，即额外选择的这个变量不能成为解释变量进入原来的方程中。最主要的区别在第二个要求上，proxy variable 要求找到的变量能够解释所有 q 和其他 解释变量的关联（即，q 剔除掉 z 的影响之后，r 和其他解释变量无关）；而 instrumental variable 则希望找到一个和其他变量都没啥关系，但是只和 \u003Cimg src=\"https:\u002F\u002Fwww.zhihu.com\u002Fequation?tex=x_K\" alt=\"x_K\" eeimg=\"1\"\u002F\u003E 有一点关联的变量。\u003C\u002Fp\u003E\u003Cp\u003E\u003Ca href=\"https:\u002F\u002Flink.zhihu.com\u002F?target=https%3A\u002F\u002Fstats.stackexchange.com\u002Fquestions\u002F13582\u002Fproxy-variables-versus-instrumental-variables\" class=\" wrap external\" target=\"_blank\" rel=\"nofollow noreferrer\"\u003E论坛 (StackExchange)\u003C\u002Fa\u003E上说：instrumental variable 的目的是想找因果关系，减小 estimation error 产生的影响，对于它来说， \u003Cimg src=\"https:\u002F\u002Fwww.zhihu.com\u002Fequation?tex=x_K\" alt=\"x_K\" eeimg=\"1\"\u002F\u003E 能观察到，但是可能有偏差，因此要找一个只影响 \u003Cimg src=\"https:\u002F\u002Fwww.zhihu.com\u002Fequation?tex=x_K\" alt=\"x_K\" eeimg=\"1\"\u002F\u003E 的变量来抵消相应的估计误差；proxy variable 是想想办法把原来的线性模型系数估计处理，其中的变量 q 观察不到，想要找一个和它接近的变量来替换它。\u003C\u002Fp\u003E\u003Ch3\u003E二、instrumental variable estimator\u003C\u002Fh3\u003E\u003Cp\u003E令\u003C\u002Fp\u003E\u003Cfigure data-size=\"normal\"\u003E\u003Cnoscript\u003E\u003Cimg src=\"https:\u002F\u002Fpic2.zhimg.com\u002Fv2-1bfb02e3b11d561433d087d239601b6d_b.png\" data-caption=\"\" data-size=\"normal\" data-rawwidth=\"1880\" data-rawheight=\"258\" class=\"origin_image zh-lightbox-thumb\" width=\"1880\" data-original=\"https:\u002F\u002Fpic2.zhimg.com\u002Fv2-1bfb02e3b11d561433d087d239601b6d_r.jpg\"\u002F\u003E\u003C\u002Fnoscript\u003E\u003Cimg src=\"data:image\u002Fsvg+xml;utf8,&lt;svg xmlns=&#39;http:\u002F\u002Fwww.w3.org\u002F2000\u002Fsvg&#39; width=&#39;1880&#39; height=&#39;258&#39;&gt;&lt;\u002Fsvg&gt;\" data-caption=\"\" data-size=\"normal\" data-rawwidth=\"1880\" data-rawheight=\"258\" class=\"origin_image zh-lightbox-thumb lazy\" width=\"1880\" data-original=\"https:\u002F\u002Fpic2.zhimg.com\u002Fv2-1bfb02e3b11d561433d087d239601b6d_r.jpg\" data-actualsrc=\"https:\u002F\u002Fpic2.zhimg.com\u002Fv2-1bfb02e3b11d561433d087d239601b6d_b.png\"\u002F\u003E\u003C\u002Ffigure\u003E\u003Cp\u003E假设样本数目为 N，那么它们都是 NxK 的矩阵。\u003C\u002Fp\u003E\u003Cp\u003E方程可以写为\u003C\u002Fp\u003E\u003Cfigure data-size=\"normal\"\u003E\u003Cnoscript\u003E\u003Cimg src=\"https:\u002F\u002Fpic2.zhimg.com\u002Fv2-40cdbee7ab01a79ff61c001bf2336469_b.png\" data-caption=\"\" data-size=\"normal\" data-rawwidth=\"1906\" data-rawheight=\"138\" class=\"origin_image zh-lightbox-thumb\" width=\"1906\" data-original=\"https:\u002F\u002Fpic2.zhimg.com\u002Fv2-40cdbee7ab01a79ff61c001bf2336469_r.jpg\"\u002F\u003E\u003C\u002Fnoscript\u003E\u003Cimg src=\"data:image\u002Fsvg+xml;utf8,&lt;svg xmlns=&#39;http:\u002F\u002Fwww.w3.org\u002F2000\u002Fsvg&#39; width=&#39;1906&#39; height=&#39;138&#39;&gt;&lt;\u002Fsvg&gt;\" data-caption=\"\" data-size=\"normal\" data-rawwidth=\"1906\" data-rawheight=\"138\" class=\"origin_image zh-lightbox-thumb lazy\" width=\"1906\" data-original=\"https:\u002F\u002Fpic2.zhimg.com\u002Fv2-40cdbee7ab01a79ff61c001bf2336469_r.jpg\" data-actualsrc=\"https:\u002F\u002Fpic2.zhimg.com\u002Fv2-40cdbee7ab01a79ff61c001bf2336469_b.png\"\u002F\u003E\u003C\u002Ffigure\u003E\u003Cp\u003E其中 y 和 u 都是 Nx1 的向量， \u003Cimg src=\"https:\u002F\u002Fwww.zhihu.com\u002Fequation?tex=%5Cbeta\" alt=\"\\beta\" eeimg=\"1\"\u002F\u003E 是 Kx1 的向量。\u003C\u002Fp\u003E\u003Cp\u003E根据前面的条件，有\u003C\u002Fp\u003E\u003Cfigure data-size=\"normal\"\u003E\u003Cnoscript\u003E\u003Cimg src=\"https:\u002F\u002Fpic1.zhimg.com\u002Fv2-e368634ceb65f70b34c058bc303bd5fc_b.png\" data-caption=\"\" data-size=\"normal\" data-rawwidth=\"1886\" data-rawheight=\"128\" class=\"origin_image zh-lightbox-thumb\" width=\"1886\" data-original=\"https:\u002F\u002Fpic1.zhimg.com\u002Fv2-e368634ceb65f70b34c058bc303bd5fc_r.jpg\"\u002F\u003E\u003C\u002Fnoscript\u003E\u003Cimg src=\"data:image\u002Fsvg+xml;utf8,&lt;svg xmlns=&#39;http:\u002F\u002Fwww.w3.org\u002F2000\u002Fsvg&#39; width=&#39;1886&#39; height=&#39;128&#39;&gt;&lt;\u002Fsvg&gt;\" data-caption=\"\" data-size=\"normal\" data-rawwidth=\"1886\" data-rawheight=\"128\" class=\"origin_image zh-lightbox-thumb lazy\" width=\"1886\" data-original=\"https:\u002F\u002Fpic1.zhimg.com\u002Fv2-e368634ceb65f70b34c058bc303bd5fc_r.jpg\" data-actualsrc=\"https:\u002F\u002Fpic1.zhimg.com\u002Fv2-e368634ceb65f70b34c058bc303bd5fc_b.png\"\u002F\u003E\u003C\u002Ffigure\u003E\u003Cp\u003E不难推得\u003C\u002Fp\u003E\u003Cfigure data-size=\"normal\"\u003E\u003Cnoscript\u003E\u003Cimg src=\"https:\u002F\u002Fpic3.zhimg.com\u002Fv2-ac87783102596132b40443e56973da5a_b.png\" data-caption=\"\" data-size=\"normal\" data-rawwidth=\"1884\" data-rawheight=\"212\" class=\"origin_image zh-lightbox-thumb\" width=\"1884\" data-original=\"https:\u002F\u002Fpic3.zhimg.com\u002Fv2-ac87783102596132b40443e56973da5a_r.jpg\"\u002F\u003E\u003C\u002Fnoscript\u003E\u003Cimg src=\"data:image\u002Fsvg+xml;utf8,&lt;svg xmlns=&#39;http:\u002F\u002Fwww.w3.org\u002F2000\u002Fsvg&#39; width=&#39;1884&#39; height=&#39;212&#39;&gt;&lt;\u002Fsvg&gt;\" data-caption=\"\" data-size=\"normal\" data-rawwidth=\"1884\" data-rawheight=\"212\" class=\"origin_image zh-lightbox-thumb lazy\" width=\"1884\" data-original=\"https:\u002F\u002Fpic3.zhimg.com\u002Fv2-ac87783102596132b40443e56973da5a_r.jpg\" data-actualsrc=\"https:\u002F\u002Fpic3.zhimg.com\u002Fv2-ac87783102596132b40443e56973da5a_b.png\"\u002F\u003E\u003C\u002Ffigure\u003E\u003Cp\u003E由于 \u003Cimg src=\"https:\u002F\u002Fwww.zhihu.com\u002Fequation?tex=%5Ctheta_1+%5Cneq+0\" alt=\"\\theta_1 \\neq 0\" eeimg=\"1\"\u002F\u003E ，即 \u003Cimg src=\"https:\u002F\u002Fwww.zhihu.com\u002Fequation?tex=x_K%2C+z_1\" alt=\"x_K, z_1\" eeimg=\"1\"\u002F\u003E 相互关联，因此\u003C\u002Fp\u003E\u003Cfigure data-size=\"normal\"\u003E\u003Cnoscript\u003E\u003Cimg src=\"https:\u002F\u002Fpic3.zhimg.com\u002Fv2-ffd7f8b912a99ab1d48d1eb7453ce472_b.png\" data-caption=\"\" data-size=\"normal\" data-rawwidth=\"1878\" data-rawheight=\"122\" class=\"origin_image zh-lightbox-thumb\" width=\"1878\" data-original=\"https:\u002F\u002Fpic3.zhimg.com\u002Fv2-ffd7f8b912a99ab1d48d1eb7453ce472_r.jpg\"\u002F\u003E\u003C\u002Fnoscript\u003E\u003Cimg src=\"data:image\u002Fsvg+xml;utf8,&lt;svg xmlns=&#39;http:\u002F\u002Fwww.w3.org\u002F2000\u002Fsvg&#39; width=&#39;1878&#39; height=&#39;122&#39;&gt;&lt;\u002Fsvg&gt;\" data-caption=\"\" data-size=\"normal\" data-rawwidth=\"1878\" data-rawheight=\"122\" class=\"origin_image zh-lightbox-thumb lazy\" width=\"1878\" data-original=\"https:\u002F\u002Fpic3.zhimg.com\u002Fv2-ffd7f8b912a99ab1d48d1eb7453ce472_r.jpg\" data-actualsrc=\"https:\u002F\u002Fpic3.zhimg.com\u002Fv2-ffd7f8b912a99ab1d48d1eb7453ce472_b.png\"\u002F\u003E\u003C\u002Ffigure\u003E\u003Cp\u003E这样我们可以对其求逆，解出系数\u003C\u002Fp\u003E\u003Cfigure data-size=\"normal\"\u003E\u003Cnoscript\u003E\u003Cimg src=\"https:\u002F\u002Fpic2.zhimg.com\u002Fv2-87b12b1f05cf629a1b5420bed499d55d_b.png\" data-caption=\"\" data-size=\"normal\" data-rawwidth=\"1932\" data-rawheight=\"110\" class=\"origin_image zh-lightbox-thumb\" width=\"1932\" data-original=\"https:\u002F\u002Fpic2.zhimg.com\u002Fv2-87b12b1f05cf629a1b5420bed499d55d_r.jpg\"\u002F\u003E\u003C\u002Fnoscript\u003E\u003Cimg src=\"data:image\u002Fsvg+xml;utf8,&lt;svg xmlns=&#39;http:\u002F\u002Fwww.w3.org\u002F2000\u002Fsvg&#39; width=&#39;1932&#39; height=&#39;110&#39;&gt;&lt;\u002Fsvg&gt;\" data-caption=\"\" data-size=\"normal\" data-rawwidth=\"1932\" data-rawheight=\"110\" class=\"origin_image zh-lightbox-thumb lazy\" width=\"1932\" data-original=\"https:\u002F\u002Fpic2.zhimg.com\u002Fv2-87b12b1f05cf629a1b5420bed499d55d_r.jpg\" data-actualsrc=\"https:\u002F\u002Fpic2.zhimg.com\u002Fv2-87b12b1f05cf629a1b5420bed499d55d_b.png\"\u002F\u003E\u003C\u002Ffigure\u003E\u003Cp\u003E系数的估计公式为\u003C\u002Fp\u003E\u003Cfigure data-size=\"normal\"\u003E\u003Cnoscript\u003E\u003Cimg src=\"https:\u002F\u002Fpic1.zhimg.com\u002Fv2-bba3f3e626e0a862f4008cc9c4b7ff40_b.png\" data-caption=\"\" data-size=\"normal\" data-rawwidth=\"1838\" data-rawheight=\"102\" class=\"origin_image zh-lightbox-thumb\" width=\"1838\" data-original=\"https:\u002F\u002Fpic1.zhimg.com\u002Fv2-bba3f3e626e0a862f4008cc9c4b7ff40_r.jpg\"\u002F\u003E\u003C\u002Fnoscript\u003E\u003Cimg src=\"data:image\u002Fsvg+xml;utf8,&lt;svg xmlns=&#39;http:\u002F\u002Fwww.w3.org\u002F2000\u002Fsvg&#39; width=&#39;1838&#39; height=&#39;102&#39;&gt;&lt;\u002Fsvg&gt;\" data-caption=\"\" data-size=\"normal\" data-rawwidth=\"1838\" data-rawheight=\"102\" class=\"origin_image zh-lightbox-thumb lazy\" width=\"1838\" data-original=\"https:\u002F\u002Fpic1.zhimg.com\u002Fv2-bba3f3e626e0a862f4008cc9c4b7ff40_r.jpg\" data-actualsrc=\"https:\u002F\u002Fpic1.zhimg.com\u002Fv2-bba3f3e626e0a862f4008cc9c4b7ff40_b.png\"\u002F\u003E\u003C\u002Ffigure\u003E\u003Cp\u003E称它为 \u003Cb\u003Einstrumental variable estimator\u003C\u002Fb\u003E。\u003C\u002Fp\u003E\u003Cp\u003E可以验证，它为一致性估计\u003C\u002Fp\u003E\u003Cfigure data-size=\"normal\"\u003E\u003Cnoscript\u003E\u003Cimg src=\"https:\u002F\u002Fpic3.zhimg.com\u002Fv2-fd555bbae6c734670f012834f292199e_b.jpg\" data-caption=\"\" data-size=\"normal\" data-rawwidth=\"1866\" data-rawheight=\"710\" class=\"origin_image zh-lightbox-thumb\" width=\"1866\" data-original=\"https:\u002F\u002Fpic3.zhimg.com\u002Fv2-fd555bbae6c734670f012834f292199e_r.jpg\"\u002F\u003E\u003C\u002Fnoscript\u003E\u003Cimg src=\"data:image\u002Fsvg+xml;utf8,&lt;svg xmlns=&#39;http:\u002F\u002Fwww.w3.org\u002F2000\u002Fsvg&#39; width=&#39;1866&#39; height=&#39;710&#39;&gt;&lt;\u002Fsvg&gt;\" data-caption=\"\" data-size=\"normal\" data-rawwidth=\"1866\" data-rawheight=\"710\" class=\"origin_image zh-lightbox-thumb lazy\" width=\"1866\" data-original=\"https:\u002F\u002Fpic3.zhimg.com\u002Fv2-fd555bbae6c734670f012834f292199e_r.jpg\" data-actualsrc=\"https:\u002F\u002Fpic3.zhimg.com\u002Fv2-fd555bbae6c734670f012834f292199e_b.jpg\"\u002F\u003E\u003C\u002Ffigure\u003E\u003Ch3\u003E三、Two-Stage Least Squares\u003C\u002Fh3\u003E\u003Cp\u003E前面只使用一个 Instrumental variable，也可以使用多个 Instrumental variable；对于多个 instrumental variable 的情形，这里使用 two-stage least square （2SLS）方法来解决。\u003C\u002Fp\u003E\u003Cp\u003E\u003Cb\u003E\u003Ci\u003EInstrumental variable 的要求\u003C\u002Fi\u003E\u003C\u002Fb\u003E\u003C\u002Fp\u003E\u003Cp\u003E对于多个 instrumental variable，前面对于 instrumental variable 的两个要求（validity、relevance）可以写为\u003C\u002Fp\u003E\u003Cfigure data-size=\"normal\"\u003E\u003Cnoscript\u003E\u003Cimg src=\"https:\u002F\u002Fpic2.zhimg.com\u002Fv2-aa8da6d220af65e34b93873ac9611805_b.png\" data-caption=\"\" data-size=\"normal\" data-rawwidth=\"1377\" data-rawheight=\"172\" class=\"origin_image zh-lightbox-thumb\" width=\"1377\" data-original=\"https:\u002F\u002Fpic2.zhimg.com\u002Fv2-aa8da6d220af65e34b93873ac9611805_r.jpg\"\u002F\u003E\u003C\u002Fnoscript\u003E\u003Cimg src=\"data:image\u002Fsvg+xml;utf8,&lt;svg xmlns=&#39;http:\u002F\u002Fwww.w3.org\u002F2000\u002Fsvg&#39; width=&#39;1377&#39; height=&#39;172&#39;&gt;&lt;\u002Fsvg&gt;\" data-caption=\"\" data-size=\"normal\" data-rawwidth=\"1377\" data-rawheight=\"172\" class=\"origin_image zh-lightbox-thumb lazy\" width=\"1377\" data-original=\"https:\u002F\u002Fpic2.zhimg.com\u002Fv2-aa8da6d220af65e34b93873ac9611805_r.jpg\" data-actualsrc=\"https:\u002F\u002Fpic2.zhimg.com\u002Fv2-aa8da6d220af65e34b93873ac9611805_b.png\"\u002F\u003E\u003C\u002Ffigure\u003E\u003Cp\u003E其中 z 的维度为 1xL，它包含所有 exogenous explanatory variables；同时要求 \u003Cimg src=\"https:\u002F\u002Fwww.zhihu.com\u002Fequation?tex=%5Ctext%7Brank%7D%28z%27z%29%3DL\" alt=\"\\text{rank}(z&#39;z)=L\" eeimg=\"1\"\u002F\u003E ，即 z 中的各个元素之间没有共线性（collinearity）。K 表示 explanatory variable 的个数。\u003C\u002Fp\u003E\u003Cp\u003E具体来说，它首先要求  instrumental variable 的数目要至少和 endogenous explanatory variable 的数目一样多；同时 instrumental variable 和 endogenous variable 之间要有比较好的对应关系。比如对于 \u003Cimg src=\"https:\u002F\u002Fwww.zhihu.com\u002Fequation?tex=x_3%2C+x_4\" alt=\"x_3, x_4\" eeimg=\"1\"\u002F\u003E 两个 endogenous variable 和 \u003Cimg src=\"https:\u002F\u002Fwww.zhihu.com\u002Fequation?tex=z_1%2C+z_2\" alt=\"z_1, z_2\" eeimg=\"1\"\u002F\u003E 两个 instrumental variable\u003C\u002Fp\u003E\u003Cfigure data-size=\"normal\"\u003E\u003Cnoscript\u003E\u003Cimg src=\"https:\u002F\u002Fpic1.zhimg.com\u002Fv2-a74d5c631bb8745523ad6f475b434f20_b.png\" data-caption=\"\" data-size=\"normal\" data-rawwidth=\"1470\" data-rawheight=\"188\" class=\"origin_image zh-lightbox-thumb\" width=\"1470\" data-original=\"https:\u002F\u002Fpic1.zhimg.com\u002Fv2-a74d5c631bb8745523ad6f475b434f20_r.jpg\"\u002F\u003E\u003C\u002Fnoscript\u003E\u003Cimg src=\"data:image\u002Fsvg+xml;utf8,&lt;svg xmlns=&#39;http:\u002F\u002Fwww.w3.org\u002F2000\u002Fsvg&#39; width=&#39;1470&#39; height=&#39;188&#39;&gt;&lt;\u002Fsvg&gt;\" data-caption=\"\" data-size=\"normal\" data-rawwidth=\"1470\" data-rawheight=\"188\" class=\"origin_image zh-lightbox-thumb lazy\" width=\"1470\" data-original=\"https:\u002F\u002Fpic1.zhimg.com\u002Fv2-a74d5c631bb8745523ad6f475b434f20_r.jpg\" data-actualsrc=\"https:\u002F\u002Fpic1.zhimg.com\u002Fv2-a74d5c631bb8745523ad6f475b434f20_b.png\"\u002F\u003E\u003C\u002Ffigure\u003E\u003Cp\u003E如果 \u003Cimg src=\"https:\u002F\u002Fwww.zhihu.com\u002Fequation?tex=%5Cpi_3%3D%5Cgamma_3%3D0%2C+%5Cpi_4+%5Cneq+0%2C+%5Cgamma_4+%5Cneq+0\" alt=\"\\pi_3=\\gamma_3=0, \\pi_4 \\neq 0, \\gamma_4 \\neq 0\" eeimg=\"1\"\u002F\u003E 就不行，因为 \u003Cimg src=\"https:\u002F\u002Fwww.zhihu.com\u002Fequation?tex=z_1\" alt=\"z_1\" eeimg=\"1\"\u002F\u003E 与 \u003Cimg src=\"https:\u002F\u002Fwww.zhihu.com\u002Fequation?tex=x_3%2C+x_4\" alt=\"x_3, x_4\" eeimg=\"1\"\u002F\u003E 都不相关了。\u003C\u002Fp\u003E\u003Cp\u003E\u003Cb\u003E\u003Ci\u003E2SLS 方法\u003C\u002Fi\u003E\u003C\u002Fb\u003E\u003C\u002Fp\u003E\u003Cp\u003E考虑一个线性模型\u003C\u002Fp\u003E\u003Cfigure data-size=\"normal\"\u003E\u003Cnoscript\u003E\u003Cimg src=\"https:\u002F\u002Fpic2.zhimg.com\u002Fv2-4e355fc4c1e2826d64cc6f302e4f37e1_b.png\" data-caption=\"\" data-size=\"normal\" data-rawwidth=\"1364\" data-rawheight=\"92\" class=\"origin_image zh-lightbox-thumb\" width=\"1364\" data-original=\"https:\u002F\u002Fpic2.zhimg.com\u002Fv2-4e355fc4c1e2826d64cc6f302e4f37e1_r.jpg\"\u002F\u003E\u003C\u002Fnoscript\u003E\u003Cimg src=\"data:image\u002Fsvg+xml;utf8,&lt;svg xmlns=&#39;http:\u002F\u002Fwww.w3.org\u002F2000\u002Fsvg&#39; width=&#39;1364&#39; height=&#39;92&#39;&gt;&lt;\u002Fsvg&gt;\" data-caption=\"\" data-size=\"normal\" data-rawwidth=\"1364\" data-rawheight=\"92\" class=\"origin_image zh-lightbox-thumb lazy\" width=\"1364\" data-original=\"https:\u002F\u002Fpic2.zhimg.com\u002Fv2-4e355fc4c1e2826d64cc6f302e4f37e1_r.jpg\" data-actualsrc=\"https:\u002F\u002Fpic2.zhimg.com\u002Fv2-4e355fc4c1e2826d64cc6f302e4f37e1_b.png\"\u002F\u003E\u003C\u002Ffigure\u003E\u003Cp\u003E其中 \u003Cimg src=\"https:\u002F\u002Fwww.zhihu.com\u002Fequation?tex=x_1%2C+%5Ccdots%2C+x_k\" alt=\"x_1, \\cdots, x_k\" eeimg=\"1\"\u002F\u003E 为 exogenous variables， \u003Cimg src=\"https:\u002F\u002Fwww.zhihu.com\u002Fequation?tex=y_2\" alt=\"y_2\" eeimg=\"1\"\u002F\u003E 为 endogenous variable。令 \u003Cimg src=\"https:\u002F\u002Fwww.zhihu.com\u002Fequation?tex=%7B%5Cbf+z%7D+%3D+%281%2C+x_1%2C+%5Ccdots%2C+x_k%2C+z_1%2C+%5Ccdots%2C+z_m%29\" alt=\"{\\bf z} = (1, x_1, \\cdots, x_k, z_1, \\cdots, z_m)\" eeimg=\"1\"\u002F\u003E ，其中最后 m 个元素为 m 个 Instrumental variables。 \u003Cimg src=\"https:\u002F\u002Fwww.zhihu.com\u002Fequation?tex=y_2\" alt=\"y_2\" eeimg=\"1\"\u002F\u003E 可以被写作\u003C\u002Fp\u003E\u003Cfigure data-size=\"normal\"\u003E\u003Cnoscript\u003E\u003Cimg src=\"https:\u002F\u002Fpic2.zhimg.com\u002Fv2-63511a3130bffe0414400140848a5a7d_b.png\" data-caption=\"\" data-size=\"normal\" data-rawwidth=\"1345\" data-rawheight=\"119\" class=\"origin_image zh-lightbox-thumb\" width=\"1345\" data-original=\"https:\u002F\u002Fpic2.zhimg.com\u002Fv2-63511a3130bffe0414400140848a5a7d_r.jpg\"\u002F\u003E\u003C\u002Fnoscript\u003E\u003Cimg src=\"data:image\u002Fsvg+xml;utf8,&lt;svg xmlns=&#39;http:\u002F\u002Fwww.w3.org\u002F2000\u002Fsvg&#39; width=&#39;1345&#39; height=&#39;119&#39;&gt;&lt;\u002Fsvg&gt;\" data-caption=\"\" data-size=\"normal\" data-rawwidth=\"1345\" data-rawheight=\"119\" class=\"origin_image zh-lightbox-thumb lazy\" width=\"1345\" data-original=\"https:\u002F\u002Fpic2.zhimg.com\u002Fv2-63511a3130bffe0414400140848a5a7d_r.jpg\" data-actualsrc=\"https:\u002F\u002Fpic2.zhimg.com\u002Fv2-63511a3130bffe0414400140848a5a7d_b.png\"\u002F\u003E\u003C\u002Ffigure\u003E\u003Cp\u003E可以看出 \u003Cimg src=\"https:\u002F\u002Fwww.zhihu.com\u002Fequation?tex=cov%28y_2%2C+u%29+%3D+cov%28%5Cvarepsilon%2C+u%29%5Cneq+0%2C+cov%28%5Chat+y_2%2C+u%29%3D0\" alt=\"cov(y_2, u) = cov(\\varepsilon, u)\\neq 0, cov(\\hat y_2, u)=0\" eeimg=\"1\"\u002F\u003E ，即可以用 \u003Cimg src=\"https:\u002F\u002Fwww.zhihu.com\u002Fequation?tex=%5Chat+y_2\" alt=\"\\hat y_2\" eeimg=\"1\"\u002F\u003E 代替 \u003Cimg src=\"https:\u002F\u002Fwww.zhihu.com\u002Fequation?tex=y_2\" alt=\"y_2\" eeimg=\"1\"\u002F\u003E 用于线性回归中然后再用 OLS 估计系数 \u003Cimg src=\"https:\u002F\u002Fwww.zhihu.com\u002Fequation?tex=%5Calpha_1%2C+%5Cbeta_%7B0%3Ak%7D\" alt=\"\\alpha_1, \\beta_{0:k}\" eeimg=\"1\"\u002F\u003E 。\u003C\u002Fp\u003E\u003Cp\u003E\u003Cimg src=\"https:\u002F\u002Fwww.zhihu.com\u002Fequation?tex=y_2\" alt=\"y_2\" eeimg=\"1\"\u002F\u003E 对 \u003Cimg src=\"https:\u002F\u002Fwww.zhihu.com\u002Fequation?tex=%7B%5Cbf+z%7D+%3D+%281%2C+x_1%2C+%5Ccdots%2C+x_k%2C+z_1%2C+%5Ccdots%2C+z_m%29\" alt=\"{\\bf z} = (1, x_1, \\cdots, x_k, z_1, \\cdots, z_m)\" eeimg=\"1\"\u002F\u003E 做回归，可以得到其预测值\u003C\u002Fp\u003E\u003Cfigure data-size=\"normal\"\u003E\u003Cnoscript\u003E\u003Cimg src=\"https:\u002F\u002Fpic4.zhimg.com\u002Fv2-2ef5ac5a34d6ad3ae9e0c2b66fd6008f_b.png\" data-caption=\"\" data-size=\"normal\" data-rawwidth=\"1354\" data-rawheight=\"87\" class=\"origin_image zh-lightbox-thumb\" width=\"1354\" data-original=\"https:\u002F\u002Fpic4.zhimg.com\u002Fv2-2ef5ac5a34d6ad3ae9e0c2b66fd6008f_r.jpg\"\u002F\u003E\u003C\u002Fnoscript\u003E\u003Cimg src=\"data:image\u002Fsvg+xml;utf8,&lt;svg xmlns=&#39;http:\u002F\u002Fwww.w3.org\u002F2000\u002Fsvg&#39; width=&#39;1354&#39; height=&#39;87&#39;&gt;&lt;\u002Fsvg&gt;\" data-caption=\"\" data-size=\"normal\" data-rawwidth=\"1354\" data-rawheight=\"87\" class=\"origin_image zh-lightbox-thumb lazy\" width=\"1354\" data-original=\"https:\u002F\u002Fpic4.zhimg.com\u002Fv2-2ef5ac5a34d6ad3ae9e0c2b66fd6008f_r.jpg\" data-actualsrc=\"https:\u002F\u002Fpic4.zhimg.com\u002Fv2-2ef5ac5a34d6ad3ae9e0c2b66fd6008f_b.png\"\u002F\u003E\u003C\u002Ffigure\u003E\u003Cp\u003E这样的做法等价于一个 Nx(k+1) 的矩阵 \u003Cimg src=\"https:\u002F\u002Fwww.zhihu.com\u002Fequation?tex=X%3D%28y_2%2C+x_1%2C+%5Ccdots%2C+x_k%29\" alt=\"X=(y_2, x_1, \\cdots, x_k)\" eeimg=\"1\"\u002F\u003E  对 \u003Cimg src=\"https:\u002F\u002Fwww.zhihu.com\u002Fequation?tex=%7B%5Cbf+z%7D+%3D+%281%2C+x_1%2C+%5Ccdots%2C+x_k%2C+z_1%2C+%5Ccdots%2C+z_m%29\" alt=\"{\\bf z} = (1, x_1, \\cdots, x_k, z_1, \\cdots, z_m)\" eeimg=\"1\"\u002F\u003E 做回归，其预测值为\u003C\u002Fp\u003E\u003Cfigure data-size=\"normal\"\u003E\u003Cnoscript\u003E\u003Cimg src=\"https:\u002F\u002Fpic1.zhimg.com\u002Fv2-61a040e8788bccb26e6134068e39c4d4_b.png\" data-caption=\"\" data-size=\"normal\" data-rawwidth=\"1342\" data-rawheight=\"83\" class=\"origin_image zh-lightbox-thumb\" width=\"1342\" data-original=\"https:\u002F\u002Fpic1.zhimg.com\u002Fv2-61a040e8788bccb26e6134068e39c4d4_r.jpg\"\u002F\u003E\u003C\u002Fnoscript\u003E\u003Cimg src=\"data:image\u002Fsvg+xml;utf8,&lt;svg xmlns=&#39;http:\u002F\u002Fwww.w3.org\u002F2000\u002Fsvg&#39; width=&#39;1342&#39; height=&#39;83&#39;&gt;&lt;\u002Fsvg&gt;\" data-caption=\"\" data-size=\"normal\" data-rawwidth=\"1342\" data-rawheight=\"83\" class=\"origin_image zh-lightbox-thumb lazy\" width=\"1342\" data-original=\"https:\u002F\u002Fpic1.zhimg.com\u002Fv2-61a040e8788bccb26e6134068e39c4d4_r.jpg\" data-actualsrc=\"https:\u002F\u002Fpic1.zhimg.com\u002Fv2-61a040e8788bccb26e6134068e39c4d4_b.png\"\u002F\u003E\u003C\u002Ffigure\u003E\u003Cp\u003E其中 \u003Cimg src=\"https:\u002F\u002Fwww.zhihu.com\u002Fequation?tex=%5Chat+%5CPi\" alt=\"\\hat \\Pi\" eeimg=\"1\"\u002F\u003E 为一个 (k+m+1)x(k+1) 的矩阵，其看起来为\u003C\u002Fp\u003E\u003Cfigure data-size=\"normal\"\u003E\u003Cnoscript\u003E\u003Cimg src=\"https:\u002F\u002Fpic3.zhimg.com\u002Fv2-a6f77410537c63a3b1a85daa2eedaaba_b.jpg\" data-caption=\"\" data-size=\"normal\" data-rawwidth=\"1300\" data-rawheight=\"440\" class=\"origin_image zh-lightbox-thumb\" width=\"1300\" data-original=\"https:\u002F\u002Fpic3.zhimg.com\u002Fv2-a6f77410537c63a3b1a85daa2eedaaba_r.jpg\"\u002F\u003E\u003C\u002Fnoscript\u003E\u003Cimg src=\"data:image\u002Fsvg+xml;utf8,&lt;svg xmlns=&#39;http:\u002F\u002Fwww.w3.org\u002F2000\u002Fsvg&#39; width=&#39;1300&#39; height=&#39;440&#39;&gt;&lt;\u002Fsvg&gt;\" data-caption=\"\" data-size=\"normal\" data-rawwidth=\"1300\" data-rawheight=\"440\" class=\"origin_image zh-lightbox-thumb lazy\" width=\"1300\" data-original=\"https:\u002F\u002Fpic3.zhimg.com\u002Fv2-a6f77410537c63a3b1a85daa2eedaaba_r.jpg\" data-actualsrc=\"https:\u002F\u002Fpic3.zhimg.com\u002Fv2-a6f77410537c63a3b1a85daa2eedaaba_b.jpg\"\u002F\u003E\u003C\u002Ffigure\u003E\u003Cp\u003E即，其他的 \u003Cimg src=\"https:\u002F\u002Fwww.zhihu.com\u002Fequation?tex=x_1%2C+%5Ccdots%2C+x_k\" alt=\"x_1, \\cdots, x_k\" eeimg=\"1\"\u002F\u003E 还是原来的数值，只是把 \u003Cimg src=\"https:\u002F\u002Fwww.zhihu.com\u002Fequation?tex=y_2\" alt=\"y_2\" eeimg=\"1\"\u002F\u003E 换成了 \u003Cimg src=\"https:\u002F\u002Fwww.zhihu.com\u002Fequation?tex=%5Chat+y_2\" alt=\"\\hat y_2\" eeimg=\"1\"\u002F\u003E 。仿照 IV estimator\u003C\u002Fp\u003E\u003Cfigure data-size=\"normal\"\u003E\u003Cnoscript\u003E\u003Cimg src=\"https:\u002F\u002Fpic4.zhimg.com\u002Fv2-d9226119e31f9ff2a4ad24f6a226547f_b.png\" data-caption=\"\" data-size=\"normal\" data-rawwidth=\"1380\" data-rawheight=\"91\" class=\"origin_image zh-lightbox-thumb\" width=\"1380\" data-original=\"https:\u002F\u002Fpic4.zhimg.com\u002Fv2-d9226119e31f9ff2a4ad24f6a226547f_r.jpg\"\u002F\u003E\u003C\u002Fnoscript\u003E\u003Cimg src=\"data:image\u002Fsvg+xml;utf8,&lt;svg xmlns=&#39;http:\u002F\u002Fwww.w3.org\u002F2000\u002Fsvg&#39; width=&#39;1380&#39; height=&#39;91&#39;&gt;&lt;\u002Fsvg&gt;\" data-caption=\"\" data-size=\"normal\" data-rawwidth=\"1380\" data-rawheight=\"91\" class=\"origin_image zh-lightbox-thumb lazy\" width=\"1380\" data-original=\"https:\u002F\u002Fpic4.zhimg.com\u002Fv2-d9226119e31f9ff2a4ad24f6a226547f_r.jpg\" data-actualsrc=\"https:\u002F\u002Fpic4.zhimg.com\u002Fv2-d9226119e31f9ff2a4ad24f6a226547f_b.png\"\u002F\u003E\u003C\u002Ffigure\u003E\u003Cp\u003E把 \u003Cimg src=\"https:\u002F\u002Fwww.zhihu.com\u002Fequation?tex=Z\" alt=\"Z\" eeimg=\"1\"\u002F\u003E 替换文 \u003Cimg src=\"https:\u002F\u002Fwww.zhihu.com\u002Fequation?tex=%5Chat+X\" alt=\"\\hat X\" eeimg=\"1\"\u002F\u003E ，可以得到\u003C\u002Fp\u003E\u003Cfigure data-size=\"normal\"\u003E\u003Cnoscript\u003E\u003Cimg src=\"https:\u002F\u002Fpic2.zhimg.com\u002Fv2-92d752f2a38a45bc7ed373408d4b6f79_b.jpg\" data-caption=\"\" data-size=\"normal\" data-rawwidth=\"1328\" data-rawheight=\"286\" class=\"origin_image zh-lightbox-thumb\" width=\"1328\" data-original=\"https:\u002F\u002Fpic2.zhimg.com\u002Fv2-92d752f2a38a45bc7ed373408d4b6f79_r.jpg\"\u002F\u003E\u003C\u002Fnoscript\u003E\u003Cimg src=\"data:image\u002Fsvg+xml;utf8,&lt;svg xmlns=&#39;http:\u002F\u002Fwww.w3.org\u002F2000\u002Fsvg&#39; width=&#39;1328&#39; height=&#39;286&#39;&gt;&lt;\u002Fsvg&gt;\" data-caption=\"\" data-size=\"normal\" data-rawwidth=\"1328\" data-rawheight=\"286\" class=\"origin_image zh-lightbox-thumb lazy\" width=\"1328\" data-original=\"https:\u002F\u002Fpic2.zhimg.com\u002Fv2-92d752f2a38a45bc7ed373408d4b6f79_r.jpg\" data-actualsrc=\"https:\u002F\u002Fpic2.zhimg.com\u002Fv2-92d752f2a38a45bc7ed373408d4b6f79_b.jpg\"\u002F\u003E\u003C\u002Ffigure\u003E\u003Cp\u003E即，在估计的 variables \u003Cimg src=\"https:\u002F\u002Fwww.zhihu.com\u002Fequation?tex=%5Chat+X\" alt=\"\\hat X\" eeimg=\"1\"\u002F\u003E 上做 OLS 即可。\u003C\u002Fp\u003E\u003Ch3\u003E四、 一个例子\u003C\u002Fh3\u003E\u003Cp\u003EDeepIV 可以看做把上述 2SLS 方法推广到非线性模型。在讲这篇 paper 之前，先讲一个这篇 paper 提到的一个例子，用来理解 endogeneity。\u003C\u002Fp\u003E\u003Cfigure data-size=\"normal\"\u003E\u003Cnoscript\u003E\u003Cimg src=\"https:\u002F\u002Fpic3.zhimg.com\u002Fv2-37d32d817bf44ba2fb92696410d87ffa_b.jpg\" data-caption=\"\" data-size=\"normal\" data-rawwidth=\"1322\" data-rawheight=\"360\" class=\"origin_image zh-lightbox-thumb\" width=\"1322\" data-original=\"https:\u002F\u002Fpic3.zhimg.com\u002Fv2-37d32d817bf44ba2fb92696410d87ffa_r.jpg\"\u002F\u003E\u003C\u002Fnoscript\u003E\u003Cimg src=\"data:image\u002Fsvg+xml;utf8,&lt;svg xmlns=&#39;http:\u002F\u002Fwww.w3.org\u002F2000\u002Fsvg&#39; width=&#39;1322&#39; height=&#39;360&#39;&gt;&lt;\u002Fsvg&gt;\" data-caption=\"\" data-size=\"normal\" data-rawwidth=\"1322\" data-rawheight=\"360\" class=\"origin_image zh-lightbox-thumb lazy\" width=\"1322\" data-original=\"https:\u002F\u002Fpic3.zhimg.com\u002Fv2-37d32d817bf44ba2fb92696410d87ffa_r.jpg\" data-actualsrc=\"https:\u002F\u002Fpic3.zhimg.com\u002Fv2-37d32d817bf44ba2fb92696410d87ffa_b.jpg\"\u002F\u003E\u003C\u002Ffigure\u003E\u003Cp\u003E考虑研究航空公司票价（prince，p）和销量（sales，y）的影响，即当其他条件不变时，如果增加票价，销量会如何变化；这是在研究一个 causal effect。\u003C\u002Fp\u003E\u003Cp\u003E最好的方法就是随机化地做实验，比如随机对一些顾客，提高或者降低面向他们的票价；但是这样的实验不仅会对航空公司造成实际的经济损失（损失了潜在的客户或者减少了盈利），而且还客户还因为不公平的对待而对航空公司不满。\u003C\u002Fp\u003E\u003Cp\u003E因此，我们希望从历史数据里面来挖掘票价（P）和销量（Y）之间的因果关系。\u003C\u002Fp\u003E\u003Col\u003E\u003Cli\u003EConfounders：一个直接的方法就是把 Y 对 P 做回归，但是这样往往得出错误的结论。比如可能存在另外的因素，节假日（X），它不仅影响票价（P）也同时影响销量（Y），在节假日的时候航空公司定价高（P 大），同时人们出行需求也大，因此销量也高（Y 大）；这是在历史数据里面做回归，得出的结论就会使 Y 和 P 成正相关，这显然是错误的。\u003C\u002Fli\u003E\u003Cli\u003EUnobservable variables：有一种方法是把可以观察到的影响因素也放到回归方程里面，根据前面几个 post 的内容，如果能够把所有的因素都包含进来，那么也能够得出正确的结论。但是，有可能会有一些观察不到的作用因素（E），比如在某个地区召开某个会议，它会同时使得票价（P）和销量（Y）都变大。\u003C\u002Fli\u003E\u003Cli\u003EInstrumental variable（IV）：因此，最有效的办法就是找到一个 IV，使得它只影响票价（当然，它也可以通过 P 来影响 Y，但是不能直接影响 Y），而和其他因素（X、E）不相关。在这里，我们找到『燃油价格』这个因素来做为 IV，它上升时，航空公司基于成本考虑会上调票价，但是该因素和其他因素（比如是否节假日、是否在某个地区有会议）无关。需要注意的是，IV 的选取基本上基于人为的先验知识。\u003C\u002Fli\u003E\u003C\u002Fol\u003E\u003Cp\u003E五、问题设定\u003C\u002Fp\u003E\u003Cp\u003E符号和前面一致，我们想要探究的是 y 和 p 之间的关系，模型为\u003C\u002Fp\u003E\u003Cfigure data-size=\"normal\"\u003E\u003Cnoscript\u003E\u003Cimg src=\"https:\u002F\u002Fpic4.zhimg.com\u002Fv2-58944227f4307e0e57c3d4bf30e1fa1b_b.png\" data-caption=\"\" data-size=\"normal\" data-rawwidth=\"759\" data-rawheight=\"42\" class=\"origin_image zh-lightbox-thumb\" width=\"759\" data-original=\"https:\u002F\u002Fpic4.zhimg.com\u002Fv2-58944227f4307e0e57c3d4bf30e1fa1b_r.jpg\"\u002F\u003E\u003C\u002Fnoscript\u003E\u003Cimg src=\"data:image\u002Fsvg+xml;utf8,&lt;svg xmlns=&#39;http:\u002F\u002Fwww.w3.org\u002F2000\u002Fsvg&#39; width=&#39;759&#39; height=&#39;42&#39;&gt;&lt;\u002Fsvg&gt;\" data-caption=\"\" data-size=\"normal\" data-rawwidth=\"759\" data-rawheight=\"42\" class=\"origin_image zh-lightbox-thumb lazy\" width=\"759\" data-original=\"https:\u002F\u002Fpic4.zhimg.com\u002Fv2-58944227f4307e0e57c3d4bf30e1fa1b_r.jpg\" data-actualsrc=\"https:\u002F\u002Fpic4.zhimg.com\u002Fv2-58944227f4307e0e57c3d4bf30e1fa1b_b.png\"\u002F\u003E\u003C\u002Ffigure\u003E\u003Cp\u003E其中 \u003Cimg src=\"https:\u002F\u002Fwww.zhihu.com\u002Fequation?tex=%5Cmathbb%7BE%7D%5Be%5D+%3D+0\" alt=\"\\mathbb{E}[e] = 0\" eeimg=\"1\"\u002F\u003E ，认为变量 p 是 endogenous 的，即 \u003Cimg src=\"https:\u002F\u002Fwww.zhihu.com\u002Fequation?tex=%5Cmathbb%7BE%7D%5Be%7Cx%2Cp%5D+%5Cneq+0\" alt=\"\\mathbb{E}[e|x,p] \\neq 0\" eeimg=\"1\"\u002F\u003E ，或者 \u003Cimg src=\"https:\u002F\u002Fwww.zhihu.com\u002Fequation?tex=%5Cmathbb%7BE%7D%5Bpe%7Cx%5D+%5Cneq+0\" alt=\"\\mathbb{E}[pe|x] \\neq 0\" eeimg=\"1\"\u002F\u003E （是前面的一种特殊情况，相当于线性不相关）。\u003C\u002Fp\u003E\u003Cp\u003E定义一个 counterfactual prediction function\u003C\u002Fp\u003E\u003Cfigure data-size=\"normal\"\u003E\u003Cnoscript\u003E\u003Cimg src=\"https:\u002F\u002Fpic3.zhimg.com\u002Fv2-740dc5841ffaf02988a42ed05d93aeb6_b.png\" data-caption=\"\" data-size=\"normal\" data-rawwidth=\"1130\" data-rawheight=\"74\" class=\"origin_image zh-lightbox-thumb\" width=\"1130\" data-original=\"https:\u002F\u002Fpic3.zhimg.com\u002Fv2-740dc5841ffaf02988a42ed05d93aeb6_r.jpg\"\u002F\u003E\u003C\u002Fnoscript\u003E\u003Cimg src=\"data:image\u002Fsvg+xml;utf8,&lt;svg xmlns=&#39;http:\u002F\u002Fwww.w3.org\u002F2000\u002Fsvg&#39; width=&#39;1130&#39; height=&#39;74&#39;&gt;&lt;\u002Fsvg&gt;\" data-caption=\"\" data-size=\"normal\" data-rawwidth=\"1130\" data-rawheight=\"74\" class=\"origin_image zh-lightbox-thumb lazy\" width=\"1130\" data-original=\"https:\u002F\u002Fpic3.zhimg.com\u002Fv2-740dc5841ffaf02988a42ed05d93aeb6_r.jpg\" data-actualsrc=\"https:\u002F\u002Fpic3.zhimg.com\u002Fv2-740dc5841ffaf02988a42ed05d93aeb6_b.png\"\u002F\u003E\u003C\u002Ffigure\u003E\u003Cp\u003E注意到，要是 e 和 x 无关，而只与 p 有关，那么 h 函数和 g 函数一致。固定 x，希望知道如果把 \u003Cimg src=\"https:\u002F\u002Fwww.zhihu.com\u002Fequation?tex=p%3Dp_0\" alt=\"p=p_0\" eeimg=\"1\"\u002F\u003E 变动为 \u003Cimg src=\"https:\u002F\u002Fwww.zhihu.com\u002Fequation?tex=p%3Dp_1\" alt=\"p=p_1\" eeimg=\"1\"\u002F\u003E 时 y 会变化多少，这其实就是在求 \u003Cimg src=\"https:\u002F\u002Fwww.zhihu.com\u002Fequation?tex=g%28p_1%2Cx%29+-+g%28p_0%2Cx%29+%3D+h%28p_1%2Cx%29+-+h%28p_0%2Cx%29+\" alt=\"g(p_1,x) - g(p_0,x) = h(p_1,x) - h(p_0,x) \" eeimg=\"1\"\u002F\u003E 。\u003C\u002Fp\u003E\u003Cp\u003E这里再次强调一下，函数 \u003Cimg src=\"https:\u002F\u002Fwww.zhihu.com\u002Fequation?tex=h%28p%2Cx%29\" alt=\"h(p,x)\" eeimg=\"1\"\u002F\u003E 不能通过用 p, x 去拟合 y 来得到，因为拟合得到的函数实际上为 \u003Cimg src=\"https:\u002F\u002Fwww.zhihu.com\u002Fequation?tex=%5Cmathbb%7BE%7D%5By%7Cp%2Cx%5D\" alt=\"\\mathbb{E}[y|p,x]\" eeimg=\"1\"\u002F\u003E ，它们的差为\u003C\u002Fp\u003E\u003Cfigure data-size=\"normal\"\u003E\u003Cnoscript\u003E\u003Cimg src=\"https:\u002F\u002Fpic3.zhimg.com\u002Fv2-a5c4fcd22466cd31c161c822431e54d6_b.png\" data-caption=\"\" data-size=\"normal\" data-rawwidth=\"1268\" data-rawheight=\"148\" class=\"origin_image zh-lightbox-thumb\" width=\"1268\" data-original=\"https:\u002F\u002Fpic3.zhimg.com\u002Fv2-a5c4fcd22466cd31c161c822431e54d6_r.jpg\"\u002F\u003E\u003C\u002Fnoscript\u003E\u003Cimg src=\"data:image\u002Fsvg+xml;utf8,&lt;svg xmlns=&#39;http:\u002F\u002Fwww.w3.org\u002F2000\u002Fsvg&#39; width=&#39;1268&#39; height=&#39;148&#39;&gt;&lt;\u002Fsvg&gt;\" data-caption=\"\" data-size=\"normal\" data-rawwidth=\"1268\" data-rawheight=\"148\" class=\"origin_image zh-lightbox-thumb lazy\" width=\"1268\" data-original=\"https:\u002F\u002Fpic3.zhimg.com\u002Fv2-a5c4fcd22466cd31c161c822431e54d6_r.jpg\" data-actualsrc=\"https:\u002F\u002Fpic3.zhimg.com\u002Fv2-a5c4fcd22466cd31c161c822431e54d6_b.png\"\u002F\u003E\u003C\u002Ffigure\u003E\u003Cp\u003E不等于我们需要求解的 \u003Cimg src=\"https:\u002F\u002Fwww.zhihu.com\u002Fequation?tex=g%28p_1%2Cx%29+-+g%28p_0%2Cx%29\" alt=\"g(p_1,x) - g(p_0,x)\" eeimg=\"1\"\u002F\u003E 。\u003C\u002Fp\u003E\u003Cp\u003E这时，我们就需要一个 Instrumental variable z 了。它需要满足以下三点要求\u003C\u002Fp\u003E\u003Cfigure data-size=\"normal\"\u003E\u003Cnoscript\u003E\u003Cimg src=\"https:\u002F\u002Fpic1.zhimg.com\u002Fv2-381048b84fe93dacee7cf8bbe1e09c98_b.jpg\" data-caption=\"\" data-size=\"normal\" data-rawwidth=\"1248\" data-rawheight=\"296\" class=\"origin_image zh-lightbox-thumb\" width=\"1248\" data-original=\"https:\u002F\u002Fpic1.zhimg.com\u002Fv2-381048b84fe93dacee7cf8bbe1e09c98_r.jpg\"\u002F\u003E\u003C\u002Fnoscript\u003E\u003Cimg src=\"data:image\u002Fsvg+xml;utf8,&lt;svg xmlns=&#39;http:\u002F\u002Fwww.w3.org\u002F2000\u002Fsvg&#39; width=&#39;1248&#39; height=&#39;296&#39;&gt;&lt;\u002Fsvg&gt;\" data-caption=\"\" data-size=\"normal\" data-rawwidth=\"1248\" data-rawheight=\"296\" class=\"origin_image zh-lightbox-thumb lazy\" width=\"1248\" data-original=\"https:\u002F\u002Fpic1.zhimg.com\u002Fv2-381048b84fe93dacee7cf8bbe1e09c98_r.jpg\" data-actualsrc=\"https:\u002F\u002Fpic1.zhimg.com\u002Fv2-381048b84fe93dacee7cf8bbe1e09c98_b.jpg\"\u002F\u003E\u003C\u002Ffigure\u003E\u003Cp\u003E第一点要求和前面的 \u003Cimg src=\"https:\u002F\u002Fwww.zhihu.com\u002Fequation?tex=%5Ctheta_1+%5Cneq+0\" alt=\"\\theta_1 \\neq 0\" eeimg=\"1\"\u002F\u003E 类似，只不过变成了在非线性模型下的表述；第二个即表明引入的该变量不会成为 explanatory variable 进入原方程；第三个表示引入的该变量和原来的误差项不相关。\u003C\u002Fp\u003E\u003Ch3\u003E六、DeepIV 结构\u003C\u002Fh3\u003E\u003Cp\u003E在引入变量 z 之后，可以写出如下关系\u003C\u002Fp\u003E\u003Cfigure data-size=\"normal\"\u003E\u003Cnoscript\u003E\u003Cimg src=\"https:\u002F\u002Fpic2.zhimg.com\u002Fv2-0d92ab6968508c6c9900e415b99ea991_b.png\" data-caption=\"\" data-size=\"normal\" data-rawwidth=\"1362\" data-rawheight=\"186\" class=\"origin_image zh-lightbox-thumb\" width=\"1362\" data-original=\"https:\u002F\u002Fpic2.zhimg.com\u002Fv2-0d92ab6968508c6c9900e415b99ea991_r.jpg\"\u002F\u003E\u003C\u002Fnoscript\u003E\u003Cimg src=\"data:image\u002Fsvg+xml;utf8,&lt;svg xmlns=&#39;http:\u002F\u002Fwww.w3.org\u002F2000\u002Fsvg&#39; width=&#39;1362&#39; height=&#39;186&#39;&gt;&lt;\u002Fsvg&gt;\" data-caption=\"\" data-size=\"normal\" data-rawwidth=\"1362\" data-rawheight=\"186\" class=\"origin_image zh-lightbox-thumb lazy\" width=\"1362\" data-original=\"https:\u002F\u002Fpic2.zhimg.com\u002Fv2-0d92ab6968508c6c9900e415b99ea991_r.jpg\" data-actualsrc=\"https:\u002F\u002Fpic2.zhimg.com\u002Fv2-0d92ab6968508c6c9900e415b99ea991_b.png\"\u002F\u003E\u003C\u002Ffigure\u003E\u003Cp\u003E注意到 \u003Cimg src=\"https:\u002F\u002Fwww.zhihu.com\u002Fequation?tex=%5Cmathbb%7BE%7D%5By%7Cx%2Cz%5D\" alt=\"\\mathbb{E}[y|x,z]\" eeimg=\"1\"\u002F\u003E 可以通过有监督学习得到， \u003Cimg src=\"https:\u002F\u002Fwww.zhihu.com\u002Fequation?tex=F%28p%7Cx%2Cz%29\" alt=\"F(p|x,z)\" eeimg=\"1\"\u002F\u003E 也可以通过有监督学习得到，在得到这两者之后，能够反向求解得到我们需要的 \u003Cimg src=\"https:\u002F\u002Fwww.zhihu.com\u002Fequation?tex=h%28p%2Cx%29\" alt=\"h(p,x)\" eeimg=\"1\"\u002F\u003E 。实际算法分为两步：\u003C\u002Fp\u003E\u003Cul\u003E\u003Cli\u003E第一步：先学习 \u003Cimg src=\"https:\u002F\u002Fwww.zhihu.com\u002Fequation?tex=F_%5Cphi%28p%7Cx%2Cz%29\" alt=\"F_\\phi(p|x,z)\" eeimg=\"1\"\u002F\u003E ；对于离散的 p，学习一个 categorical distribution， \u003Cimg src=\"https:\u002F\u002Fwww.zhihu.com\u002Fequation?tex=P%28p%3Dp%5Ek%29+%3D+%5Cpi_k%28x%2C+z%3B%5Cphi%29\" alt=\"P(p=p^k) = \\pi_k(x, z;\\phi)\" eeimg=\"1\"\u002F\u003E ；对于连续的 p，学习一个 mixture of Gaussian distributions， \u003Cimg src=\"https:\u002F\u002Fwww.zhihu.com\u002Fequation?tex=y%7Cx%2Cz+%5Csim+%5Csum_k%5Cpi_k%28x%2Cz%3B%5Cphi%29%5Cmathcal%7BN%7D%28%5Cmu_k%28x%2Cz%3B%5Cphi%29%2C+%5Csigma_k%28x%2Cz%3B%5Cphi%29%29\" alt=\"y|x,z \\sim \\sum_k\\pi_k(x,z;\\phi)\\mathcal{N}(\\mu_k(x,z;\\phi), \\sigma_k(x,z;\\phi))\" eeimg=\"1\"\u002F\u003E 。\u003C\u002Fli\u003E\u003Cli\u003E第二步：然后学习 \u003Cimg src=\"https:\u002F\u002Fwww.zhihu.com\u002Fequation?tex=h_%5Ctheta%28p%2Cx%29\" alt=\"h_\\theta(p,x)\" eeimg=\"1\"\u002F\u003E ，目标是最小化\u003C\u002Fli\u003E\u003C\u002Ful\u003E\u003Cfigure data-size=\"normal\"\u003E\u003Cnoscript\u003E\u003Cimg src=\"https:\u002F\u002Fpic3.zhimg.com\u002Fv2-6ab4cb64f5c9bcfb33179a6cca561946_b.png\" data-caption=\"\" data-size=\"normal\" data-rawwidth=\"1358\" data-rawheight=\"130\" class=\"origin_image zh-lightbox-thumb\" width=\"1358\" data-original=\"https:\u002F\u002Fpic3.zhimg.com\u002Fv2-6ab4cb64f5c9bcfb33179a6cca561946_r.jpg\"\u002F\u003E\u003C\u002Fnoscript\u003E\u003Cimg src=\"data:image\u002Fsvg+xml;utf8,&lt;svg xmlns=&#39;http:\u002F\u002Fwww.w3.org\u002F2000\u002Fsvg&#39; width=&#39;1358&#39; height=&#39;130&#39;&gt;&lt;\u002Fsvg&gt;\" data-caption=\"\" data-size=\"normal\" data-rawwidth=\"1358\" data-rawheight=\"130\" class=\"origin_image zh-lightbox-thumb lazy\" width=\"1358\" data-original=\"https:\u002F\u002Fpic3.zhimg.com\u002Fv2-6ab4cb64f5c9bcfb33179a6cca561946_r.jpg\" data-actualsrc=\"https:\u002F\u002Fpic3.zhimg.com\u002Fv2-6ab4cb64f5c9bcfb33179a6cca561946_b.png\"\u002F\u003E\u003C\u002Ffigure\u003E\u003Cp\u003E其中 |D| 是训练集的大小。\u003C\u002Fp\u003E\u003Cp\u003E对于第二步，文章着重讲了一下优化的方法，令 \u003Cimg src=\"https:\u002F\u002Fwww.zhihu.com\u002Fequation?tex=%5Cmathcal%7BL%7D_t+%3D+%5Cleft%28y_t+-+%5Cmathbb%7BE%7D_%7Bp%5Csim+F_%5Cphi+%28x_t%2Cz_t%29%7D+%5Bh_%5Ctheta%28p%2Cx_t%29%5D%5Cright%29%5E2\" alt=\"\\mathcal{L}_t = \\left(y_t - \\mathbb{E}_{p\\sim F_\\phi (x_t,z_t)} [h_\\theta(p,x_t)]\\right)^2\" eeimg=\"1\"\u002F\u003E ，而\u003C\u002Fp\u003E\u003Cfigure data-size=\"normal\"\u003E\u003Cnoscript\u003E\u003Cimg src=\"https:\u002F\u002Fpic2.zhimg.com\u002Fv2-fbae023b4132246112d2e971ae89585d_b.jpg\" data-caption=\"\" data-size=\"normal\" data-rawwidth=\"1372\" data-rawheight=\"262\" class=\"origin_image zh-lightbox-thumb\" width=\"1372\" data-original=\"https:\u002F\u002Fpic2.zhimg.com\u002Fv2-fbae023b4132246112d2e971ae89585d_r.jpg\"\u002F\u003E\u003C\u002Fnoscript\u003E\u003Cimg src=\"data:image\u002Fsvg+xml;utf8,&lt;svg xmlns=&#39;http:\u002F\u002Fwww.w3.org\u002F2000\u002Fsvg&#39; width=&#39;1372&#39; height=&#39;262&#39;&gt;&lt;\u002Fsvg&gt;\" data-caption=\"\" data-size=\"normal\" data-rawwidth=\"1372\" data-rawheight=\"262\" class=\"origin_image zh-lightbox-thumb lazy\" width=\"1372\" data-original=\"https:\u002F\u002Fpic2.zhimg.com\u002Fv2-fbae023b4132246112d2e971ae89585d_r.jpg\" data-actualsrc=\"https:\u002F\u002Fpic2.zhimg.com\u002Fv2-fbae023b4132246112d2e971ae89585d_b.jpg\"\u002F\u003E\u003C\u002Ffigure\u003E\u003Cp\u003E因此可以看出，在对其估计梯度的时候，对于每一个 \u003Cimg src=\"https:\u002F\u002Fwww.zhihu.com\u002Fequation?tex=%28x_t%2C+z_t%2C+y_t%29\" alt=\"(x_t, z_t, y_t)\" eeimg=\"1\"\u002F\u003E 数据点需要从分布 \u003Cimg src=\"https:\u002F\u002Fwww.zhihu.com\u002Fequation?tex=F_%5Cphi%28x_t%2C+z_t%29\" alt=\"F_\\phi(x_t, z_t)\" eeimg=\"1\"\u002F\u003E 从采集两波 \u003Cimg src=\"https:\u002F\u002Fwww.zhihu.com\u002Fequation?tex=p\" alt=\"p\" eeimg=\"1\"\u002F\u003E 样本，即\u003C\u002Fp\u003E\u003Cfigure data-size=\"normal\"\u003E\u003Cnoscript\u003E\u003Cimg src=\"https:\u002F\u002Fpic3.zhimg.com\u002Fv2-052538a3b41668a47a4b2e77a8412a7a_b.png\" data-caption=\"\" data-size=\"normal\" data-rawwidth=\"1262\" data-rawheight=\"168\" class=\"origin_image zh-lightbox-thumb\" width=\"1262\" data-original=\"https:\u002F\u002Fpic3.zhimg.com\u002Fv2-052538a3b41668a47a4b2e77a8412a7a_r.jpg\"\u002F\u003E\u003C\u002Fnoscript\u003E\u003Cimg src=\"data:image\u002Fsvg+xml;utf8,&lt;svg xmlns=&#39;http:\u002F\u002Fwww.w3.org\u002F2000\u002Fsvg&#39; width=&#39;1262&#39; height=&#39;168&#39;&gt;&lt;\u002Fsvg&gt;\" data-caption=\"\" data-size=\"normal\" data-rawwidth=\"1262\" data-rawheight=\"168\" class=\"origin_image zh-lightbox-thumb lazy\" width=\"1262\" data-original=\"https:\u002F\u002Fpic3.zhimg.com\u002Fv2-052538a3b41668a47a4b2e77a8412a7a_r.jpg\" data-actualsrc=\"https:\u002F\u002Fpic3.zhimg.com\u002Fv2-052538a3b41668a47a4b2e77a8412a7a_b.png\"\u002F\u003E\u003C\u002Ffigure\u003E\u003Cp\u003E因此要过两波 forward pass 和一波 backward pass（求梯度）。\u003C\u002Fp\u003E\u003Cp\u003E如果省事，只采样一波 p，在两处地方都用它们，那么得到的损失函数将会是原损失函数的上界。\u003C\u002Fp\u003E\u003Cfigure data-size=\"normal\"\u003E\u003Cnoscript\u003E\u003Cimg src=\"https:\u002F\u002Fpic3.zhimg.com\u002Fv2-8b8a2c062b29395ca30be14af4bbf80e_b.png\" data-caption=\"\" data-size=\"normal\" data-rawwidth=\"1346\" data-rawheight=\"156\" class=\"origin_image zh-lightbox-thumb\" width=\"1346\" data-original=\"https:\u002F\u002Fpic3.zhimg.com\u002Fv2-8b8a2c062b29395ca30be14af4bbf80e_r.jpg\"\u002F\u003E\u003C\u002Fnoscript\u003E\u003Cimg src=\"data:image\u002Fsvg+xml;utf8,&lt;svg xmlns=&#39;http:\u002F\u002Fwww.w3.org\u002F2000\u002Fsvg&#39; width=&#39;1346&#39; height=&#39;156&#39;&gt;&lt;\u002Fsvg&gt;\" data-caption=\"\" data-size=\"normal\" data-rawwidth=\"1346\" data-rawheight=\"156\" class=\"origin_image zh-lightbox-thumb lazy\" width=\"1346\" data-original=\"https:\u002F\u002Fpic3.zhimg.com\u002Fv2-8b8a2c062b29395ca30be14af4bbf80e_r.jpg\" data-actualsrc=\"https:\u002F\u002Fpic3.zhimg.com\u002Fv2-8b8a2c062b29395ca30be14af4bbf80e_b.png\"\u002F\u003E\u003C\u002Ffigure\u003E\u003Cp\u003E但是实验中发现这样做效果竟然更好，文章给出的解释是，这样的梯度下降虽然有 bias，但是更新的 variance 更小。\u003C\u002Fp\u003E\u003Cp\u003E这里讨论的情形是 continuous outcome space and continuous treatment space，此外还可以推广到 discrete outcome space \u002F treatment space。\u003C\u002Fp\u003E\u003Cp\u003E对于因果推断来说，模型的 validation 更为重要，文章还给出了做 validation 的方法。\u003C\u002Fp\u003E","adminClosedComment":false,"topics":[{"url":"https:\u002F\u002Fwww.zhihu.com\u002Fapi\u002Fv4\u002Ftopics\u002F19624891","type":"topic","id":"19624891","name":"因果"},{"url":"https:\u002F\u002Fwww.zhihu.com\u002Fapi\u002Fv4\u002Ftopics\u002F19576422","type":"topic","id":"19576422","name":"统计"},{"url":"https:\u002F\u002Fwww.zhihu.com\u002Fapi\u002Fv4\u002Ftopics\u002F19816584","type":"topic","id":"19816584","name":"数据存储（广义）"}],"voteupCount":15,"voting":0,"column":{"description":"读呀读paper","canManage":false,"intro":"我们的目标是通用人工智能！","isFollowing":false,"urlToken":"reinforcementlearning","id":"reinforcementlearning","articlesCount":137,"acceptSubmission":true,"title":"强化学习前沿","url":"https:\u002F\u002Fzhuanlan.zhihu.com\u002Freinforcementlearning","commentPermission":"all","created":1537150763,"updated":1541142463,"imageUrl":"https:\u002F\u002Fpic2.zhimg.com\u002Fv2-5d1f04a84f6be8896c07a32a05e1d6d1_b.jpg","author":{"isFollowed":false,"avatarUrlTemplate":"https:\u002F\u002Fpic4.zhimg.com\u002Fv2-2b7c11f27a7fd03282819889435815aa_{size}.jpg","uid":"35077274730496","userType":"people","isFollowing":false,"urlToken":"zhang-chu-heng","id":"db39e3e0528520071b0a6e5f6240cfea","description":"","name":"张楚珩","isAdvertiser":false,"headline":"强化学习 量化投资","gender":1,"url":"\u002Fpeople\u002Fdb39e3e0528520071b0a6e5f6240cfea","avatarUrl":"https:\u002F\u002Fpic4.zhimg.com\u002Fv2-2b7c11f27a7fd03282819889435815aa_l.jpg","isOrg":false,"type":"people"},"followers":4344,"type":"column"},"commentCount":2,"contributions":[{"id":22063876,"state":"accepted","type":"first_publish","column":{"description":"读呀读paper","canManage":false,"intro":"我们的目标是通用人工智能！","isFollowing":false,"urlToken":"reinforcementlearning","id":"reinforcementlearning","articlesCount":137,"acceptSubmission":true,"title":"强化学习前沿","url":"https:\u002F\u002Fzhuanlan.zhihu.com\u002Freinforcementlearning","commentPermission":"all","created":1537150763,"updated":1541142463,"imageUrl":"https:\u002F\u002Fpic2.zhimg.com\u002Fv2-5d1f04a84f6be8896c07a32a05e1d6d1_b.jpg","author":{"isFollowed":false,"avatarUrlTemplate":"https:\u002F\u002Fpic4.zhimg.com\u002Fv2-2b7c11f27a7fd03282819889435815aa_{size}.jpg","uid":"35077274730496","userType":"people","isFollowing":false,"urlToken":"zhang-chu-heng","id":"db39e3e0528520071b0a6e5f6240cfea","description":"","name":"张楚珩","isAdvertiser":false,"headline":"强化学习 量化投资","gender":1,"url":"\u002Fpeople\u002Fdb39e3e0528520071b0a6e5f6240cfea","avatarUrl":"https:\u002F\u002Fpic4.zhimg.com\u002Fv2-2b7c11f27a7fd03282819889435815aa_l.jpg","isOrg":false,"type":"people"},"followers":4344,"type":"column"}}],"isTitleImageFullScreen":false,"upvotedFollowees":[],"commercialInfo":{"isCommercial":false,"plugin":{}},"suggestEdit":{"status":false,"reason":"","tip":"","url":"","title":""},"reason":"","annotationAction":[],"canTip":false,"tipjarorsCount":0,"isLabeled":false,"hasPublishingDraft":false,"isFavorited":false,"isNormal":true,"status":0,"shareText":"【统计】Instrumental Variables - 来自知乎专栏「强化学习前沿」，作者: 张楚珩 https:\u002F\u002Fzhuanlan.zhihu.com\u002Fp\u002F88235983 （想看更多？下载 @知乎 App：http:\u002F\u002Fweibo.com\u002Fp\u002F100404711598 ）","canComment":{"status":true,"reason":""},"mcnFpShow":-1,"isVisible":true,"isLiked":false,"likedCount":1,"visibleOnlyToAuthor":false}},"columns":{"reinforcementlearning":{"description":"读呀读paper","canManage":false,"intro":"我们的目标是通用人工智能！","isFollowing":false,"urlToken":"reinforcementlearning","id":"reinforcementlearning","articlesCount":137,"acceptSubmission":true,"title":"强化学习前沿","url":"https:\u002F\u002Fzhuanlan.zhihu.com\u002Freinforcementlearning","commentPermission":"all","created":1537150763,"updated":1541142463,"imageUrl":"https:\u002F\u002Fpic2.zhimg.com\u002Fv2-5d1f04a84f6be8896c07a32a05e1d6d1_b.jpg","author":{"isFollowed":false,"avatarUrlTemplate":"https:\u002F\u002Fpic4.zhimg.com\u002Fv2-2b7c11f27a7fd03282819889435815aa_{size}.jpg","uid":"35077274730496","userType":"people","isFollowing":false,"urlToken":"zhang-chu-heng","id":"db39e3e0528520071b0a6e5f6240cfea","description":"","name":"张楚珩","isAdvertiser":false,"headline":"强化学习 量化投资","gender":1,"url":"\u002Fpeople\u002Fdb39e3e0528520071b0a6e5f6240cfea","avatarUrl":"https:\u002F\u002Fpic4.zhimg.com\u002Fv2-2b7c11f27a7fd03282819889435815aa_l.jpg","isOrg":false,"type":"people"},"followers":4344,"type":"column"}},"topics":{},"roundtables":{},"favlists":{},"comments":{},"notifications":{},"ebooks":{},"activities":{},"feeds":{},"pins":{},"promotions":{},"drafts":{},"chats":{},"posts":{},"clubs":{},"clubTags":{}},"currentUser":"","account":{"lockLevel":{},"unlockTicketStatus":false,"unlockTicket":null,"challenge":[],"errorStatus":false,"message":"","isFetching":false,"accountInfo":{},"urlToken":{"loading":false}},"settings":{"socialBind":null,"inboxMsg":null,"notification":{},"email":{},"privacyFlag":null,"blockedUsers":{"isFetching":false,"paging":{"pageNo":1,"pageSize":6},"data":[]},"blockedFollowees":{"isFetching":false,"paging":{"pageNo":1,"pageSize":6},"data":[]},"ignoredTopics":{"isFetching":false,"paging":{"pageNo":1,"pageSize":6},"data":[]},"restrictedTopics":null,"laboratory":{}},"notification":{},"people":{"profileStatus":{},"activitiesByUser":{},"answersByUser":{},"answersSortByVotesByUser":{},"answersIncludedByUser":{},"votedAnswersByUser":{},"thankedAnswersByUser":{},"voteAnswersByUser":{},"thankAnswersByUser":{},"topicAnswersByUser":{},"zvideosByUser":{},"articlesByUser":{},"articlesSortByVotesByUser":{},"articlesIncludedByUser":{},"pinsByUser":{},"questionsByUser":{},"commercialQuestionsByUser":{},"favlistsByUser":{},"followingByUser":{},"followersByUser":{},"mutualsByUser":{},"followingColumnsByUser":{},"followingQuestionsByUser":{},"followingFavlistsByUser":{},"followingTopicsByUser":{},"publicationsByUser":{},"columnsByUser":{},"allFavlistsByUser":{},"brands":null,"creationsByUser":{},"creationsSortByVotesByUser":{},"creationsFeed":{}},"env":{"ab":{"config":{"experiments":[{"expId":"launch-gw_mweb_rec-1","expPrefix":"gw_mweb_rec","isDynamicallyUpdated":true,"isRuntime":false,"includeTriggerInfo":false},{"expId":"launch-qa_hdpimg-2","expPrefix":"qa_hdpimg","isDynamicallyUpdated":true,"isRuntime":false,"includeTriggerInfo":false},{"expId":"launch-us_foltopic_user-10","expPrefix":"us_foltopic_user","isDynamicallyUpdated":true,"isRuntime":false,"includeTriggerInfo":false},{"expId":"launch-vd_bullet_second-2","expPrefix":"vd_bullet_second","isDynamicallyUpdated":true,"isRuntime":false,"includeTriggerInfo":false},{"expId":"launch-vd_zvideo_link-10","expPrefix":"vd_zvideo_link","isDynamicallyUpdated":true,"isRuntime":false,"includeTriggerInfo":false},{"expId":"se_topicfeed-1","expPrefix":"se_topicfeed","isDynamicallyUpdated":true,"isRuntime":false,"includeTriggerInfo":false}],"params":[{"id":"web_answerlist_ad","type":"String","value":"0"},{"id":"soc_update","type":"String","value":"1","chainId":"_all_"},{"id":"top_quality","type":"String","value":"0","chainId":"_all_"},{"id":"top_new_feed","type":"String","value":"5","chainId":"_all_"},{"id":"web_sem_ab","type":"String","value":"1"},{"id":"se_content0","type":"String","value":"0","chainId":"_all_"},{"id":"top_v_album","type":"String","value":"1","chainId":"_all_"},{"id":"tp_discovery_ab_1","type":"String","value":"0","chainId":"_all_"},{"id":"soc_bigone","type":"String","value":"0","chainId":"_all_"},{"id":"pf_fuceng","type":"String","value":"1","chainId":"_all_"},{"id":"gue_video_autoplay","type":"String","value":"0"},{"id":"gue_zvideo_link","type":"String","value":"1"},{"id":"top_hotcommerce","type":"String","value":"1","chainId":"_all_"},{"id":"web_creator_route","type":"String","value":"1"},{"id":"ug_zero_follow_0","type":"String","value":"0","chainId":"_all_"},{"id":"li_purchase_test","type":"String","value":"0","chainId":"_all_"},{"id":"se_entity_model_14","type":"String","value":"0","chainId":"_all_"},{"id":"se_sug","type":"String","value":"1","chainId":"_all_"},{"id":"tp_club_pk","type":"String","value":"1","chainId":"_all_"},{"id":"ls_videoad","type":"String","value":"2","chainId":"_all_"},{"id":"gue_self_censoring","type":"String","value":"1"},{"id":"web_hdpimg","type":"String","value":"1"},{"id":"se_aa","type":"String","value":"0","chainId":"_all_"},{"id":"tp_qa_metacard_top","type":"String","value":"top","chainId":"_all_"},{"id":"li_answer_card","type":"String","value":"0","chainId":"_all_"},{"id":"gue_zhuantikapian","type":"String","value":"0"},{"id":"web_n_web_msg","type":"String","value":"0"},{"id":"web_unfriendly_comm","type":"String","value":"0"},{"id":"soc_newfeed","type":"String","value":"2","chainId":"_all_"},{"id":"se_featured","type":"String","value":"1","chainId":"_all_"},{"id":"tp_club_join","type":"String","value":"0","chainId":"_all_"},{"id":"tp_topic_style","type":"String","value":"0","chainId":"_all_"},{"id":"soc_special","type":"String","value":"0","chainId":"_all_"},{"id":"pf_creator_card","type":"String","value":"1","chainId":"_all_"},{"id":"li_qa_new_cover","type":"String","value":"1","chainId":"_all_"},{"id":"se_movietab","type":"String","value":"1","chainId":"_all_"},{"id":"tp_sft_v2","type":"String","value":"d","chainId":"_all_"},{"id":"soc_brdcst3","type":"String","value":"0","chainId":"_all_"},{"id":"ug_follow_answerer_0","type":"String","value":"0","chainId":"_all_"},{"id":"se_waterfall","type":"String","value":"0","chainId":"_all_"},{"id":"soc_iosintimacy","type":"String","value":"2","chainId":"_all_"},{"id":"se_zu_recommend","type":"String","value":"0","chainId":"_all_"},{"id":"li_paid_answer_exp","type":"String","value":"0","chainId":"_all_"},{"id":"se_entity_model","type":"String","value":"0","chainId":"_all_"},{"id":"se_cardrank_1","type":"String","value":"0","chainId":"_all_"},{"id":"se_searchwiki","type":"String","value":"0","chainId":"_all_"},{"id":"se_cardrank_3","type":"String","value":"0","chainId":"_all_"},{"id":"tp_qa_toast","type":"String","value":"1","chainId":"_all_"},{"id":"web_answer_list_ad","type":"String","value":"1"},{"id":"zr_rel_search","type":"String","value":"base","chainId":"_all_"},{"id":"tp_topic_head","type":"String","value":"0","chainId":"_all_"},{"id":"tp_discover","type":"String","value":"0","chainId":"_all_"},{"id":"zr_training_boost","type":"String","value":"false","chainId":"_all_"},{"id":"zr_search_sim","type":"String","value":"0","chainId":"_all_"},{"id":"zr_slot_cold_start","type":"String","value":"aver","chainId":"_all_"},{"id":"soc_adreadline","type":"String","value":"0","chainId":"_all_"},{"id":"soc_zcfw_broadcast","type":"String","value":"0","chainId":"_all_"},{"id":"li_hot_voted","type":"String","value":"0","chainId":"_all_"},{"id":"tp_club_feed","type":"String","value":"1","chainId":"_all_"},{"id":"soc_zcfw_broadcast2","type":"String","value":"1","chainId":"_all_"},{"id":"li_se_edu","type":"String","value":"1","chainId":"_all_"},{"id":"zr_test_aa1","type":"String","value":"0","chainId":"_all_"},{"id":"soc_notification","type":"String","value":"0","chainId":"_all_"},{"id":"soc_leave_recommend","type":"String","value":"2","chainId":"_all_"},{"id":"se_time_threshold","type":"String","value":"0","chainId":"_all_"},{"id":"tp_sticky_android","type":"String","value":"2","chainId":"_all_"},{"id":"tp_meta_card","type":"String","value":"0","chainId":"_all_"},{"id":"se_amovietab","type":"String","value":"1","chainId":"_all_"},{"id":"tp_club_pic_swiper","type":"String","value":"1","chainId":"_all_"},{"id":"tp_score_1","type":"String","value":"a","chainId":"_all_"},{"id":"li_sku_bottom_bar_re","type":"String","value":"0","chainId":"_all_"},{"id":"se_agency","type":"String","value":" 0","chainId":"_all_"},{"id":"se_pek_test","type":"String","value":"1","chainId":"_all_"},{"id":"se_colorfultab","type":"String","value":"1","chainId":"_all_"},{"id":"se_backsearch","type":"String","value":"0","chainId":"_all_"},{"id":"se_multianswer","type":"String","value":"2","chainId":"_all_"},{"id":"soc_iosreadfilter","type":"String","value":"0","chainId":"_all_"},{"id":"qap_thanks","type":"String","value":"1","chainId":"_all_"},{"id":"zr_video_rank","type":"String","value":"new_rank","chainId":"_all_"},{"id":"se_lottery","type":"String","value":"0","chainId":"_all_"},{"id":"gue_bullet_guide","type":"String","value":"发个弹幕聊聊…"},{"id":"qap_article_like","type":"String","value":"1","chainId":"_all_"},{"id":"se_article_icon","type":"String","value":"0","chainId":"_all_"},{"id":"se_new_merger","type":"String","value":"1","chainId":"_all_"},{"id":"se_preset_tech","type":"String","value":"0","chainId":"_all_"},{"id":"se_hot_timebox","type":"String","value":"0","chainId":"_all_"},{"id":"li_svip_tab_search","type":"String","value":"0","chainId":"_all_"},{"id":"qap_ques_invite","type":"String","value":"0","chainId":"_all_"},{"id":"se_likebutton","type":"String","value":"0","chainId":"_all_"},{"id":"soc_iossort","type":"String","value":"0","chainId":"_all_"},{"id":"se_cbert_index","type":"String","value":"0","chainId":"_all_"},{"id":"se_adxtest","type":"String","value":"1","chainId":"_all_"},{"id":"soc_feed_intimacy","type":"String","value":"2","chainId":"_all_"},{"id":"se_college","type":"String","value":"default","chainId":"_all_"},{"id":"se_specialbutton","type":"String","value":"0","chainId":"_all_"},{"id":"se_cardrank_2","type":"String","value":"1","chainId":"_all_"},{"id":"se_hotsearch_2","type":"String","value":"1","chainId":"_all_"},{"id":"top_test_4_liguangyi","type":"String","value":"1","chainId":"_all_"},{"id":"web_upload","type":"String","value":"1"},{"id":"zr_slot_training","type":"String","value":"1","chainId":"_all_"},{"id":"se_mobileweb","type":"String","value":"1","chainId":"_all_"},{"id":"se_sug_term","type":"String","value":"0","chainId":"_all_"},{"id":"soc_zuichangfangwen","type":"String","value":"0","chainId":"_all_"},{"id":"soc_authormore2","type":"String","value":"2","chainId":"_all_"},{"id":"zr_article_new","type":"String","value":"close","chainId":"_all_"},{"id":"se_preset_label","type":"String","value":"1","chainId":"_all_"},{"id":"zr_slotpaidexp","type":"String","value":"1","chainId":"_all_"},{"id":"se_spb309","type":"String","value":"0","chainId":"_all_"},{"id":"se_hotsearch","type":"String","value":"0","chainId":"_all_"},{"id":"se_auto_syn","type":"String","value":"0","chainId":"_all_"},{"id":"gue_new_special_page","type":"String","value":"1"},{"id":"zr_ans_rec","type":"String","value":"gbrank","chainId":"_all_"},{"id":"tp_club_qa","type":"String","value":"1","chainId":"_all_"},{"id":"soc_bignew","type":"String","value":"1","chainId":"_all_"},{"id":"soc_yxzl_zcfw","type":"String","value":"0","chainId":"_all_"},{"id":"soc_cardheight","type":"String","value":"2","chainId":"_all_"},{"id":"soc_authormore","type":"String","value":"2","chainId":"_all_"},{"id":"li_qa_btn_text","type":"String","value":"0","chainId":"_all_"},{"id":"web_column_auto_invite","type":"String","value":"0"},{"id":"qap_question_author","type":"String","value":"0","chainId":"_all_"},{"id":"se_ad_index","type":"String","value":"10","chainId":"_all_"},{"id":"se_related_index","type":"String","value":"3","chainId":"_all_"},{"id":"se_rf_w","type":"String","value":"0","chainId":"_all_"},{"id":"se_wannasearch","type":"String","value":"0","chainId":"_all_"},{"id":"tp_sft","type":"String","value":"a","chainId":"_all_"},{"id":"li_assessment_show","type":"String","value":"1","chainId":"_all_"},{"id":"zr_art_rec","type":"String","value":"base","chainId":"_all_"},{"id":"se_use_zitem","type":"String","value":"0","chainId":"_all_"},{"id":"soc_stickypush","type":"String","value":"1","chainId":"_all_"},{"id":"top_universalebook","type":"String","value":"1","chainId":"_all_"},{"id":"ug_zero_follow","type":"String","value":"0","chainId":"_all_"},{"id":"li_se_section","type":"String","value":"0","chainId":"_all_"},{"id":"zr_update_merge_size","type":"String","value":"1","chainId":"_all_"},{"id":"se_college_cm","type":"String","value":"0","chainId":"_all_"},{"id":"web_mini_review","type":"String","value":"0"},{"id":"se_webrs","type":"String","value":"1","chainId":"_all_"},{"id":"zr_video_recall","type":"String","value":"current_recall","chainId":"_all_"},{"id":"se_click_club","type":"String","value":"1","chainId":"_all_"},{"id":"se_websearch","type":"String","value":"3","chainId":"_all_"},{"id":"tp_club_discover","type":"String","value":"0","chainId":"_all_"},{"id":"tp_club_pic","type":"String","value":"0.6","chainId":"_all_"},{"id":"pf_adjust","type":"String","value":"0","chainId":"_all_"},{"id":"top_ydyq","type":"String","value":"X","chainId":"_all_"},{"id":"zr_answer_rec_cp","type":"String","value":"open","chainId":"_all_"},{"id":"tp_club_header","type":"String","value":"1","chainId":"_all_"},{"id":"pf_newguide_vertical","type":"String","value":"0","chainId":"_all_"},{"id":"li_se_heat","type":"String","value":"1","chainId":"_all_"},{"id":"se_prf","type":"String","value":"0","chainId":"_all_"},{"id":"li_yxzl_new_style_a","type":"String","value":"1","chainId":"_all_"},{"id":"web_audit_01","type":"String","value":"case1"},{"id":"se_topiclabel","type":"String","value":"1","chainId":"_all_"},{"id":"se_relationship","type":"String","value":"1","chainId":"_all_"},{"id":"se_cate_l3","type":"String","value":"0","chainId":"_all_"},{"id":"soc_ri_merge","type":"String","value":"0","chainId":"_all_"},{"id":"li_android_vip","type":"String","value":"0","chainId":"_all_"},{"id":"li_salt_hot","type":"String","value":"1","chainId":"_all_"},{"id":"se_payconsult","type":"String","value":"0","chainId":"_all_"},{"id":"ug_follow_answerer","type":"String","value":"0","chainId":"_all_"},{"id":"ug_fw_answ_aut_1","type":"String","value":"0","chainId":"_all_"},{"id":"li_se_across","type":"String","value":"1","chainId":"_all_"},{"id":"web_collect","type":"String","value":"0"},{"id":"se_club_post","type":"String","value":"5","chainId":"_all_"},{"id":"se_aa_base","type":"String","value":"0","chainId":"_all_"},{"id":"top_ebook","type":"String","value":"0","chainId":"_all_"},{"id":"gue_video_replay","type":"String","value":"0"},{"id":"li_pay_banner_type","type":"String","value":"6","chainId":"_all_"},{"id":"zr_rec_answer_cp","type":"String","value":"close","chainId":"_all_"},{"id":"se_col_boost","type":"String","value":"0","chainId":"_all_"},{"id":"se_new_topic","type":"String","value":"0","chainId":"_all_"},{"id":"se_sug_entrance","type":"String","value":"1","chainId":"_all_"},{"id":"se_whitelist","type":"String","value":"0","chainId":"_all_"},{"id":"tp_topic_entry","type":"String","value":"0","chainId":"_all_"},{"id":"tp_discover_copy","type":"String","value":"0","chainId":"_all_"},{"id":"zr_video_rank_nn","type":"String","value":"new_rank","chainId":"_all_"},{"id":"se_new_p","type":"String","value":"0","chainId":"_all_"},{"id":"ug_goodcomment_0","type":"String","value":"1","chainId":"_all_"},{"id":"tp_topic_tab","type":"String","value":"0","chainId":"_all_"},{"id":"soc_adreadfilter","type":"String","value":"0","chainId":"_all_"},{"id":"ug_newtag","type":"String","value":"0","chainId":"_all_"},{"id":"li_answers_link","type":"String","value":"0","chainId":"_all_"},{"id":"web_sec672","type":"String","value":"0"},{"id":"pf_noti_entry_num","type":"String","value":"0","chainId":"_all_"},{"id":"ug_follow_topic_1","type":"String","value":"2","chainId":"_all_"},{"id":"gue_goods_card","type":"String","value":"0"},{"id":"se_dnn_mt_v2","type":"String","value":"0","chainId":"_all_"},{"id":"se_webmajorob","type":"String","value":"0","chainId":"_all_"},{"id":"tp_club_tab","type":"String","value":"0","chainId":"_all_"},{"id":"li_ebook_gen_search","type":"String","value":"0","chainId":"_all_"},{"id":"zr_km_feed_nlp","type":"String","value":"old","chainId":"_all_"},{"id":"zr_training_first","type":"String","value":"false","chainId":"_all_"},{"id":"se_p_slideshow","type":"String","value":"0","chainId":"_all_"},{"id":"sem_up_growth","type":"String","value":"in_app","chainId":"_all_"},{"id":"li_video_section","type":"String","value":"0","chainId":"_all_"},{"id":"zw_payc_qaedit","type":"String","value":"0","chainId":"_all_"},{"id":"se_zu_onebox","type":"String","value":"0","chainId":"_all_"},{"id":"se_cardrank_4","type":"String","value":"1","chainId":"_all_"},{"id":"tp_qa_metacard","type":"String","value":"1","chainId":"_all_"},{"id":"li_catalog_card","type":"String","value":"1","chainId":"_all_"},{"id":"gue_card_test","type":"String","value":"1"},{"id":"se_pek_test3","type":"String","value":"1","chainId":"_all_"},{"id":"soc_zcfw_badcase","type":"String","value":"0","chainId":"_all_"},{"id":"zw_sameq_sorce","type":"String","value":"999","chainId":"_all_"},{"id":"se_hotmore","type":"String","value":"2","chainId":"_all_"},{"id":"se_ios_spb309","type":"String","value":"0","chainId":"_all_"},{"id":"tp_topic_rec","type":"String","value":"1","chainId":"_all_"},{"id":"ls_recommend_test","type":"String","value":"0","chainId":"_all_"},{"id":"web_ad_banner","type":"String","value":"0"},{"id":"zr_expslotpaid","type":"String","value":"1","chainId":"_all_"},{"id":"li_ebok_chap","type":"String","value":"0","chainId":"_all_"},{"id":"soc_zcfw_shipinshiti","type":"String","value":"1","chainId":"_all_"},{"id":"se_expired_ob","type":"String","value":"0","chainId":"_all_"},{"id":"top_root","type":"String","value":"0","chainId":"_all_"},{"id":"se_ctx_rerank","type":"String","value":"1","chainId":"_all_"},{"id":"se_relation_1","type":"String","value":"0","chainId":"_all_"},{"id":"tsp_hotlist_ui","type":"String","value":"1","chainId":"_all_"},{"id":"li_ebook_read","type":"String","value":"0","chainId":"_all_"},{"id":"se_topicfeed","type":"String","value":"0","chainId":"_all_"},{"id":"soc_iosreadline","type":"String","value":"0","chainId":"_all_"},{"id":"se_site_onebox","type":"String","value":"0","chainId":"_all_"},{"id":"se_highlight","type":"String","value":"0","chainId":"_all_"},{"id":"soc_iospinweight","type":"String","value":"0","chainId":"_all_"},{"id":"li_vip_verti_search","type":"String","value":"0","chainId":"_all_"},{"id":"web_ask","type":"String","value":"0"},{"id":"soc_adsort","type":"String","value":"0","chainId":"_all_"},{"id":"se_pek_test2","type":"String","value":"1","chainId":"_all_"},{"id":"se_ffzx_jushen1","type":"String","value":"0","chainId":"_all_"},{"id":"se_page_quality","type":"String","value":"0","chainId":"_all_"},{"id":"tp_header_style","type":"String","value":"1","chainId":"_all_"},{"id":"tsp_videobillboard","type":"String","value":"1","chainId":"_all_"},{"id":"li_answer_label","type":"String","value":"0","chainId":"_all_"},{"id":"li_se_media_icon","type":"String","value":"1","chainId":"_all_"},{"id":"se_webtimebox","type":"String","value":"0","chainId":"_all_"},{"id":"gue_bullet_second","type":"String","value":"1"},{"id":"tp_club_qa_pic","type":"String","value":"1","chainId":"_all_"},{"id":"tp_club_android_join","type":"String","value":"1","chainId":"_all_"},{"id":"tsp_vote","type":"String","value":"2","chainId":"_all_"},{"id":"web_mweb_rec_length","type":"String","value":"1"},{"id":"zr_km_answer","type":"String","value":"open_cvr","chainId":"_all_"},{"id":"web_mweb_launch","type":"String","value":"0"},{"id":"qap_question_visitor","type":"String","value":" 0","chainId":"_all_"},{"id":"zr_search_paid","type":"String","value":"0","chainId":"_all_"},{"id":"se_timebox_up","type":"String","value":"0","chainId":"_all_"},{"id":"se_search_feed","type":"String","value":"N","chainId":"_all_"},{"id":"tp_m_intro_re_topic","type":"String","value":"1","chainId":"_all_"},{"id":"tp_club_android_feed","type":"String","value":"old","chainId":"_all_"},{"id":"soc_userrec","type":"String","value":"0","chainId":"_all_"},{"id":"web_heifetz_grow_ad","type":"String","value":"1"},{"id":"li_svip_cardshow","type":"String","value":"1","chainId":"_all_"},{"id":"soc_adpinweight","type":"String","value":"0","chainId":"_all_"},{"id":"soc_wonderuser_recom","type":"String","value":"2","chainId":"_all_"},{"id":"se_ltr_video","type":"String","value":"0","chainId":"_all_"},{"id":"se_billboardsearch","type":"String","value":"0","chainId":"_all_"},{"id":"ls_fmp4","type":"String","value":"0","chainId":"_all_"},{"id":"web_question_invite","type":"String","value":"B"},{"id":"se_hotsearch_num","type":"String","value":"0","chainId":"_all_"},{"id":"zr_intervene","type":"String","value":"0","chainId":"_all_"},{"id":"tp_topic_tab_new","type":"String","value":"0-0-0","chainId":"_all_"},{"id":"soc_brdcst4","type":"String","value":"3","chainId":"_all_"},{"id":"qap_payc_invite","type":"String","value":"0","chainId":"_all_"},{"id":"web_answer_update","type":"String","value":"0"},{"id":"se_famous","type":"String","value":"1","chainId":"_all_"},{"id":"se_subtext","type":"String","value":"0","chainId":"_all_"},{"id":"se_presearch_ab","type":"String","value":"0","chainId":"_all_"},{"id":"tp_club_tab_feed","type":"String","value":"0","chainId":"_all_"},{"id":"pf_foltopic_usernum","type":"String","value":"50","chainId":"_all_"},{"id":"li_education_box","type":"String","value":"0","chainId":"_all_"},{"id":"gue_thanks","type":"String","value":"0"}],"chains":[{"chainId":"_all_"}]},"triggers":{}},"userAgent":{"Edge":false,"Wechat":false,"Weibo":false,"QQ":false,"MQQBrowser":false,"Qzone":false,"Mobile":false,"Android":false,"iOS":false,"isAppleDevice":false,"Zhihu":false,"ZhihuHybrid":false,"isBot":false,"Tablet":false,"UC":false,"Sogou":false,"Qihoo":false,"Baidu":false,"BaiduApp":false,"Safari":false,"GoogleBot":false,"AndroidDaily":false,"iOSDaily":false,"isWebView":false,"origin":"Mozilla\u002F5.0 (Windows NT 10.0; Win64; x64) AppleWebKit\u002F537.36 (KHTML, like Gecko) Chrome\u002F80.0.3987.100 Safari\u002F537.36"},"appViewConfig":{},"ctx":{"path":"\u002Fp\u002F88235983","query":{},"href":"http:\u002F\u002Fzhuanlan.zhihu.com\u002Fp\u002F88235983","host":"zhuanlan.zhihu.com"},"trafficSource":"production","edition":{"baidu":false,"sogou":false,"baiduBeijing":false,"sogouBeijing":false,"sogouInput":false},"theme":"light","enableShortcut":true,"referer":"","conf":{},"ipInfo":{"cityName":"德州","countryName":"中国","regionName":"山东","countryCode":"CN"},"logged":false},"me":{"columnContributions":[]},"label":{"recognizerLists":{}},"ecommerce":{},"comments":{"pagination":{},"collapsed":{},"reverse":{},"reviewing":{},"conversation":{},"parent":{}},"commentsV2":{"stickers":[],"commentWithPicPermission":{},"notificationsComments":{},"pagination":{},"collapsed":{},"reverse":{},"reviewing":{},"conversation":{},"conversationMore":{},"parent":{}},"pushNotifications":{"default":{"isFetching":false,"isDrained":false,"ids":[]},"follow":{"isFetching":false,"isDrained":false,"ids":[]},"vote_thank":{"isFetching":false,"isDrained":false,"ids":[]},"currentTab":"default","notificationsCount":{"default":0,"follow":0,"vote_thank":0}},"messages":{"data":{},"currentTab":"common","messageCount":0},"register":{"registerValidateSucceeded":null,"registerValidateErrors":{},"registerConfirmError":null,"sendDigitsError":null,"registerConfirmSucceeded":null},"login":{"loginUnregisteredError":false,"loginBindWechatError":false,"loginConfirmError":null,"sendDigitsError":null,"needSMSIdentify":false,"validateDigitsError":false,"loginConfirmSucceeded":null,"qrcodeLoginToken":"","qrcodeLoginScanStatus":0,"qrcodeLoginError":null,"qrcodeLoginReturnNewToken":false},"active":{"sendDigitsError":null,"activeConfirmSucceeded":null,"activeConfirmError":null},"switches":{},"captcha":{"captchaNeeded":false,"captchaValidated":false,"captchaBase64String":null,"captchaValidationMessage":null,"loginCaptchaExpires":false},"sms":{"supportedCountries":[]},"chat":{"chats":{},"inbox":{"recents":{"isFetching":false,"isDrained":false,"isPrevDrained":false,"result":[],"next":null,"key":null},"strangers":{"isFetching":false,"isDrained":false,"isPrevDrained":false,"result":[],"next":null,"key":null},"friends":{"isFetching":false,"isDrained":false,"isPrevDrained":false,"result":[],"next":null,"key":null},"search":{"isFetching":false,"isDrained":false,"isPrevDrained":false,"result":[],"next":null,"key":null},"config":{"newCount":0,"strangerMessageSwitch":false,"strangerMessageUnread":false,"friendCount":0}},"global":{"isChatMqttExisted":false}},"emoticons":{"emoticonGroupList":[],"emoticonGroupDetail":{}},"creator":{"currentCreatorUrlToken":null,"homeData":{"recommendQuestions":[]},"tools":{"question":{"invitationCount":{"questionFolloweeCount":0,"questionTotalCount":0},"goodatTopics":[]},"customPromotion":{"itemLists":{}},"recommend":{"recommendTimes":{}}},"explore":{"academy":{"tabs":[],"article":{}}},"rights":[],"rightsStatus":{},"levelUpperLimit":10,"account":{"growthLevel":{}},"mcn":{},"applyStatus":{}},"recommendation":{"homeRecommendations":[]},"shareTexts":{},"articles":{"voters":{}},"previewPost":{},"favlists":{"relations":{}},"columns":{"voters":{}},"reward":{"answer":{},"article":{},"question":{}},"video":{"data":{},"shareVideoDetail":{},"last":{}},"topstory":{"recommend":{"isFetching":false,"isDrained":false,"afterId":0,"items":[],"next":null},"follow":{"isFetching":false,"isDrained":false,"afterId":0,"items":[],"next":null},"followWonderful":{"isFetching":false,"isDrained":false,"afterId":0,"items":[],"next":null},"sidebar":null,"announcement":{},"hotListCategories":[],"hotList":[],"guestFeeds":{"isFetching":false,"isDrained":false,"afterId":0,"items":[],"next":null},"followExtra":{"isNewUser":null,"isFetched":false,"followCount":0,"followers":[]}},"readStatus":{},"column":{},"requestColumn":{"categories":[],"error":null},"articleContribution":{"contributeRequests":[],"deleteContributeIdList":[],"handledContributeIdList":[],"recommendedColumns":[],"pinnedColumns":[],"sentContributeRequestsIdList":[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,"reinforcementlearning"]},"columnContribution":{"contributeRequests":[],"autoInviteEnabled":false,"recommendedContributors":[],"contributionInvitation":null},"draftHistory":{"history":{},"drafts":{}},"upload":{},"articleDraft":{"titleImage":"","titleImageSize":{},"isTitleImageFullScreen":false,"canTitleImageFullScreen":false,"title":"","titleImageUploading":false,"error":"","content":"","draftLoading":false,"updating":false,"globalLoading":false,"pendingVideo":{"resource":null,"error":null},"deleteFail":{"fail":false},"recommendTopics":[],"selectedColumn":0,"articleDisclaimers":[]},"articleDrafts":{"isDrained":false,"isLoading":false,"items":[]},"columnAutocomplete":{"users":[],"friends":[]},"columnCollection":{},"mcn":{"bindInfo":{},"memberCategoryList":[],"producerList":[],"categoryList":[]}},"fetchHost":"www.zhihu.com","subAppName":"column"}</script><script src="https://static.zhihu.com/heifetz/vendor.7b36fae46082fd30a0db.js"></script><script src="https://static.zhihu.com/heifetz/column.app.76e02b16e87eec249f44.js"></script></body><script src="https://hm.baidu.com/hm.js?98beee57fd2ef70ccdd5ca52b9740c49" async=""></script><script src="https://zz.bdstatic.com/linksubmit/push.js" async=""></script></html>